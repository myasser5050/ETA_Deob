(function () {
  "use strict";

  const SUBSCRIPTION_WORKER_URL = "https://eta-subscriptions-worker.ms0223048.workers.dev/";
  const SUPPORT_WHATSAPP_NUMBER = "01060872599";
  async function verifyEtaSubscriptionOrPrompt() {
    const v = await fetchTaxpayerInfo();
    const tmp2 = v?.id;
    if (!tmp2) {
      alert("Ø®Ø·Ø£ ÙØ§Ø¯Ø­: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ Ù„Ù„Ù…Ù…ÙˆÙ„ Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ.");
      return false;
    }
    const SUBSCRIPTION_CACHE_KEY = "eta_subscription_data";
    const tmp3 = JSON.parse(localStorage.getItem(SUBSCRIPTION_CACHE_KEY) || "{}");
    const tmp4 = new Date().getTime();
    if (tmp3.regNumber === tmp2 && tmp3.expiry && tmp3.expiry > tmp4 && tmp3.status === true) {
      console.log("Subscription check: Using cached valid status for regNumber: " + tmp2);
      return true;
    }
    console.log("Subscription check: Cache invalid or for different user. Fetching from API for regNumber: " + tmp2);
    try {
      const tmp5 = await fetch(SUBSCRIPTION_WORKER_URL, {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          regNumber: tmp2
        })
      });
      if (!tmp5.ok) {
        throw new Error("API Error: " + tmp5.status);
      }
      const tmp6 = await tmp5.json();
      const tmp7 = tmp6.active === true;
      const tmp8 = tmp4 + 3600000;
      localStorage.setItem(SUBSCRIPTION_CACHE_KEY, JSON.stringify({
        regNumber: tmp2,
        status: tmp7,
        expiry: tmp8
      }));
      console.log("Subscription check: API response is " + tmp7 + ". Status cached for " + tmp2);
      return tmp7;
    } catch (e) {
      console.error("Subscription check failed:", e);
      return true;
    }
  }
  function fn2() {
    if (document.getElementById("subscriptionModal")) {
      return;
    }
    const tmp9 = document.createElement("div");
    tmp9.id = "subscriptionModal";
    tmp9.style.cssText = "\n            position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n            background-color: rgba(0, 0, 0, 0.7); z-index: 20000;\n            display: flex; align-items: center; justify-content: center;\n            direction: rtl; font-family: 'Cairo', 'Segoe UI', sans-serif;\n            backdrop-filter: blur(5px);\n        ";
    tmp9.innerHTML = "\n    <div style=\"background: #fff; width: 600px; max-width: 90%; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); text-align: center; padding: 30px; animation: zoomIn 0.3s ease-out;\">\n        <h2 style=\"color: #1d3557; margin-top: 0; font-size: 26px;\">ğŸ”’ Ø¨Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø£ÙˆÙ„Ø§Ù‹</h2>\n\n        <p style=\"font-size: 17px; color: #495057; line-height: 1.8; margin-bottom: 25px;\">\n            Ù„Ù„Ø§Ø³ØªÙØ§Ø¯Ø© Ù…Ù† Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù„Ùƒ.\n        </p>\n\n        <div style=\"background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 10px; padding: 20px; margin-bottom: 25px; text-align: center;\">\n            <h3 style=\"color: #007bff; margin-top: 0; font-size: 20px;\">ğŸ’³ Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</h3>\n            \n            <p style=\"font-size: 18px; color: #1d3557; margin: 10px 0; line-height: 1.7;\">\n                Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø´Ù‡Ø±ÙŠ: <strong style=\"color:#e63946; font-size:20px;\">50 Ø¬Ù€</strong><br>\n                Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø³Ù†ÙˆÙŠ: <strong style=\"color:#e63946; font-size:20px;\">600 Ø¬Ù€</strong>\n            </p>\n\n            <hr style=\"margin: 18px 0; border: none; border-top: 1px solid #dee2e6;\">\n\n            <h3 style=\"color: #007bff; margin: 5px 0 12px; font-size: 20px;\">Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ù…ØªØ§Ø­Ø©:</h3>\n\n            <p style=\"font-size: 18px; font-weight: bold; margin-bottom: 15px;\">\n                ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´ Ø£Ùˆ Ø§Ù†Ø³ØªØ§Ø¨Ø§ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø±Ù‚Ù…:\n            </p>\n\n            <p style=\"font-size: 28px; color: #e63946; user-select: all; cursor: pointer;\" title=\"Ø§Ø¶ØºØ· Ù„Ù„Ù†Ø³Ø®\">\n                " + SUPPORT_WHATSAPP_NUMBER + "\n            </p>\n\n            <p style=\"font-size: 15px; color: #6c757d; line-height: 1.8; margin-top: 15px;\">\n                Ø¨Ø¹Ø¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„ØŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø±Ø³Ø§Ù„:<br>\n                <strong>âœ” ØµÙˆØ±Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„</strong><br>\n                <strong>âœ” Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ Ù„Ù„Ù…ÙˆÙ„</strong><br>\n                <strong>âœ” ÙØªØ±Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ (Ø´Ù‡Ø±ÙŠ / Ø³Ù†ÙˆÙŠ)</strong><br>\n                Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù†ÙØ³ Ø§Ù„Ø±Ù‚Ù… Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ.\n            </p>\n        </div>\n\n        <button id=\"closeSubscriptionModalBtn\" style=\"background: #6c757d; color: white; padding: 12px 40px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 16px;\">\n            ÙÙ‡Ù…ØªØŒ Ø¥ØºÙ„Ø§Ù‚\n        </button>\n    </div>\n\n    <style>\n        @keyframes zoomIn { \n            from { opacity: 0; transform: scale(0.9); } \n            to { opacity: 1; transform: scale(1); } \n        }\n    </style>\n";
    document.body.appendChild(tmp9);
    document.getElementById("closeSubscriptionModalBtn").onclick = () => tmp9.remove();
  }
  function renderInfoFieldHtml(p, p2, p3 = false, p4 = false) {
    if (!p2 && !p4) {
      return "";
    }
    let tmp10;
    if (p4) {
      const tmp11 = String(p2).toLowerCase() === "Ù†Ø´Ø·" || String(p2).toLowerCase() === "active";
      const tmp12 = tmp11 ? "status active" : "status inactive";
      const tmp13 = tmp11 ? "Ù†Ø´Ø·" : "ØºÙŠØ± Ù†Ø´Ø·";
      tmp10 = "<span class=\"" + tmp12 + "\">" + tmp13 + "</span>";
    } else {
      const tmp14 = p3 ? "value ltr" : "value";
      tmp10 = "<span class=\"" + tmp14 + "\">" + p2 + "</span>";
    }
    return "\n        <div class=\"info-field\">\n            <span class=\"label-icon\">" + p + "</span>\n            " + tmp10 + "\n        </div>\n    ";
  }
  function fn4(p5) {
    const tmp15 = new Date();
    let tmp16;
    const tmp17 = p5 ? new Date(p5) : null;
    if (tmp17 && !isNaN(tmp17.getTime())) {
      tmp16 = tmp17;
      tmp16.setHours(tmp15.getHours(), tmp15.getMinutes(), tmp15.getSeconds());
    } else {
      tmp16 = tmp15;
    }
    return tmp16.toISOString().split(".")[0] + "Z";
  }
  const vF = function () {
    async function fn5(p6) {
      const tmp18 = new TextEncoder();
      const tmp19 = await crypto.subtle.digest("SHA-256", tmp18.encode(p6));
      return Array.from(new Uint8Array(tmp19)).map(p7 => p7.toString(16).padStart(2, "0")).join("");
    }
    function fn6(p8) {
      return p8 === 32 || p8 === 10 || p8 === 13 || p8 === 9;
    }
    function fn7(p9) {
      this.s = p9;
      this.n = p9.length;
      this.i = 0;
      this.out = [];
    }
    fn7.prototype.peek = function () {
      if (this.i < this.n) {
        return this.s.charCodeAt(this.i);
      } else {
        return -1;
      }
    };
    fn7.prototype.skip = function () {
      while (this.i < this.n && fn6(this.s.charCodeAt(this.i))) {
        this.i++;
      }
    };
    fn7.prototype.expect = function (p10) {
      if (this.s[this.i] !== p10) {
        throw new Error("Expected " + p10 + " at " + this.i);
      }
      this.i++;
    };
    fn7.prototype.readString = function () {
      let tmp20 = this.i;
      this.expect("\"");
      while (this.i < this.n) {
        const tmp21 = this.s.charCodeAt(this.i);
        if (tmp21 === 34) {
          this.i++;
          break;
        }
        if (tmp21 === 92) {
          this.i += 2;
        } else {
          this.i++;
        }
      }
      return this.s.slice(tmp20, this.i);
    };
    fn7.prototype.readNumber = function () {
      let tmp22 = this.i;
      if (this.s[this.i] === "-") {
        this.i++;
      }
      if (this.s[this.i] === "0") {
        this.i++;
      } else {
        if (!(this.s[this.i] >= "1") || !(this.s[this.i] <= "9")) {
          throw new Error("num");
        }
        while (this.s[this.i] >= "0" && this.s[this.i] <= "9") {
          this.i++;
        }
      }
      if (this.s[this.i] === ".") {
        this.i++;
        if (!(this.s[this.i] >= "0") || !(this.s[this.i] <= "9")) {
          throw new Error("frac");
        }
        while (this.s[this.i] >= "0" && this.s[this.i] <= "9") {
          this.i++;
        }
      }
      if (this.s[this.i] === "e" || this.s[this.i] === "E") {
        this.i++;
        if (this.s[this.i] === "+" || this.s[this.i] === "-") {
          this.i++;
        }
        if (!(this.s[this.i] >= "0") || !(this.s[this.i] <= "9")) {
          throw new Error("exp");
        }
        while (this.s[this.i] >= "0" && this.s[this.i] <= "9") {
          this.i++;
        }
      }
      return this.s.slice(tmp22, this.i);
    };
    fn7.prototype.readLiteral = function () {
      if (this.s.startsWith("true", this.i)) {
        this.i += 4;
        return "true";
      }
      if (this.s.startsWith("false", this.i)) {
        this.i += 5;
        return "false";
      }
      if (this.s.startsWith("null", this.i)) {
        this.i += 4;
        return "null";
      }
      throw new Error("literal@" + this.i);
    };
    fn7.prototype.emitKey = function (p11) {
      this.out.push("\"" + p11 + "\"");
    };
    fn7.prototype.emitScalar = function (p12) {
      this.out.push("\"" + p12 + "\"");
    };
    fn7.prototype.serializeObject = function (p13, p14) {
      this.skip();
      this.expect("{");
      this.skip();
      let tmp23 = true;
      while (this.i < this.n && this.s[this.i] !== "}") {
        if (!tmp23 && this.s[this.i] === ",") {
          this.i++;
          this.skip();
        }
        const tmp24 = this.readString();
        const tmp25 = JSON.parse(tmp24);
        const tmp26 = tmp25.toUpperCase();
        this.skip();
        this.expect(":");
        this.skip();
        const tmp27 = p13 ? p13 + "." + tmp25 : tmp25;
        const tmp28 = p14.indexOf(tmp27) !== -1;
        const tmp29 = this.peek();
        if (tmp29 === 34) {
          const tmp30 = this.readString();
          if (!tmp28) {
            this.emitKey(tmp26);
            this.emitScalar(tmp30.slice(1, -1));
          }
        } else if (tmp29 === 123) {
          if (!tmp28) {
            this.emitKey(tmp26);
          }
          this.serializeObject(tmp27, p14);
        } else if (tmp29 === 91) {
          if (!tmp28) {
            this.emitKey(tmp26);
          }
          this.serializeArray(tmp27, p14, tmp28, tmp26);
        } else if (tmp29 === 45 || tmp29 >= 48 && tmp29 <= 57) {
          const tmp31 = this.readNumber();
          if (!tmp28) {
            this.emitKey(tmp26);
            this.emitScalar(tmp31);
          }
        } else {
          const tmp32 = this.readLiteral();
          if (!tmp28) {
            this.emitKey(tmp26);
            this.emitScalar(tmp32);
          }
        }
        this.skip();
        tmp23 = false;
      }
      this.expect("}");
    };
    fn7.prototype.serializeArray = function (p15, p16, p17, p18) {
      this.skip();
      this.expect("[");
      this.skip();
      let tmp33 = true;
      while (this.i < this.n && this.s[this.i] !== "]") {
        if (!tmp33 && this.s[this.i] === ",") {
          this.i++;
          this.skip();
        }
        if (!p17 && p18) {
          this.emitKey(p18);
        }
        const tmp34 = this.peek();
        if (tmp34 === 123) {
          this.serializeObject(p15, p16);
        } else if (tmp34 === 34) {
          const tmp35 = this.readString();
          if (!p17) {
            this.emitScalar(tmp35.slice(1, -1));
          }
        } else if (tmp34 === 45 || tmp34 >= 48 && tmp34 <= 57) {
          const tmp36 = this.readNumber();
          if (!p17) {
            this.emitScalar(tmp36);
          }
        } else {
          const tmp37 = this.readLiteral();
          if (!p17) {
            this.emitScalar(tmp37);
          }
        }
        this.skip();
        tmp33 = false;
      }
      this.expect("]");
    };
    function fn8(p19) {
      const tmp38 = p19.match(/"receipts"\s*:\s*\[/);
      if (!tmp38) {
        return p19.trim();
      }
      let tmp39 = tmp38.index + tmp38[0].length;
      while (tmp39 < p19.length && /\s/.test(p19[tmp39])) {
        tmp39++;
      }
      if (p19[tmp39] !== "{") {
        return p19.trim();
      }
      let vLN0 = 0;
      let vV39 = tmp39;
      while (tmp39 < p19.length) {
        const tmp40 = p19[tmp39];
        if (tmp40 === "\"") {
          tmp39++;
          while (tmp39 < p19.length) {
            if (p19[tmp39] === "\\") {
              tmp39 += 2;
              continue;
            }
            if (p19[tmp39] === "\"") {
              tmp39++;
              break;
            }
            tmp39++;
          }
          continue;
        }
        if (tmp40 === "{") {
          vLN0++;
        }
        if (tmp40 === "}") {
          vLN0--;
          if (vLN0 === 0) {
            tmp39++;
            break;
          }
        }
        tmp39++;
      }
      return p19.slice(vV39, tmp39);
    }
    function fn9(p20) {
      const vF8 = fn8(p20);
      const tmp41 = new fn7(vF8);
      tmp41.serializeObject("", []);
      return tmp41.out.join("");
    }
    async function fn10(p21) {
      const vF9 = fn9(p21);
      return await fn5(vF9);
    }
    return {
      computeUuidFromRawText: fn10
    };
  }();
  let tmp42 = location.href;
  setInterval(() => {
    if (tmp42 !== location.href) {
      tmp42 = location.href;
      const tmp43 = document.getElementById("invoiceCreatorMainUI");
      const tmp44 = document.getElementById("receiptUploaderTabbedUI");
      if (tmp43) {
        tmp43.remove();
      }
      if (tmp44) {
        tmp44.remove();
      }
      fn13();
    }
  }, 500);
  fn13();
  let tmpLocalAr = "ar";
  try {
    const tmp45 = new PerformanceObserver(p22 => {
      for (const tmp46 of p22.getEntries()) {
        if (tmp46.name.includes("lang=")) {
          const tmp47 = new URL(tmp46.name);
          const tmp48 = tmp47.searchParams.get("lang");
          if ((tmp48 === "ar" || tmp48 === "en") && tmpLocalAr !== tmp48) {
            tmpLocalAr = tmp48;
          }
        }
      }
    });
    tmp45.observe({
      type: "resource",
      buffered: true
    });
  } catch (e2) {
    const tmp49 = Array.from(document.querySelectorAll("button span")).find(p23 => p23.textContent.trim() === "Logout" || p23.textContent.trim() === "Ø®Ø±ÙˆØ¬");
    tmpLocalAr = tmp49 && tmp49.textContent.trim() === "Logout" ? "en" : "ar";
  }
  function fn11(p24) {
    return new Promise((p25, p26) => {
      const tmp50 = document.createElement("script");
      tmp50.src = chrome.runtime.getURL(p24);
      tmp50.onload = () => p25(true);
      tmp50.onerror = p27 => {
        p26(p27);
      };
      (document.head || document.documentElement).appendChild(tmp50);
    });
  }
  async function fn12() {
    if (typeof window.jspdf !== "undefined") {
      return true;
    }
    try {
      await fn11("jspdf.umd.min.js");
      return true;
    } catch (e3) {
      return false;
    }
  }
  function fn13() {
    if (window.location.pathname === "/newdocument") {
      const vSetInterval = setInterval(() => {
        const tmp51 = document.querySelector("div[role='tablist']");
        if (tmp51) {
          clearInterval(vSetInterval);
          fn54(tmp51);
        }
      }, 50);
      setTimeout(() => clearInterval(vSetInterval), 10000);
    } else if (window.location.pathname === "/uploadReceipts") {
      const vSetInterval2 = setInterval(() => {
        const tmp52 = document.querySelector(".fileSelection");
        if (tmp52 && tmp52.parentElement) {
          clearInterval(vSetInterval2);
          fn14(tmp52.parentElement);
        }
      }, 50);
      setTimeout(() => clearInterval(vSetInterval2), 10000);
    }
  }
  function fn14(p28) {
    if (document.getElementById("customReceiptUploaderBtn")) {
      return;
    }
    const tmp53 = document.createElement("button");
    tmp53.id = "customReceiptUploaderBtn";
    tmp53.type = "button";
    tmp53.className = "ms-Button ms-Button--default root-122";
    p28.style.display = "flex";
    p28.style.alignItems = "center";
    tmp53.style.marginRight = "15px";
    const tmpLocalsvgWidth24Height24Vi = "\n        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path d=\"M14 2H6C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V8L14 2Z\" fill=\"#a2d2ff\"/>\n            <path d=\"M12.5 13.5L15 17M15 13.5L12.5 17\" stroke=\"#03045e\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n            <path d=\"M9.5 17H10.5L12 14.75L10.5 12H9.5L8 14.25L9.5 17Z\" stroke=\"#03045e\" stroke-width=\"2\" stroke-linejoin=\"round\"/>\n        </svg>\n    ";
    tmp53.innerHTML = "\n        <span class=\"ms-Button-flexContainer flexContainer-96\" style=\"gap: 10px; align-items: center; padding: 0 10px;\">\n            <span class=\"icon-wrapper\">" + tmpLocalsvgWidth24Height24Vi + "</span>\n            <span class=\"ms-Button-textContainer textContainer-97\">\n                <span class=\"ms-Button-label label-123\" style=\"color: #ffffff; font-weight: 600; font-size: 15px; font-family: 'Segoe UI', Tahoma, sans-serif;\">\n                    Ø±ÙØ¹ Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª Ù…Ù† Excel\n                </span>\n            </span>\n        </span>\n    ";
    Object.assign(tmp53.style, {
      height: "42px",
      backgroundColor: "#023e8a",
      color: "#ffffff",
      border: "none",
      borderRadius: "8px",
      boxShadow: "0 4px 6px rgba(0, 0, 0, 0.1 ), 0 1px 3px rgba(0, 0, 0, 0.08)",
      transition: "all 0.2s ease-in-out",
      cursor: "pointer",
      transform: "translateY(0)"
    });
    tmp53.onmouseenter = () => {
      tmp53.style.transform = "translateY(-2px)";
      tmp53.style.boxShadow = "0 7px 14px rgba(0, 0, 0, 0.1), 0 3px 6px rgba(0, 0, 0, 0.08)";
      tmp53.style.backgroundColor = "#003566";
    };
    tmp53.onmouseleave = () => {
      tmp53.style.transform = "translateY(0)";
      tmp53.style.boxShadow = "0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08)";
      tmp53.style.backgroundColor = "#023e8a";
    };
    tmp53.onmousedown = () => {
      tmp53.style.transform = "translateY(1px)";
      tmp53.style.boxShadow = "0 2px 4px rgba(0, 0, 0, 0.1)";
    };
    tmp53.onmouseup = () => {
      tmp53.style.transform = "translateY(-2px)";
      tmp53.style.boxShadow = "0 7px 14px rgba(0, 0, 0, 0.1), 0 3px 6px rgba(0, 0, 0, 0.08)";
    };
    tmp53.addEventListener("click", async p29 => {
      p29.preventDefault();
      const tmp54 = await verifyEtaSubscriptionOrPrompt();
      fn18(tmp54);
    });
    p28.appendChild(tmp53);
  }
  function fn17(p30) {
    if (!p30) {
      return;
    }
    p30.innerHTML = "\n    <div class=\"panel-header\">\n        <h2>â­ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</h2>\n        <p>Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ ÙˆØµÙˆÙ„ ÙƒØ§Ù…Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© Ø¹Ø¨Ø± Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ.</p>\n    </div>\n\n    <div style=\"background: #fff; border-radius: 12px; padding: 30px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.05);\">\n\n        <h3 style=\"color: #007bff; margin-top: 0; font-size: 22px;\">\n            ğŸ’³ Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ\n        </h3>\n\n        <div style=\"margin: 18px 0; font-size: 18px; line-height: 1.7; color: #1d3557;\">\n            <p style=\"margin: 6px 0;\">\n                Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø´Ù‡Ø±ÙŠ: \n                <strong style=\"color:#e63946; font-size:20px;\">50 Ø¬Ù€</strong>\n            </p>\n            <p style=\"margin: 6px 0;\">\n                Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø³Ù†ÙˆÙŠ: \n                <strong style=\"color:#e63946; font-size:20px;\">600 Ø¬Ù€</strong>\n            </p>\n        </div>\n\n        <hr style=\"margin: 20px auto; width: 80%; border: none; border-top: 1px solid #e9ecef;\">\n\n        <h3 style=\"color: #007bff; margin-top: 0; font-size: 22px;\">\n            Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ù…ØªØ§Ø­Ø©\n        </h3>\n\n        <div style=\"font-size: 18px; font-weight: bold; margin: 20px 0;\">\n            <p style=\"margin: 5px 0;\">ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´ Ø£Ùˆ Ø§Ù†Ø³ØªØ§Ø¨Ø§ÙŠ (InstaPay) Ø¹Ù„Ù‰ Ø§Ù„Ø±Ù‚Ù…:</p>\n            <p style=\"font-size: 32px; color: #e63946; user-select: all; cursor: pointer; background: #f8f9fa; padding: 10px; border-radius: 8px; border: 1px dashed #ccc;\" title=\"Ø§Ø¶ØºØ· Ù„Ù„Ù†Ø³Ø®\">\n                " + SUPPORT_WHATSAPP_NUMBER + "\n            </p>\n        </div>\n\n        <p style=\"font-size: 16px; color: #6c757d; line-height: 1.8; margin-top: 10px;\">\n            Ø¨Ø¹Ø¯ Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯ÙØ¹ØŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø±Ø³Ø§Ù„:\n            <br>âœ” <strong>ØµÙˆØ±Ø© Ù…Ù† Ø¥ÙŠØµØ§Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„</strong>\n            <br>âœ” <strong>Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ</strong> Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ù…Ù…ÙˆÙ„\n            <br>âœ” <strong>Ù…Ø¯Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</strong> (Ø´Ù‡Ø±ÙŠ / Ø³Ù†ÙˆÙŠ)\n            <br>Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù†ÙØ³ Ø§Ù„Ø±Ù‚Ù… Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙˆØ±Ù‹Ø§.\n        </p>\n    </div>\n";
  }
  function fn16(p31) {
    let tmp55;
    let tmp56;
    if (p31 === "receipts") {
      tmp55 = "receiptUploaderTabbedUI";
      tmp56 = fn18;
    } else {
      tmp55 = "invoiceCreatorMainUI";
      tmp56 = fn55;
    }
    let tmp57 = document.getElementById(tmp55);
    if (!tmp57) {
      tmp56();
      tmp57 = document.getElementById(tmp55);
    }
    if (!tmp57) {
      alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø­Ø§ÙˆÙ„Ø© ÙØªØ­ ÙˆØ§Ø¬Ù‡Ø© " + p31 + ".");
      return;
    }
    tmp57.style.display = "flex";
    fn2();
  }
  function fn17(p32) {
    if (!p32) {
      return;
    }
    p32.innerHTML = "\n    <div class=\"panel-header\">\n        <h2>â­ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙŠ Ø§Ù„Ø¨Ø§Ù‚Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©</h2>\n        <p>Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ ÙˆØµÙˆÙ„ ÙƒØ§Ù…Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© Ø¹Ø¨Ø± Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ.</p>\n    </div>\n\n    <div style=\"background: #fff; border-radius: 12px; padding: 30px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.05);\">\n\n        <h3 style=\"color: #007bff; margin-top: 0; font-size: 22px;\">\n            ğŸ’³ Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ\n        </h3>\n\n        <div style=\"margin: 18px 0; font-size: 18px; line-height: 1.7; color: #1d3557;\">\n            <p style=\"margin: 6px 0;\">\n                Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø´Ù‡Ø±ÙŠ: \n                <strong style=\"color:#e63946; font-size:20px;\">50 Ø¬Ù€</strong>\n            </p>\n            <p style=\"margin: 6px 0;\">\n                Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ Ø§Ù„Ø³Ù†ÙˆÙŠ: \n                <strong style=\"color:#e63946; font-size:20px;\">600 Ø¬Ù€</strong>\n            </p>\n        </div>\n\n        <hr style=\"margin: 20px auto; width: 80%; border: none; border-top: 1px solid #e9ecef;\">\n\n        <h3 style=\"color: #007bff; margin-top: 0; font-size: 22px;\">\n            Ø·Ø±Ù‚ Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ù…ØªØ§Ø­Ø©\n        </h3>\n\n        <div style=\"font-size: 18px; font-weight: bold; margin: 20px 0;\">\n            <p style=\"margin: 5px 0;\">ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´ Ø£Ùˆ Ø§Ù†Ø³ØªØ§Ø¨Ø§ÙŠ (InstaPay) Ø¹Ù„Ù‰ Ø§Ù„Ø±Ù‚Ù…:</p>\n            <p style=\"font-size: 32px; color: #e63946; user-select: all; cursor: pointer; background: #f8f9fa; padding: 10px; border-radius: 8px; border: 1px dashed #ccc;\" title=\"Ø§Ø¶ØºØ· Ù„Ù„Ù†Ø³Ø®\">\n                " + SUPPORT_WHATSAPP_NUMBER + "\n            </p>\n        </div>\n\n        <p style=\"font-size: 16px; color: #6c757d; line-height: 1.8; margin-top: 10px;\">\n            Ø¨Ø¹Ø¯ Ø¥ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯ÙØ¹ØŒ ÙŠØ±Ø¬Ù‰ Ø¥Ø±Ø³Ø§Ù„:\n            <br>âœ” <strong>ØµÙˆØ±Ø© Ù…Ù† Ø¥ÙŠØµØ§Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„</strong>\n            <br>âœ” <strong>Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ</strong> Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ù…Ù…ÙˆÙ„\n            <br>âœ” <strong>Ù…Ø¯Ø© Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ</strong> (Ø´Ù‡Ø±ÙŠ / Ø³Ù†ÙˆÙŠ)\n            <br>Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ù†ÙØ³ Ø§Ù„Ø±Ù‚Ù… Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙÙˆØ±Ù‹Ø§.\n        </p>\n    </div>\n";
  }
  const vA = [{
    code: "EGP",
    Desc_ar: "Ø¬Ù†ÙŠÙ‡ Ù…ØµØ±ÙŠ"
  }, {
    code: "USD",
    Desc_ar: "Ø¯ÙˆÙ„Ø§Ø± Ø£Ù…Ø±ÙŠÙƒÙŠ"
  }, {
    code: "EUR",
    Desc_ar: "ÙŠÙˆØ±Ùˆ"
  }, {
    code: "GBP",
    Desc_ar: "Ø¬Ù†ÙŠÙ‡ Ø¥Ø³ØªØ±Ù„ÙŠÙ†ÙŠ"
  }, {
    code: "SAR",
    Desc_ar: "Ø±ÙŠØ§Ù„ Ø³Ø¹ÙˆØ¯ÙŠ"
  }, {
    code: "AED",
    Desc_ar: "Ø¯Ø±Ù‡Ù… Ø¥Ù…Ø§Ø±Ø§ØªÙŠ"
  }, {
    code: "KWD",
    Desc_ar: "Ø¯ÙŠÙ†Ø§Ø± ÙƒÙˆÙŠØªÙŠ"
  }, {
    code: "QAR",
    Desc_ar: "Ø±ÙŠØ§Ù„ Ù‚Ø·Ø±ÙŠ"
  }, {
    code: "JPY",
    Desc_ar: "ÙŠÙ† ÙŠØ§Ø¨Ø§Ù†ÙŠ"
  }, {
    code: "CNY",
    Desc_ar: "ÙŠÙˆØ§Ù† ØµÙŠÙ†ÙŠ"
  }];
  const vO = {
    currencies: Object.fromEntries(vA.map(p33 => [p33.Desc_ar, p33.code]))
  };
  async function fn18(p34 = true) {
    const tmpLocalReceiptUploaderTabbe = "receiptUploaderTabbedUI";
    const tmp58 = document.getElementById(tmpLocalReceiptUploaderTabbe);
    if (tmp58) {
      if (p34 && tmp58.dataset.mode === "unsubscribed") {
        tmp58.remove();
      } else {
        tmp58.style.display = "flex";
        if (p34) {
          tmp58.querySelector(".sidebar-btn[data-target=\"panel-upload\"]")?.click();
        }
        return;
      }
    }
    const tmp59 = document.createElement("div");
    tmp59.id = tmpLocalReceiptUploaderTabbe;
    tmp59.dataset.mode = p34 ? "subscribed" : "unsubscribed";
    Object.assign(tmp59.style, {
      position: "fixed",
      top: "50%",
      left: "50%",
      transform: "translate(-50%, -50%)",
      width: "1080px",
      height: "700px",
      backgroundColor: "#ffffff",
      borderRadius: "12px",
      boxShadow: "0 10px 40px rgba(0, 0, 0, 0.2)",
      zIndex: "9999",
      fontFamily: "'Cairo', 'Segoe UI', Tahoma, sans-serif",
      overflow: "hidden",
      display: "flex",
      direction: "rtl"
    });
    const tmpLocalbuttonClasssidebarbt = "\n        <button class=\"sidebar-btn\" data-target=\"panel-upload\"><span class=\"btn-icon\">ğŸ“¤</span> Ø±ÙØ¹ Ù…Ù† Excel</button>\n        <button class=\"sidebar-btn\" data-target=\"panel-manual\"><span class=\"btn-icon\">âœï¸</span> Ø¥Ø±Ø³Ø§Ù„ ÙŠØ¯ÙˆÙŠ</button>\n    ";
    const tmpLocaldivIdpaneluploadClas = "\n        <div id=\"panel-upload\" class=\"panel-content\"></div>\n        <div id=\"panel-manual\" class=\"panel-content\"></div>\n    ";
    const tmpLocalbuttonClasssidebarbt2 = "\n        <button class=\"sidebar-btn active\" data-target=\"panel-subscription\" style=\"margin-top: auto; background-color: #1a4a7d;\">\n            <span class=\"btn-icon\">â­</span> Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙˆØ§Ù„Ø¯Ø¹Ù…\n        </button>\n    ";
    const tmpLocaldivIdpanelsubscripti = "<div id=\"panel-subscription\" class=\"panel-content\"></div>";
    tmp59.innerHTML = "\n        <div class=\"sidebar\" style=\"width: 220px; background-color: #0d1b2a; color: #e0e1dd; display: flex; flex-direction: column; flex-shrink: 0; cursor: move;\">\n            <div class=\"sidebar-header\" style=\"padding: 20px; text-align: center; border-bottom: 1px solid #415a77;\"><h3>ğŸ§¾ Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª</h3></div>\n            <div class=\"sidebar-menu\" style=\"flex-grow: 1; padding-top: 15px;\">\n                " + (p34 ? tmpLocalbuttonClasssidebarbt : "") + "\n                <button class=\"sidebar-btn\" data-target=\"panel-drafts\"><span class=\"btn-icon\">ğŸ“</span> Ø§Ù„Ù…Ø³ÙˆØ¯Ø§Øª</button>\n                " + (!p34 ? tmpLocalbuttonClasssidebarbt2 : "") + "\n            </div>\n        </div>\n        <div class=\"main-panel\" style=\"flex-grow: 1; background-color: #f4f7fa; display: flex; position: relative;\">\n            <button id=\"closeReceiptTabbedUIBtn\" title=\"Ø¥ØºÙ„Ø§Ù‚\" style=\"position: absolute; top: 10px; left: 10px; width: 32px; height: 32px; background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; border-radius: 50%; font-size: 24px; line-height: 30px; text-align: center; cursor: pointer; z-index: 10;\">&times;</button>\n            <div class=\"panel-content-wrapper\" style=\"flex-grow: 1; overflow-y: auto; position: relative;\">\n                " + (p34 ? tmpLocaldivIdpaneluploadClas : "") + "\n                <div id=\"panel-drafts\" class=\"panel-content\"></div>\n                " + (!p34 ? tmpLocaldivIdpanelsubscripti : "") + "\n            </div>\n        </div>\n    ";
    document.body.appendChild(tmp59);
    if (!document.getElementById("receiptUIStyles")) {
      const tmp60 = document.createElement("style");
      tmp60.id = "receiptUIStyles";
      tmp60.innerHTML = "\n            .sidebar-btn { display: flex; align-items: center; width: 100%; padding: 15px 20px; background-color: transparent; border: none; color: #e0e1dd; font-size: 16px; font-family: 'Cairo', sans-serif; text-align: right; cursor: pointer; transition: background-color 0.3s, color 0.3s; border-right: 4px solid transparent; }\n            .sidebar-btn:hover { background-color: #1b263b; }\n            .sidebar-btn.active { background-color: #415a77; color: #ffffff; font-weight: 700; border-right-color: #778da9; }\n            .sidebar-btn .btn-icon { margin-left: 12px; font-size: 18px; }\n            .panel-content { display: none; padding: 25px; height: 100%; box-sizing: border-box; }\n            .panel-content.active { display: block; animation: fadeIn 0.5s; }\n            @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }\n        ";
      document.head.appendChild(tmp60);
    }
    document.getElementById("closeReceiptTabbedUIBtn").onclick = () => tmp59.remove();
    tmp59.querySelectorAll(".sidebar-btn").forEach(p35 => {
      p35.addEventListener("click", () => {
        tmp59.querySelectorAll(".sidebar-btn").forEach(p36 => p36.classList.remove("active"));
        tmp59.querySelectorAll(".panel-content").forEach(p37 => p37.classList.remove("active"));
        p35.classList.add("active");
        const tmp61 = p35.getAttribute("data-target");
        const tmp62 = document.getElementById(tmp61);
        if (tmp62) {
          tmp62.classList.add("active");
        }
      });
    });
    fn79(tmp59, tmp59.querySelector(".sidebar"));
    if (p34) {
      fn20();
      setTimeout(() => tmp59.querySelector(".sidebar-btn[data-target=\"panel-upload\"]")?.click(), 100);
    } else {
      fn17(document.getElementById("panel-subscription"));
      setTimeout(() => tmp59.querySelector(".sidebar-btn[data-target=\"panel-subscription\"]")?.click(), 100);
    }
  }
  function fn19() {
    const tmp63 = window.fetch;
    window.fetch = async function (..._0x54e443) {
      const tmp64 = _0x54e443[0];
      const tmp65 = await tmp63.apply(this, _0x54e443);
      if (tmp65.ok && typeof tmp64 === "string" && tmp64.includes("/api/v1/documents/")) {
        try {
          const tmp66 = tmp65.clone();
          const tmp67 = await tmp66.json();
          const tmp68 = new CustomEvent("apiResponseIntercepted", {
            detail: {
              url: tmp64,
              data: tmp67
            }
          });
          window.dispatchEvent(tmp68);
        } catch (e4) {}
      }
      return tmp65;
    };
  }
  fn19();
  async function fn20() {
    document.getElementById("panel-upload").innerHTML = "\n        <div class=\"panel-header\"><h2>Ø±ÙØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ù…Ù† Ù…Ù„Ù Excel</h2><p>Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø±ÙØ¹Ù‡ Ø«Ù… Ø§ØªØ¨Ø¹ Ø§Ù„Ø®Ø·ÙˆØ§Øª.</p></div>\n        <div class=\"content-step\" style=\"margin-bottom: 25px;\">\n            <label for=\"documentTypeSelect\" class=\"content-label\" style=\"font-size: 16px; color: #0d1b2a;\">Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯</label>\n            <select id=\"documentTypeSelect\" class=\"content-select\" style=\"padding: 12px; font-size: 16px; background-color: white; border: 1px solid #ced4da; border-radius: 8px;\">\n                <option value=\"sale\">ğŸ§¾ Ø¥ÙŠØµØ§Ù„ Ø¨ÙŠØ¹ (Sale Receipt)</option>\n                <option value=\"return\">â†©ï¸ Ø¥Ø´Ø¹Ø§Ø± Ù…Ø±ØªØ¬Ø¹ (Return Receipt)</option>\n            </select>\n        </div>\n        <hr style=\"border: none; border-top: 1px solid #eee; margin: 20px 0;\">\n        <div id=\"dynamicUploaderContent\"></div>\n        <div style=\"text-align:center; margin-top:25px; padding:15px; background:#f8f9fa; border-top:2px solid #e9ecef; font-family:'Cairo','Segoe UI',sans-serif; line-height:1.8; font-size:16px; color:#333;\">\n            Ø§Ù„Ù„Ù‡ÙÙ… ØµÙ„Ù‘Ù Ø¹Ù„Ù‰ Ù…ÙØ­Ù…Ø¯  \n              \n\n            ğŸ’» Ø§Ù„Ù…ØµÙ…Ù… Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ : Ù…Ø­Ù…Ø¯ ØµØ¨Ø±ÙŠ  \n              \n\n            ğŸ“ ÙˆØ§ØªØ³Ø§Ø¨: 01060872599\n        </div>\n\n    ";
    function fn21() {
      const tmp69 = document.getElementById("documentTypeSelect").value;
      const tmp70 = document.getElementById("dynamicUploaderContent");
      const tmpLocalDisplayBlockTextalig = "display: block; text-align: center; padding: 12px; border-radius: 8px; text-decoration: none; cursor: pointer; color: white; font-weight: 600;";
      if (tmp69 === "sale") {
        tmp70.innerHTML = "\n                <div><h3 style=\"margin-top:0; color: #333;\">Ø§Ù„Ø®Ø·ÙˆØ© 2: ØªØ­Ù…ÙŠÙ„ Ù†Ù…ÙˆØ°Ø¬ ÙˆØ±ÙØ¹ Ù…Ù„ÙØ§Øª Ø§Ù„Ø¨ÙŠØ¹</h3></div>\n                <div style=\"margin-bottom: 20px;\"><a id=\"downloadReceiptTemplateBtn\" style=\"" + tmpLocalDisplayBlockTextalig + " background-color: #5a67d8;\">ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ù†Ù…ÙˆØ°Ø¬ Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¨ÙŠØ¹ Ø§Ù„Ø°ÙƒÙŠ</a></div>\n                <div><label for=\"receiptExcelInput\" style=\"" + tmpLocalDisplayBlockTextalig + " background-color: #38a169;\">ğŸ“‚ Ø§Ø®ØªØ± Ù…Ù„Ù Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¨ÙŠØ¹</label><input type=\"file\" id=\"receiptExcelInput\" accept=\".xlsx, .xls\" style=\"display: none;\"></div>\n            ";
        document.getElementById("downloadReceiptTemplateBtn").onclick = fn23;
        document.getElementById("receiptExcelInput").onchange = fn116;
      } else {
        tmp70.innerHTML = "\n                <div><h3 style=\"margin-top:0; color: #333;\">Ø§Ù„Ø®Ø·ÙˆØ© 2: ØªØ­Ù…ÙŠÙ„ Ù†Ù…ÙˆØ°Ø¬ ÙˆØ±ÙØ¹ Ù…Ù„ÙØ§Øª Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª</h3></div>\n                <div style=\"margin-bottom: 20px;\"><a id=\"downloadReturnTemplateBtn\" style=\"" + tmpLocalDisplayBlockTextalig + " background-color: #c0392b;\">ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø±ØªØ¬Ø¹</a></div>\n                <div><label for=\"returnExcelInput\" style=\"" + tmpLocalDisplayBlockTextalig + " background-color: #e67e22;\">ğŸ“‚ Ø§Ø®ØªØ± Ù…Ù„Ù Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø±ØªØ¬Ø¹</label><input type=\"file\" id=\"returnExcelInput\" accept=\".xlsx, .xls\" style=\"display: none;\"></div>\n            ";
        document.getElementById("downloadReturnTemplateBtn").onclick = fn125;
        document.getElementById("returnExcelInput").onchange = fn126;
      }
    }
    document.getElementById("documentTypeSelect").addEventListener("change", fn21);
    fn21();
    const tmp71 = document.getElementById("panel-manual");
    tmp71.innerHTML = "\n        <div class=\"panel-header\"><h2>Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³ØªÙ†Ø¯ ÙŠØ¯ÙˆÙŠ</h2><p>Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø¥Ù†Ø´Ø§Ø¦Ù‡ ÙŠØ¯ÙˆÙŠÙ‹Ø§.</p></div>\n        <div class=\"content-step\">\n            <label for=\"manualDocumentTypeSelect\" class=\"content-label\" style=\"font-size: 16px; color: #0d1b2a;\">Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯</label>\n            <select id=\"manualDocumentTypeSelect\" class=\"content-select\" style=\"padding: 12px; font-size: 16px; background-color: white; border: 1px solid #ced4da; border-radius: 8px;\"><option value=\"\" selected disabled>-- ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± --</option><option value=\"sale\">ğŸ§¾ Ø¥Ù†Ø´Ø§Ø¡ Ø¥ÙŠØµØ§Ù„ Ø¨ÙŠØ¹ ÙŠØ¯ÙˆÙŠ</option><option value=\"return\">â†©ï¸ Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø± Ù…Ø±ØªØ¬Ø¹ ÙŠØ¯ÙˆÙŠ</option></select>\n        </div>\n        <hr style=\"border: none; border-top: 1px solid #eee; margin: 20px 0;\">\n        <div id=\"dynamicManualSendContent\"><p style=\"text-align:center; color:#888; padding: 20px;\">ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø£Ø¹Ù„Ø§Ù‡ Ù„Ù„Ø¨Ø¯Ø¡.</p></div>\n        <div style=\"text-align:center; margin-top:25px; padding:15px; background:#f8f9fa; border-top:2px solid #e9ecef; font-family:'Cairo','Segoe UI',sans-serif; line-height:1.8; font-size:16px; color:#333;\">\n            Ø§Ù„Ù„Ù‡ÙÙ… ØµÙ„Ù‘Ù Ø¹Ù„Ù‰ Ù…ÙØ­Ù…Ø¯  \n              \n\n            ğŸ’» Ø§Ù„Ù…ØµÙ…Ù… Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ : Ù…Ø­Ù…Ø¯ ØµØ¨Ø±ÙŠ  \n              \n\n            ğŸ“ ÙˆØ§ØªØ³Ø§Ø¨: 01060872599\n        </div>\n    ";
    async function fn22() {
      const tmp72 = document.getElementById("manualDocumentTypeSelect").value;
      const tmp73 = document.getElementById("dynamicManualSendContent");
      if (!tmp72) {
        tmp73.innerHTML = "<p style=\"text-align:center; color:#888; padding: 20px;\">ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø£Ø¹Ù„Ø§Ù‡ Ù„Ù„Ø¨Ø¯Ø¡.</p>";
        return;
      }
      tmp73.innerHTML = "<p style=\"text-align:center; color:#333; padding: 20px;\">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ ÙˆØ§Ø¬Ù‡Ø© Ø¥Ù†Ø´Ø§Ø¡ " + (tmp72 === "sale" ? "Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¨ÙŠØ¹" : "Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø±ØªØ¬Ø¹") + "...</p>";
      try {
        const tmp74 = await fetchTaxpayerInfo();
        const tmp75 = tmp74.activities || [];
        let tmpLocal = "";
        if (tmp75.length > 0) {
          const tmp76 = tmp75.find(p38 => p38.toDate === null) || tmp75[0];
          tmpLocal = "<div class=\"info-field full-width\"><label for=\"manual-activity-code\" class=\"label\">ÙƒÙˆØ¯ Ø§Ù„Ù†Ø´Ø§Ø·:</label><select id=\"manual-activity-code\" class=\"form-group-select\">" + tmp75.map(p39 => "<option value=\"" + p39.activityTypeCode + "\" " + (p39.activityTypeCode === tmp76.activityTypeCode ? "selected" : "") + ">" + p39.activityTypeCode + " - " + p39.activityTypeNameSecondaryLang + "</option>").join("") + "</select></div>";
        }
        await fn25(tmp73, tmpLocal, tmp72);
      } catch (e5) {
        tmp73.innerHTML = "<p style=\"color: red; text-align: center;\">ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©: " + e5.message + "</p>";
      }
    }
    document.getElementById("manualDocumentTypeSelect").addEventListener("change", fn22);
    document.getElementById("panel-drafts").innerHTML = "\n        <div class=\"panel-header\"><h2>Ù…Ø³ÙˆØ¯Ø§Øª Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª</h2><p>Ù‡Ù†Ø§ ØªØ¸Ù‡Ø± Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„ØªÙŠ Ø­ÙØ¸ØªÙ‡Ø§ Ù„Ø¥Ø±Ø³Ø§Ù„Ù‡Ø§ Ù„Ø§Ø­Ù‚Ù‹Ø§.</p></div>\n        <div id=\"drafts-container\" style=\"border: 1px solid #ccc; border-radius: 8px; background: #fff; min-height: 300px; padding: 15px;\"></div>\n        <div style=\"text-align:center; margin-top:25px; padding:15px; background:#f8f9fa; border-top:2px solid #e9ecef; font-family:'Cairo','Segoe UI',sans-serif; line-height:1.8; font-size:16px; color:#333;\">\n            Ø§Ù„Ù„Ù‡ÙÙ… ØµÙ„Ù‘Ù Ø¹Ù„Ù‰ Ù…ÙØ­Ù…Ø¯  \n              \n\n            ğŸ’» Ø§Ù„Ù…ØµÙ…Ù… Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ : Ù…Ø­Ù…Ø¯ ØµØ¨Ø±ÙŠ  \n              \n\n            ğŸ“ ÙˆØ§ØªØ³Ø§Ø¨: 01060872599\n        </div>\n    ";
    fn40();
    document.querySelectorAll(".collapsible-header").forEach(p40 => {
      p40.addEventListener("click", () => {
        const tmp77 = p40.closest(".collapsible-section");
        tmp77.classList.toggle("open");
      });
    });
    try {
      if (!window.receiptUploaderData || !window.receiptUploaderData.seller) {
        const [tmp78, tmp79] = await Promise.all([fn51(), fn52()]);
        if (!tmp78 || !tmp79 || tmp79.length === 0) {
          throw new Error("ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ù…Ù…ÙˆÙ„ Ø£Ùˆ Ù†Ù‚Ø§Ø· Ø§Ù„Ø¨ÙŠØ¹.");
        }
        window.receiptUploaderData = {
          seller: tmp78,
          devices: tmp79,
          serial: tmp79[0].serialNumber
        };
      }
    } catch (e6) {}
  }
  async function fn23() {
    const tmpHex39bd1e = fn74("Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø´Ø§Ù…Ù„...", 0);
    try {
      if (typeof ExcelJS === "undefined") {
        throw new Error("Ù…ÙƒØªØ¨Ø© ExcelJS ØºÙŠØ± Ù…Ø­Ù…Ù„Ø©. Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ù„Ù.");
      }
      const tmp80 = new ExcelJS.Workbook();
      const tmp81 = tmp80.addWorksheet("Ù‚Ø§Ù„Ø¨ Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¨ÙŠØ¹");
      const tmp82 = tmp80.addWorksheet("Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
      const vA2 = [{
        code: "EGS"
      }, {
        code: "GS1"
      }];
      tmp82.getCell("A1").value = "Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯";
      vA2.forEach((p41, p42) => {
        tmp82.getCell("A" + (p42 + 2)).value = p41.code;
      });
      tmp82.getCell("B1").value = "Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ÙˆØ­Ø¯Ø§Øª";
      vA53.forEach((p43, p44) => {
        tmp82.getCell("B" + (p44 + 2)).value = p43.desc_ar;
      });
      tmp82.getCell("C1").value = "Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©";
      Object.values(vO62).forEach((p45, p46) => {
        tmp82.getCell("C" + (p46 + 2)).value = p45.desc;
      });
      tmp82.getCell("D1").value = "Currencies";
      vA.forEach((p47, p48) => {
        tmp82.getCell("D" + (p48 + 2)).value = p47.Desc_ar;
      });
      let vLN5 = 5;
      Object.values(vO62).forEach(p49 => {
        const tmp83 = tmp82.getCell(1, vLN5);
        const tmp84 = p49.desc.replace(/[ ()]/g, "_");
        tmp83.value = tmp84;
        p49.subtypes.forEach((p50, p51) => {
          tmp82.getCell(p51 + 2, vLN5).value = p50.desc;
        });
        const tmp85 = String.fromCharCode("A".charCodeAt(0) + vLN5 - 1);
        const tmp86 = "'Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'!$" + tmp85 + "$2:$" + tmp85 + "$" + (p49.subtypes.length + 1);
        tmp80.definedNames.add(tmp86, tmp84);
        vLN5++;
      });
      const vO2 = {
        "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø± (YYYY-MM-DD)": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: Ø£Ø¯Ø®Ù„ ØªØ§Ø±ÙŠØ® Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø¥ÙŠØµØ§Ù„.",
        "Ø±Ù‚Ù… Ø§Ù„Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ (*)": "Ù…Ø·Ù„ÙˆØ¨: Ø±Ù‚Ù… ÙØ±ÙŠØ¯ ÙŠÙ…ÙŠØ² Ø§Ù„Ø¥ÙŠØµØ§Ù„.",
        "Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)": "Ø§Ø³Ù… Ø§Ù„Ù…Ø´ØªØ±ÙŠ.",
        "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ù„Ù„Ø¹Ù…ÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)": "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ù„Ù„Ù…Ø´ØªØ±ÙŠ (14 Ø±Ù‚Ù…).",
        "Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ù„Ù„ØµÙ†Ù": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ù†Ø¸Ø§Ù…Ùƒ.",
        "ÙˆØµÙ Ø§Ù„ØµÙ†Ù (*)": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ø³Ù… Ø£Ùˆ ÙˆØµÙ ÙˆØ§Ø¶Ø­ Ù„Ù„Ø³Ù„Ø¹Ø©.",
        "Ù†ÙˆØ¹ ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (*)": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© (EGS Ø£Ùˆ GS1).",
        "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (*)": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„ÙØ¹Ù„ÙŠ Ù„Ù„ØµÙ†Ù.",
        "ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ (*)": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ø®ØªØ± ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©.",
        "Ø§Ù„ÙƒÙ…ÙŠØ© (*)": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¨Ø§Ø¹ Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„ØµÙ†Ù.",
        "Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø© (*)": "Ù…Ø·Ù„ÙˆØ¨: Ø³Ø¹Ø± Ø§Ù„Ù‚Ø·Ø¹Ø© Ø§Ù„ÙˆØ§Ø­Ø¯Ø© Ø¨Ø§Ù„Ø¹Ù…Ù„Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©.",
        "Ø¹Ù…Ù„Ø© Ø§Ù„Ø¨ÙŠØ¹": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…Ù„Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©. Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù‡Ùˆ Ø§Ù„Ø¬Ù†ÙŠÙ‡ Ø§Ù„Ù…ØµØ±ÙŠ.",
        "Ø³Ø¹Ø± Ø§Ù„ØµØ±Ù": "Ø¥Ø¬Ø¨Ø§Ø±ÙŠ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¹Ù…Ù„Ø© ØºÙŠØ± Ø§Ù„Ø¬Ù†ÙŠÙ‡. Ø£Ø¯Ø®Ù„ Ø³Ø¹Ø± ØµØ±Ù Ø§Ù„Ø¹Ù…Ù„Ø© Ù…Ù‚Ø§Ø¨Ù„ Ø§Ù„Ø¬Ù†ÙŠÙ‡.",
        "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 1 (*)": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ.",
        "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ Ù„Ù„Ø¶Ø±ÙŠØ¨Ø© 1 (*)": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ Ù„Ù„Ø¶Ø±ÙŠØ¨Ø©.",
        "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 1 (*)": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© Ù„Ù„Ø¶Ø±ÙŠØ¨Ø©.",
        "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 2 (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØµÙ†Ù Ø®Ø§Ø¶Ø¹Ù‹Ø§ Ù„Ø¶Ø±ÙŠØ¨Ø© Ø£Ø®Ø±Ù‰.",
        "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ Ù„Ù„Ø¶Ø±ÙŠØ¨Ø© 2 (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ Ù„Ù„Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©.",
        "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 2 (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©."
      };
      const tmp87 = Object.keys(vO2);
      tmp81.columns = tmp87.map(p52 => ({
        header: p52,
        key: p52,
        width: 35
      }));
      tmp81.getRow(1).eachCell(p53 => {
        p53.note = vO2[p53.value] || "";
        p53.font = {
          name: "Arial",
          bold: true,
          size: 12,
          color: {
            argb: "FFFFFFFF"
          }
        };
        p53.fill = {
          type: "pattern",
          pattern: "solid",
          fgColor: {
            argb: "FF007BFF"
          }
        };
        p53.alignment = {
          vertical: "middle",
          horizontal: "center",
          wrapText: true
        };
      });
      const vF2 = (p54, p55) => {
        for (let vLN2 = 2; vLN2 <= 1001; vLN2++) {
          tmp81.getCell("" + p54 + vLN2).dataValidation = {
            type: "list",
            allowBlank: true,
            formulae: [p55]
          };
        }
      };
      vF2("G", "='Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'!$A$2:$A$3");
      vF2("I", "='Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'!$B$2:$B$" + (vA53.length + 1));
      vF2("L", "='Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'!$D$2:$D$" + (vA.length + 1));
      vF2("N", "='Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'!$C$2:$C$" + (Object.keys(vO62).length + 1));
      vF2("Q", "='Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'!$C$2:$C$" + (Object.keys(vO62).length + 1));
      const tmpLocalINDIRECTSUBSTITUTESU = "=INDIRECT(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(N2,\" \",\"_\"),\"(\",\"_\"),\")\",\"_\"))";
      const tmpLocalINDIRECTSUBSTITUTESU2 = "=INDIRECT(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(Q2,\" \",\"_\"),\"(\",\"_\"),\")\",\"_\"))";
      vF2("O", tmpLocalINDIRECTSUBSTITUTESU);
      vF2("R", tmpLocalINDIRECTSUBSTITUTESU2);
      tmp82.state = "hidden";
      tmp81.views = [{
        rightToLeft: true,
        state: "frozen",
        ySplit: 1
      }];
      const tmp88 = await tmp80.xlsx.writeBuffer();
      const tmp89 = new Blob([tmp88], {
        type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
      });
      if (typeof saveAs === "undefined") {
        throw new Error("Ù…ÙƒØªØ¨Ø© FileSaver.js ØºÙŠØ± Ù…Ø­Ù…Ù„Ø©.");
      }
      saveAs(tmp89, "Ù†Ù…ÙˆØ°Ø¬_Ø¥ÙŠØµØ§Ù„Ø§Øª_Ø§Ù„Ø¨ÙŠØ¹_Ø¨Ø§Ù„Ø¹Ù…Ù„Ø§Øª.xlsx");
    } catch (e7) {
      alert("ÙØ´Ù„ Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø¥ÙƒØ³Ù„ Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª: " + e7.message);
    } finally {
      tmpHex39bd1e.remove();
    }
  }
  async function fn24(p56) {
    const tmp90 = p56.dataset.uuid;
    p56.textContent = "Ø¬Ø§Ø±ÙŠ...";
    p56.disabled = true;
    try {
      if (typeof jsPDF === "undefined" || typeof jsPDF.autoTable === "undefined" || typeof qrcode === "undefined") {
        throw new Error("Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (jsPDF, AutoTable, qrcode) ØºÙŠØ± Ù…Ø¹Ø±Ù‘ÙØ© ÙÙŠ Ø§Ù„Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¹Ø§Ù….");
      }
      const tmp91 = p56.closest("tr");
      const vO3 = {
        uuid: tmp90,
        receiptNumber: tmp91.cells[0].textContent,
        dateTimeIssued: tmp91.cells[2].textContent,
        receiverName: tmp91.cells[3].textContent,
        totalAmount: parseFloat(tmp91.cells[4].textContent),
        seller: window.receiptUploaderData?.seller || {}
      };
      const tmp92 = new jsPDF({
        orientation: "p",
        unit: "mm",
        format: "a4"
      });
      tmp92.setFont("Helvetica");
      tmp92.setRtl(true);
      const vF3 = p57 => {
        if (!p57) {
          return "";
        }
        return String(p57).split("").reverse().join("");
      };
      const vQrcode = qrcode(0, "M");
      const tmp93 = new Date(vO3.dateTimeIssued.replace("ØŒ", "")).toISOString();
      const tmp94 = "https://invoicing.eta.gov.eg/receipts/details/print/" + tmp90 + "/share/" + tmp93;
      vQrcode.addData(tmp94);
      vQrcode.make();
      const tmp95 = vQrcode.createDataURL(4);
      const vLN15 = 15;
      const tmp96 = tmp92.internal.pageSize.getWidth();
      tmp92.setFontSize(18).text(vF3("Ø¥ÙŠØµØ§Ù„ Ø¨ÙŠØ¹"), tmp96 - vLN15, vLN15, {
        align: "right"
      });
      tmp92.addImage(tmp95, "JPEG", vLN15, vLN15, 35, 35);
      let tmp97 = vLN15 + 10;
      tmp92.setFontSize(8);
      tmp92.text(vF3("Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ: ") + vO3.uuid, tmp96 - vLN15 - 40, tmp97, {
        align: "right"
      });
      tmp97 += 5;
      tmp92.text(vF3("Ø±Ù‚Ù… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ: ") + vO3.receiptNumber, tmp96 - vLN15 - 40, tmp97, {
        align: "right"
      });
      tmp97 += 5;
      tmp92.text(vF3("ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±: ") + vO3.dateTimeIssued, tmp96 - vLN15 - 40, tmp97, {
        align: "right"
      });
      tmp97 += 5;
      tmp92.text(vF3("Ø±Ù‚Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¨Ø§Ø¦Ø¹: ") + (vO3.seller.id || "N/A"), tmp96 - vLN15 - 40, tmp97, {
        align: "right"
      });
      tmp97 += 10;
      tmp92.autoTable({
        startY: tmp97,
        head: [[vF3("Ø§Ù„Ù…Ø´ØªØ±ÙŠ"), vF3("Ø§Ù„Ø¨Ø§Ø¦Ø¹")]],
        body: [[vF3(vO3.receiverName || ""), vF3((vO3.seller.name || "") + "\n" + (vO3.seller.id || "") + "\n" + (vO3.seller.street || "") + ", " + (vO3.seller.regionCity || ""))]],
        theme: "grid",
        styles: {
          font: "Helvetica",
          halign: "right"
        },
        headStyles: {
          fillColor: [220, 220, 220],
          textColor: 0
        }
      });
      tmp97 = tmp92.lastAutoTable.finalY + 10;
      const tmp98 = vO3.totalAmount;
      const vLN014 = 0.14;
      const tmp99 = tmp98 / (1 + vLN014);
      const tmp100 = tmp98 - tmp99;
      tmp92.autoTable({
        startY: tmp97,
        head: [[vF3("Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹"), vF3("Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©"), vF3("Ø§Ù„ØµØ§ÙÙŠ"), vF3("Ø§Ù„ÙˆØµÙ")]],
        body: [[tmp98.toFixed(2), tmp100.toFixed(2), tmp99.toFixed(2), vF3("Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù…Ø¨ÙŠØ¹Ø§Øª Ø§Ù„Ø¥ÙŠØµØ§Ù„")]],
        theme: "grid",
        styles: {
          font: "Helvetica",
          halign: "right"
        },
        headStyles: {
          fillColor: [220, 220, 220],
          textColor: 0
        }
      });
      tmp97 = tmp92.lastAutoTable.finalY + 10;
      const vA3 = [[tmp99.toFixed(2), vF3("Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª (Ø¬.Ù…)")], [tmp100.toFixed(2), vF3("Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ© (ØªÙ‚Ø±ÙŠØ¨ÙŠ)")], [{
        content: tmp98.toFixed(2),
        styles: {
          fontStyle: "bold"
        }
      }, {
        content: vF3("Ø§Ù„Ù…Ø¨Ù„Øº Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ (Ø¬.Ù…)"),
        styles: {
          fontStyle: "bold"
        }
      }]];
      tmp92.autoTable({
        startY: tmp97,
        body: vA3,
        theme: "plain",
        styles: {
          font: "Helvetica",
          halign: "right"
        },
        columnStyles: {
          0: {
            halign: "left"
          }
        },
        margin: {
          left: tmp96 / 2
        }
      });
      tmp92.save("receipt-" + tmp90 + ".pdf");
    } catch (e8) {
      alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ PDF: " + e8.message);
    } finally {
      p56.textContent = "ØªØ­Ù…ÙŠÙ„ PDF";
      p56.disabled = false;
    }
  }
  async function fn25(p58, p59, p60 = "sale") {
    const tmp101 = p60 === "return";
    const tmp102 = tmp101 ? "Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø± Ù…Ø±ØªØ¬Ø¹ ÙŠØ¯ÙˆÙŠ" : "Ø¥Ù†Ø´Ø§Ø¡ Ø¥ÙŠØµØ§Ù„ Ø¨ÙŠØ¹ ÙŠØ¯ÙˆÙŠ";
    const tmp103 = tmp101 ? "Ø±Ù‚Ù… Ø§Ù„Ù…Ø±ØªØ¬Ø¹ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ" : "Ø±Ù‚Ù… Ø§Ù„Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ";
    const tmp104 = tmp101 ? "RTN-" + Date.now() : "RCPT-" + Date.now();
    const tmp105 = tmp101 ? "Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø±ØªØ¬Ø¹" : "Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥ÙŠØµØ§Ù„";
    const tmpHex39bd1e2 = fn74("Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù…ÙˆÙ„ ÙˆÙ†Ù‚Ø§Ø· Ø§Ù„Ø¨ÙŠØ¹...", 0);
    const [tmp106, tmp107] = await Promise.all([fetchTaxpayerInfo(), fn52()]);
    tmpHex39bd1e2.remove();
    if (!tmp106 || !tmp107 || tmp107.length === 0) {
      p58.innerHTML = "<p style=\"color: red; text-align: center; padding: 20px;\">ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù…ÙˆÙ„ Ø£Ùˆ Ù†Ù‚Ø§Ø· Ø§Ù„Ø¨ÙŠØ¹. Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©.</p>";
      return;
    }
    const tmp108 = tmp107[0];
    const vA4 = [{
      Code: "T1",
      Desc_ar: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©"
    }, {
      Code: "T2",
      Desc_ar: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„ (Ù†Ø³Ø¨ÙŠØ©)"
    }, {
      Code: "T3",
      Desc_ar: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„ (Ø§Ù„Ù†ÙˆØ¹ÙŠØ©)"
    }, {
      Code: "T4",
      Desc_ar: "Ø§Ù„Ø®ØµÙ… ØªØ­Øª Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©"
    }, {
      Code: "T5",
      Desc_ar: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¯Ù…ØºØ© (Ù†Ø³Ø¨ÙŠØ©)"
    }, {
      Code: "T6",
      Desc_ar: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¯Ù…ØºØ© (Ù‚Ø·Ø¹ÙŠØ© Ø¨Ù…Ù‚Ø¯Ø§Ø± Ø«Ø§Ø¨Øª)"
    }, {
      Code: "T7",
      Desc_ar: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù…Ù„Ø§Ù‡ÙŠ"
    }, {
      Code: "T8",
      Desc_ar: "Ø±Ø³Ù… ØªÙ†Ù…ÙŠØ© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯"
    }, {
      Code: "T9",
      Desc_ar: "Ø±Ø³Ù… Ø®Ø¯Ù…Ø©"
    }, {
      Code: "T10",
      Desc_ar: "Ø±Ø³Ù… Ø§Ù„Ù…Ø­Ù„ÙŠØ§Øª"
    }, {
      Code: "T11",
      Desc_ar: "Ø±Ø³Ù… Ø§Ù„ØªØ£Ù…ÙŠÙ† Ø§Ù„ØµØ­ÙŠ"
    }, {
      Code: "T12",
      Desc_ar: "Ø±Ø³ÙˆÙ… Ø£Ø®Ø±Ù‰"
    }];
    const vA5 = [{
      Code: "V001",
      Desc_en: "Export",
      Desc_ar: "ØªØµØ¯ÙŠØ± Ù„Ù„Ø®Ø§Ø±Ø¬",
      TaxtypeReference: "T1"
    }, {
      Code: "V002",
      Desc_en: "Export to free areas and other areas",
      Desc_ar: "ØªØµØ¯ÙŠØ± Ù…Ù†Ø§Ø·Ù‚ Ø­Ø±Ø© ÙˆØ£Ø®Ø±Ù‰",
      TaxtypeReference: "T1"
    }, {
      Code: "V003",
      Desc_en: "Exempted good or service",
      Desc_ar: "Ø³Ù„Ø¹Ø© Ø£Ùˆ Ø®Ø¯Ù…Ø© Ù…Ø¹ÙØ§Ø©",
      TaxtypeReference: "T1"
    }, {
      Code: "V004",
      Desc_en: "A non-taxable good or service",
      Desc_ar: "Ø³Ù„Ø¹Ø© Ø£Ùˆ Ø®Ø¯Ù…Ø© ØºÙŠØ± Ø®Ø§Ø¶Ø¹Ø© Ù„Ù„Ø¶Ø±ÙŠØ¨Ø©",
      TaxtypeReference: "T1"
    }, {
      Code: "V005",
      Desc_en: "Exemptions for diplomats, consulates and embassies",
      Desc_ar: "Ø¥Ø¹ÙØ§Ø¡Ø§Øª Ø¯Ø¨Ù„ÙˆÙ…Ø§Ø³ÙŠÙ† ÙˆØ§Ù„Ù‚Ù†ØµÙ„ÙŠØ§Øª ÙˆØ§Ù„Ø³ÙØ§Ø±Ø§Øª",
      TaxtypeReference: "T1"
    }, {
      Code: "V006",
      Desc_en: "Defence and National security Exemptions",
      Desc_ar: "Ø¥Ø¹ÙØ§Ø¡Ø§Øª Ø§Ù„Ø¯ÙØ§Ø¹ ÙˆØ§Ù„Ø£Ù…Ù† Ø§Ù„Ù‚ÙˆÙ…Ù‰",
      TaxtypeReference: "T1"
    }, {
      Code: "V007",
      Desc_en: "Agreements exemptions",
      Desc_ar: "Ø¥Ø¹ÙØ§Ø¡Ø§Øª Ø§ØªÙØ§Ù‚ÙŠØ§Øª",
      TaxtypeReference: "T1"
    }, {
      Code: "V008",
      Desc_en: "Special Exemptios and other reasons",
      Desc_ar: "Ø¥Ø¹ÙØ§Ø¡Ø§Øª Ø®Ø§ØµØ© Ùˆ Ø£Ø®Ø±Ù‰",
      TaxtypeReference: "T1"
    }, {
      Code: "V009",
      Desc_en: "General Item sales",
      Desc_ar: "Ø³Ù„Ø¹ Ø¹Ø§Ù…Ø©",
      TaxtypeReference: "T1"
    }, {
      Code: "V010",
      Desc_en: "Other Rates",
      Desc_ar: "Ù†Ø³Ø¨ Ø¶Ø±ÙŠØ¨Ø© Ø£Ø®Ø±Ù‰",
      TaxtypeReference: "T1"
    }, {
      Code: "Tbl01",
      Desc_en: "Table tax (percentage)",
      Desc_ar: "Ø¶Ø±ÙŠØ¨Ù‡ Ø§Ù„Ø¬Ø¯ÙˆÙ„ (Ù†Ø³Ø¨ÙŠÙ‡)",
      TaxtypeReference: "T2"
    }, {
      Code: "Tbl02",
      Desc_en: "Table tax (Fixed Amount)",
      Desc_ar: "Ø¶Ø±ÙŠØ¨Ù‡ Ø§Ù„Ø¬Ø¯ÙˆÙ„ (Ø§Ù„Ù†ÙˆØ¹ÙŠØ©)",
      TaxtypeReference: "T3"
    }, {
      Code: "W001",
      Desc_en: "Contracting",
      Desc_ar: "Ø§Ù„Ù…Ù‚Ø§ÙˆÙ„Ø§Øª",
      TaxtypeReference: "T4"
    }, {
      Code: "W002",
      Desc_en: "Supplies",
      Desc_ar: "Ø§Ù„ØªÙˆØ±ÙŠØ¯Ø§Øª",
      TaxtypeReference: "T4"
    }, {
      Code: "W003",
      Desc_en: "Purachases",
      Desc_ar: "Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª",
      TaxtypeReference: "T4"
    }, {
      Code: "W004",
      Desc_en: "Services",
      Desc_ar: "Ø§Ù„Ø®Ø¯Ù…Ø§Øª",
      TaxtypeReference: "T4"
    }, {
      Code: "W010",
      Desc_en: "Professional fees",
      Desc_ar: "Ø§ØªØ¹Ø§Ø¨ Ù…Ù‡Ù†ÙŠØ©",
      TaxtypeReference: "T4"
    }, {
      Code: "ST01",
      Desc_en: "Stamping tax (percentage)",
      Desc_ar: "Ø¶Ø±ÙŠØ¨Ù‡ Ø§Ù„Ø¯Ù…ØºÙ‡ (Ù†Ø³Ø¨ÙŠÙ‡)",
      TaxtypeReference: "T5"
    }, {
      Code: "ST02",
      Desc_en: "Stamping Tax (amount)",
      Desc_ar: "Ø¶Ø±ÙŠØ¨Ù‡ Ø§Ù„Ø¯Ù…ØºÙ‡ (Ù‚Ø·Ø¹ÙŠÙ‡ Ø¨Ù…Ù‚Ø¯Ø§Ø± Ø«Ø§Ø¨Øª)",
      TaxtypeReference: "T6"
    }, {
      Code: "Ent01",
      Desc_en: "Entertainment tax (rate)",
      Desc_ar: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù…Ù„Ø§Ù‡Ù‰ (Ù†Ø³Ø¨Ø©)",
      TaxtypeReference: "T7"
    }, {
      Code: "RD01",
      Desc_en: "Resource development fee (rate)",
      Desc_ar: "Ø±Ø³Ù… ØªÙ†Ù…ÙŠÙ‡ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ (Ù†Ø³Ø¨Ø©)",
      TaxtypeReference: "T8"
    }, {
      Code: "SC01",
      Desc_en: "Service charges (rate)",
      Desc_ar: "Ø±Ø³Ù… Ø®Ø¯Ù…Ø© (Ù†Ø³Ø¨Ø©)",
      TaxtypeReference: "T9"
    }, {
      Code: "Mn01",
      Desc_en: "Municipality Fees (rate)",
      Desc_ar: "Ø±Ø³Ù… Ø§Ù„Ù…Ø­Ù„ÙŠØ§Øª (Ù†Ø³Ø¨Ø©)",
      TaxtypeReference: "T10"
    }, {
      Code: "MI01",
      Desc_en: "Medical insurance fee (rate)",
      Desc_ar: "Ø±Ø³Ù… Ø§Ù„ØªØ§Ù…ÙŠÙ† Ø§Ù„ØµØ­Ù‰ (Ù†Ø³Ø¨Ø©)",
      TaxtypeReference: "T11"
    }, {
      Code: "OF01",
      Desc_en: "Other fees (rate)",
      Desc_ar: "Ø±Ø³ÙˆÙ… Ø£Ø®Ø±Ù‰",
      TaxtypeReference: "T12"
    }];
    let vA6 = [];
    let tmp109 = -1;
    let tmp110 = null;
    const vF4 = () => {
      const tmp111 = p58.querySelector("#item-quantity");
      const tmp112 = p58.querySelector("#item-unit-price");
      const tmp113 = p58.querySelector("#item-total");
      if (tmp111 && tmp112 && tmp113) {
        tmp113.value = ((parseFloat(tmp111.value) || 0) * (parseFloat(tmp112.value) || 0)).toFixed(5);
      }
    };
    const tmp114 = tmp101 ? "\n        <div class=\"form-group\">\n            <label for=\"manual-reference-uuid\">UUID Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© (*)</label>\n            <div style=\"display: flex; align-items: center; gap: 10px;\">\n                <input type=\"text\" id=\"manual-reference-uuid\" required placeholder=\"Ø£Ø¯Ø®Ù„ UUID Ù‡Ù†Ø§ ÙˆØ§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø¨Ø­Ø«\" style=\"flex-grow: 1;\">\n                <button type=\"button\" id=\"fetch-invoice-details-btn\" title=\"Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©\" class=\"action-button\" style=\"padding: 10px 15px; flex-shrink: 0; background-color: #007bff; width: auto;\">ğŸ”</button>\n            </div>\n        </div>\n    " : "";
    const tmp115 = "\n        <!-- âœ… Ø­Ø§ÙˆÙŠØ© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ø¹Ø±Ø¶ Ø£ØµÙ†Ø§Ù Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© (Ù„Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª) -->\n        <div id=\"original-invoice-items-container\" style=\"display: none; background: #e9f5ff; border: 1px solid #b3d7ff; border-radius: 8px; padding: 15px; margin-bottom: 25px;\">\n            <h4 style=\"margin-top: 0; color: #0056b3;\">Ø£ØµÙ†Ø§Ù Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© (Ø­Ø¯Ø¯ Ù„Ù„Ø¥Ø±Ø¬Ø§Ø¹)</h4>\n            <div id=\"original-items-list\" style=\"max-height: 200px; overflow-y: auto; margin-bottom: 15px; border: 1px solid #ddd; background: #fff; padding: 10px;\">\n                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù‡Ù†Ø§ -->\n            </div>\n            <button type=\"button\" id=\"add-selected-to-return-btn\" class=\"action-button\" style=\"width: auto; padding: 10px 30px; background-color: #28a745;\">+ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø­Ø¯Ø¯ Ù„Ù„Ù…Ø±ØªØ¬Ø¹</button>\n        </div>\n\n        <!-- Ø²Ø± Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù Ø¬Ø¯ÙŠØ¯ -->\n        <button type=\"button\" id=\"add-new-item-button\" class=\"action-button\" style=\"width: auto; padding: 12px 30px; background-color: #007bff; margin-bottom: 20px;\">+ Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù Ø¬Ø¯ÙŠØ¯</button>\n\n        <!-- Ø­Ø§ÙˆÙŠØ© Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙ†Ù (Ù…Ø®ÙÙŠØ© Ù…Ø¨Ø¯Ø¦ÙŠÙ‹Ø§) -->\n        <div id=\"item-form-wrapper\" style=\"display: none; border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; background-color: #f8f9fa; margin-bottom: 20px;\">\n            <form id=\"item-form\">\n                <div class=\"form-grid\" style=\"align-items: flex-end;\">\n                    <div class=\"form-group\"><label>Ù†ÙˆØ¹ Ø§Ù„ÙƒÙˆØ¯</label><select id=\"item-code-type\" required><option value=\"EGS\">EGS</option><option value=\"GS1\">GS1</option></select></div>\n                    <div class=\"form-group\"><label>Ø§Ù„ÙƒÙˆØ¯</label><input type=\"text\" id=\"item-code\" required></div>\n                    <div class=\"form-group\"><label>Ø§Ø³Ù… Ø§Ù„ÙƒÙˆØ¯ (ØªÙ„Ù‚Ø§Ø¦ÙŠ)</label><input type=\"text\" id=\"item-code-name\" readonly style=\"background:#eee;\"></div>\n                    <div class=\"form-group\"><label>ÙˆØµÙ Ø§Ù„ØµÙ†Ù</label><input type=\"text\" id=\"item-description\" required></div>\n                    <div class=\"form-group\"><label>Ø§Ù„ÙƒÙ…ÙŠØ©</label><input type=\"number\" id=\"item-quantity\" value=\"1\" step=\"any\" required></div>\n <!-- âœ¨âœ¨âœ¨ Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø¬Ø¯ÙŠØ¯ ÙˆØ§Ù„Ù…Ø¹Ø¯Ù„ âœ¨âœ¨âœ¨ -->\n\n <!-- âœ¨ Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ø§Ù„Ø°ÙŠ ÙŠØ³ØªØ®Ø¯Ù… Ø§Ù„Ù…ØªØºÙŠØ± Ø§Ù„ØµØ­ÙŠØ­ -->\n<div class=\"form-group\">\n    <label>Ø§Ù„Ø¹Ù…Ù„Ø©</label>\n    <select id=\"item-currency\">\n        " + vA.map(p61 => "<option value=\"" + p61.code + "\">" + p61.Desc_ar + "</option>").join("") + "\n    </select>\n</div>\n\n <div class=\"form-group\">\n     <label>Ø³Ø¹Ø± Ø§Ù„ØµØ±Ù</label>\n     <input type=\"number\" id=\"item-exchange-rate\" value=\"1\" step=\"any\" required>\n </div>\n <div class=\"form-group\">\n     <label>Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø© (Ø¨Ø§Ù„Ø¹Ù…Ù„Ø©)</label>\n     <input type=\"number\" id=\"item-unit-price\" step=\"any\" required>\n </div>\n <div class=\"form-group\">\n     <label>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ (Ø¨Ø§Ù„Ø¬Ù†ÙŠÙ‡ Ø§Ù„Ù…ØµØ±ÙŠ)</label>\n     <input type=\"text\" id=\"item-total-egp\" readonly style=\"background:#eee; font-weight: bold;\">\n </div>\n\n\n                    </div>\n              <!-- --- âœ… Ø¨Ø¯Ø§ÙŠØ© ØªØ¹Ø¯ÙŠÙ„ ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨ --- -->\n<div style=\"margin-top: 20px; display: flex; align-items: center; gap: 15px;\">\n    <h4 style=\"margin: 0;\">Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨ Ø¹Ù„Ù‰ Ø§Ù„ØµÙ†Ù (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)</h4>\n    <button type=\"button\" id=\"add-tax-row-btn\" class=\"action-button\" style=\"width: auto; padding: 5px 15px; font-size: 14px;\">+ Ø¥Ø¶Ø§ÙØ© Ø¶Ø±ÙŠØ¨Ø©</button>\n</div>\n<div id=\"item-taxes-container\" style=\"margin-top: 10px; display: flex; flex-direction: column; gap: 10px;\">\n    <!-- ØµÙÙˆÙ Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨ Ø³ØªØªÙ… Ø¥Ø¶Ø§ÙØªÙ‡Ø§ Ù‡Ù†Ø§ Ø¹Ø¨Ø± JavaScript -->\n</div>\n<!-- --- âœ… Ù†Ù‡Ø§ÙŠØ© ØªØ¹Ø¯ÙŠÙ„ ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨ --- -->\n                <hr>\n                <div id=\"item-form-actions\" style=\"display: flex; gap: 10px;\">\n                    <button type=\"submit\" id=\"add-item-btn\" class=\"action-button\" style=\"width: auto; padding: 10px 30px;\">Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙ†Ù</button>\n                    <button type=\"button\" id=\"cancel-edit-btn\" class=\"action-button\" style=\"width: auto; padding: 10px 30px; background-color: #6c757d; display: none;\">Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„</button>\n                </div>\n            </form>\n        </div>\n        \n        <h4 style=\"margin-top: 25px;\">Ø§Ù„Ø£ØµÙ†Ø§Ù Ø§Ù„Ù…Ø¶Ø§ÙØ© (Ø§Ø¶ØºØ· Ù„Ù„ØªØ¹Ø¯ÙŠÙ„)</h4>\n<!-- --- âœ… ØªØ¹Ø¯ÙŠÙ„ 1: Ø¥Ø¶Ø§ÙØ© Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨ Ù„Ù„Ø¬Ø¯ÙˆÙ„ --- -->\n<table id=\"items-table\"><thead><tr><th>Ø§Ù„ÙƒÙˆØ¯</th><th>Ø§Ù„ÙˆØµÙ</th><th>Ø§Ù„ÙƒÙ…ÙŠØ©</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨</th><th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr></thead><tbody></tbody></table>\n    ";
    p58.innerHTML = "\n        <div id=\"manual-send-container\">\n            <div id=\"manualSendModal\" class=\"manual-modal\" style=\"display:flex;\">\n                <div class=\"manual-modal-content\">\n                  <div class=\"manual-modal-header\" style=\"cursor: move;\">\n    <h3>" + tmp102 + "</h3>\n    <button id=\"closeManualModalBtn\" title=\"Ø¥ØºÙ„Ø§Ù‚\" style=\"background: #f1f1f1; color: #555; border: none; width: 30px; height: 30px; border-radius: 50%; font-size: 20px; cursor: pointer; transition: all 0.2s;\">&times;</button>\n</div>\n\n                    <div class=\"manual-modal-body\">\n                        <div class=\"manual-tabs\">\n                            <button class=\"manual-tab-btn active\" data-tab-index=\"0\"><span class=\"tab-status-indicator\"></span>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</button>\n                            <button class=\"manual-tab-btn\" data-tab-index=\"1\"><span class=\"tab-status-indicator\"></span>Ø§Ù„Ø£ØµÙ†Ø§Ù</button>\n                            <button class=\"manual-tab-btn\" data-tab-index=\"2\"><span class=\"tab-status-indicator\"></span>Ø§Ù„Ù…Ù„Ø®Øµ ÙˆØ§Ù„Ø¯ÙØ¹</button>\n                        </div>\n                        <div class=\"manual-tab-content-wrapper\">\n                            <div id=\"tab-basic\" class=\"manual-tab-content active\">\n                            <div class=\"form-grid\">\n    <div class=\"form-group\"><label for=\"manual-receipt-number\">" + tmp103 + " (*)</label><input type=\"text\" id=\"manual-receipt-number\" required value=\"" + tmp104 + "\"></div>\n    \n    <div class=\"form-group\">\n        <label for=\"manual-datetime-issued\">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø± (*)</label>\n        <input type=\"date\" id=\"manual-datetime-issued\" required style=\"font-family: sans-serif; text-align: right;\">\n    </div>\n\n    " + tmp114 + "\n<div class=\"form-group\"><label for=\"manual-buyer-name\">Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</label><input type=\"text\" id=\"manual-buyer-name\" placeholder=\"Ø§ØªØ±ÙƒÙ‡ ÙØ§Ø±ØºÙ‹Ø§ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ Ø§Ø³Ù…\"></div>\n\n<div class=\"form-group\">\n    <label for=\"manual-buyer-id\">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ (14 Ø±Ù‚Ù…)</label>\n    <input type=\"text\" id=\"manual-buyer-id\" maxlength=\"14\" pattern=\"[0-9]{14}\" style=\"transition: all 0.3s ease;\">\n    <small id=\"nid-validation-status\" style=\"margin-top: 5px; font-weight: bold; height: 15px; display: block;\"></small>\n</div>\n                                </div>\n    <hr style=\"margin: 20px 0;\">\n<!-- âœ… Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØµØ¯Ø± ÙˆÙ†Ù‚Ø·Ø© Ø§Ù„Ø¨ÙŠØ¹ -->\n<div class=\"collapsible-section open\">\n    <div class=\"collapsible-header\">\n        <h4 style=\"margin: 0;\">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØµØ¯Ø± ÙˆÙ†Ù‚Ø·Ø© Ø§Ù„Ø¨ÙŠØ¹ (Ø§Ø¶ØºØ· Ù„Ù„ØªÙˆØ³ÙŠØ¹/Ø§Ù„Ø·ÙŠ)</h4>\n        <span class=\"collapsible-icon\">â–¼</span>\n    </div>\n    <div class=\"collapsible-content\">\n        <div class=\"form-grid\">\n            <!-- Ø§Ø®ØªÙŠØ§Ø± Ù†Ù‚Ø·Ø© Ø§Ù„Ø¨ÙŠØ¹ Ø¨Ø§Ù„Ø¹Ù†ÙˆØ§Ù† -->\n            <div class=\"form-group\">\n                <label for=\"pos-device-select\">Ù†Ù‚Ø·Ø© Ø§Ù„Ø¨ÙŠØ¹ (POS):</label>\n              \n            \n<select id=\"pos-device-select\" class=\"form-group-select\">\n    " + tmp107.map(p62 => {
      const tmp116 = p62.address || {};
      const tmp117 = (p62.formatedAddress || (tmp116.street || "") + ", " + (tmp116.regionCity || "")).replace(/^0\s+/, "").trim();
      let vO4 = {};
      if (p62.formatedAddress) {
        const tmp118 = p62.formatedAddress.trim();
        const tmp119 = tmp118.split(",");
        const tmp120 = tmp119[0] || "";
        const tmp121 = tmp120.match(/^(\d+)\s+/);
        let tmpLocal2 = "";
        let vV120 = tmp120;
        if (tmp121) {
          tmpLocal2 = tmp121[1];
          vV120 = tmp120.substring(tmp121[0].length).trim();
        }
        vO4 = {
          buildingNumber: tmpLocal2,
          street: vV120,
          regionCity: tmp119[1]?.trim() || "",
          governate: tmp119[2]?.trim() || ""
        };
      } else if (p62.address) {
        vO4 = {
          ...p62.address,
          buildingNumber: p62.address.buildingNo || ""
        };
      }
      return "<option value=\"" + p62.serialNumber + "\" data-address='" + JSON.stringify(vO4) + "' " + (p62.serialNumber === tmp108.serialNumber ? "selected" : "") + ">\n                    " + (tmp117 || p62.serialNumber) + "\n                </option>";
    }).join("") + "\n</select>\n\n                \n\n            </div>\n            " + p59 + "\n        </div>\n        <div class=\"form-grid\" style=\"margin-top: 15px;\">\n            <!-- Ø­Ù‚ÙˆÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØµØ¯Ø± Ø§Ù„Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„ -->\n            <div class=\"form-group\"><label>Ø§Ø³Ù… Ø§Ù„Ù…ØµØ¯Ø±</label><input type=\"text\" id=\"manual-seller-name\" value=\"" + tmp106.name + "\"></div>\n            <div class=\"form-group\"><label>Ø§Ù„Ø¯ÙˆÙ„Ø©</label><input type=\"text\" id=\"manual-seller-country\" value=\"EG\" readonly></div>\n            <div class=\"form-group\"><label>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</label><input type=\"text\" id=\"manual-seller-governate\" value=\"" + tmp106.governate + "\"></div>\n            <div class=\"form-group\"><label>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</label><input type=\"text\" id=\"manual-seller-regionCity\" value=\"" + tmp106.regionCity + "\"></div>\n            <div class=\"form-group\"><label>Ø§Ù„Ø´Ø§Ø±Ø¹</label><input type=\"text\" id=\"manual-seller-street\" value=\"" + tmp106.street + "\"></div>\n            <div class=\"form-group\"><label>Ø±Ù‚Ù… Ø§Ù„Ù…Ø¨Ù†Ù‰</label><input type=\"text\" id=\"manual-seller-building\" value=\"" + tmp106.buildingNumber + "\"></div>\n        </div>\n    </div>\n</div>\n\n\n                                \n                            </div>\n                            <div id=\"tab-items\" class=\"manual-tab-content\">" + tmp115 + "</div>\n\n                            <!-- --- âœ… Ø¨Ø¯Ø§ÙŠØ© ØªØ¹Ø¯ÙŠÙ„ Ù‡ÙŠÙƒÙ„ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ù„Ø®Øµ --- -->\n<!-- --- âœ… Ø¨Ø¯Ø§ÙŠØ© ØªØ¹Ø¯ÙŠÙ„ Ù‡ÙŠÙƒÙ„ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ø±Ø£Ø³ÙŠ --- -->\n<div id=\"tab-summary\" class=\"manual-tab-content\">\n    <div class=\"summary-container\">\n        <h3 class=\"summary-header\">Ù…Ù„Ø®Øµ Ø§Ù„Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ù…Ø§Ù„ÙŠ</h3>\n        \n        <div class=\"summary-list\">\n            <!-- 1. Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª -->\n            <div class=\"summary-item\">\n                <span class=\"summary-label\">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª (Ù‚Ø¨Ù„ Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨)</span>\n                <span class=\"summary-value sales\" id=\"summary-sales-total\">0.00 Ø¬.Ù…</span>\n            </div>\n\n            <!-- 2. Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®ØµÙˆÙ…Ø§Øª (Ø³ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· Ø¹Ù†Ø¯ ÙˆØ¬ÙˆØ¯ Ø®ØµÙ…) -->\n            <div class=\"summary-item\" id=\"summary-discount-row\" style=\"display: none;\">\n                <span class=\"summary-label\">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®ØµÙ…</span>\n                <span class=\"summary-value discount\" id=\"summary-discount-total\">0.00 Ø¬.Ù…</span>\n            </div>\n\n            <!-- 3. Ø­Ø§ÙˆÙŠØ© ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨ -->\n            <div id=\"summary-tax-details\">\n                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨ Ù‡Ù†Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->\n            </div>\n        </div>\n\n        <!-- 4. Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ -->\n        <div class=\"summary-item grand-total\">\n            <span class=\"summary-label\">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨</span>\n            <span class=\"summary-value\" id=\"summary-grand-total\">0.00 Ø¬.Ù…</span>\n        </div>\n    </div>\n\n    <!-- 5. Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹ -->\n    <div class=\"payment-section-vertical\">\n        <label for=\"payment-method\">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</label>\n        <select id=\"payment-method\">\n            <option value=\"C\" selected>Ù†Ù‚Ø¯ÙŠ (Cash)</option>\n            <option value=\"V\">ÙÙŠØ²Ø§/Ù…Ø§Ø³ØªØ±ÙƒØ§Ø±Ø¯ (Visa/Mastercard)</option>\n        </select>\n    </div>\n\n    <!-- 6. Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª -->\n\n    <!-- âœ¨ Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù…Ø¹ Ø²Ø± Ù‚Ø±Ø§Ø¡Ø© JSON âœ¨ -->\n<div class=\"actions-container\">\n    <button id=\"save-draft-btn\" class=\"action-button draft-btn\">ğŸ“ Ø­ÙØ¸ ÙƒÙ…Ø³ÙˆØ¯Ø©</button>\n    \n    <!-- âœ… Ø§Ù„Ø²Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù‡Ù†Ø§ âœ… -->\n    <button id=\"read-json-btn\" type=\"button\" class=\"action-button\" style=\"background-color: #fd7e14; color: white;\">ğŸ” Ù‚Ø±Ø§Ø¡Ø© JSON</button>\n    \n    <button id=\"send-manual-receipt-btn\" class=\"action-button send-btn\">" + tmp105 + "</button>\n</div>\n\n</div>\n<!-- --- âœ… Ù†Ù‡Ø§ÙŠØ© ØªØ¹Ø¯ÙŠÙ„ Ù‡ÙŠÙƒÙ„ ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ø±Ø£Ø³ÙŠ --- -->\n\n\n\n                        </div>\n                        <div class=\"manual-modal-footer\"><button id=\"prevTabBtn\" class=\"navigation-btn\" disabled>Ø§Ù„Ø³Ø§Ø¨Ù‚</button><button id=\"nextTabBtn\" class=\"navigation-btn\">Ø§Ù„ØªØ§Ù„ÙŠ</button></div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ";
    const tmp122 = document.createElement("style");
    tmp122.id = "manualSendFormStyles";
    if (!document.getElementById(tmp122.id)) {
      tmp122.innerHTML = "\n\n\n\n\n\n        /* --- Ø£Ù†Ù…Ø§Ø· ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© --- */\n.code-search-modal {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0, 0, 0, 0.6);\n    z-index: 10002; /* ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø£Ø¹Ù„Ù‰ Ù…Ù† Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    backdrop-filter: blur(5px);\n}\n.code-search-content {\n    width: 700px;\n    height: 80%;\n    background: #fff;\n    border-radius: 12px;\n    display: flex;\n    flex-direction: column;\n    box-shadow: 0 5px 25px rgba(0,0,0,0.2);\n}\n.code-search-header {\n    padding: 15px 20px;\n    border-bottom: 1px solid #dee2e6;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n.code-search-header h4 { margin: 0; color: #1d3557; }\n.code-search-header input {\n    width: 50%;\n    padding: 8px 12px;\n    border: 1px solid #ced4da;\n    border-radius: 8px;\n    font-size: 15px;\n}\n.code-search-body {\n    flex-grow: 1;\n    overflow-y: auto;\n    padding: 10px;\n}\n.code-search-table {\n    width: 100%;\n    border-collapse: collapse;\n}\n.code-search-table th, .code-search-table td {\n    padding: 12px;\n    text-align: right;\n    border-bottom: 1px solid #e9ecef;\n}\n.code-search-table th { background-color: #f8f9fa; font-weight: 600; }\n.code-search-table tbody tr { cursor: pointer; transition: background-color 0.2s; }\n.code-search-table tbody tr:hover { background-color: #e9f5ff; }\n.code-search-table .code-value { font-family: monospace; color: #007bff; direction: ltr; text-align: left; }\n.code-search-placeholder { text-align: center; padding: 40px; color: #888; font-size: 18px; }\n\n            /* --- ØªØµÙ…ÙŠÙ… Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© --- */\n            .manual-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 10001; display: none; align-items: center; justify-content: center; backdrop-filter: blur(5px); }\n            .manual-modal-content { width: 95%; max-width: 1300px; height: 90vh; background: #f4f7fa; border-radius: 16px; display: flex; flex-direction: column; overflow: hidden; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2); animation: zoomIn 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94); }\n            @keyframes zoomIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }\n            /* --- ØªØµÙ…ÙŠÙ… Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ (Header) --- */\n            .manual-modal-header { display: flex; justify-content: space-between; align-items: center; padding: 15px 25px; border-bottom: 1px solid #dee2e6; background-color: #ffffff; cursor: move; }\n            .manual-modal-header h3 { margin: 0; font-size: 20px; color: #1d3557; }\n            .manual-modal-header #closeManualModalBtn { background: #f1f1f1; color: #555; border: none; width: 30px; height: 30px; border-radius: 50%; font-size: 20px; cursor: pointer; transition: all 0.2s; }\n            .manual-modal-header #closeManualModalBtn:hover { background: #e63946; color: white; transform: rotate(90deg); }\n            /* --- ØªØµÙ…ÙŠÙ… Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª (Tabs) --- */\n            .manual-modal-body { flex-grow: 1; display: flex; flex-direction: column; overflow-y: auto; }\n            .manual-tabs { display: flex; border-bottom: 1px solid #dee2e6; padding: 0 20px; background-color: #ffffff; }\n            .manual-tab-btn { padding: 18px 25px; border: none; background: transparent; cursor: pointer; font-size: 16px; font-weight: 600; color: #6c757d; border-bottom: 4px solid transparent; transition: all 0.3s; display: flex; align-items: center; gap: 10px; }\n            .manual-tab-btn:hover { color: #007bff; background-color: #f8f9fa; }\n            .manual-tab-btn.active { border-bottom-color: #007bff; color: #007bff; }\n            .manual-tab-content-wrapper { flex-grow: 1; overflow-y: auto; }\n            .manual-tab-content { display: none; padding: 30px; }\n            .manual-tab-content.active { display: block; }\n            /* --- Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„ØªØ­Ù‚Ù‚ ÙˆØ£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ --- */\n            .tab-status-indicator { display: inline-block; width: 18px; height: 18px; border-radius: 50%; line-height: 18px; text-align: center; font-size: 12px; font-weight: bold; color: white; background-color: #ced4da; transition: all 0.3s; }\n            .tab-status-indicator.valid { background-color: #28a745; } .tab-status-indicator.valid::before { content: 'âœ”'; }\n            .tab-status-indicator.invalid { background-color: #dc3545; } .tab-status-indicator.invalid::before { content: 'âœ–'; }\n            .manual-modal-footer { padding: 15px 25px; border-top: 1px solid #dee2e6; display: flex; justify-content: space-between; background-color: #f8f9fa; }\n            .navigation-btn { padding: 10px 30px; font-size: 16px; font-weight: bold; border: none; border-radius: 8px; cursor: pointer; transition: all 0.2s; }\n            .navigation-btn:disabled { background-color: #e9ecef; color: #6c757d; cursor: not-allowed; }\n            #nextTabBtn { background-color: #007bff; color: white; }\n            #prevTabBtn { background-color: #6c757d; color: white; }\n            /* --- ØªØµÙ…ÙŠÙ… Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ ÙˆØ§Ù„Ø¬Ø¯Ø§ÙˆÙ„ --- */\n            .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; }\n            .form-group { display: flex; flex-direction: column; }\n            .form-group label { margin-bottom: 8px; font-weight: 600; color: #495057; font-size: 14px; }\n            .form-group input, .form-group select { padding: 12px; border: 1px solid #ced4da; border-radius: 8px; font-size: 15px; transition: all 0.2s; }\n            .form-group input:focus, .form-group select:focus { border-color: #007bff; box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1); outline: none; }\n            .form-group input[readonly] { background-color: #e9ecef; cursor: not-allowed; }\n            #items-table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }\n            #items-table th, #items-table td { border: 1px solid #e9ecef; padding: 12px; text-align: center; }\n            #items-table th { background-color: #e9ecef; font-weight: 700; color: #343a40; }\n            #items-table tbody tr:nth-child(even) { background-color: #f8f9fa; }\n            #items-table tbody tr { cursor: pointer; transition: background-color 0.2s; }\n            #items-table tbody tr:hover { background-color: #e9ecef; }\n            .editing-item { background-color: #fffbe6 !important; border: 2px solid #ffe58f; }\n            .action-button { transition: all 0.2s; }\n            .action-button:hover { transform: translateY(-2px); box-shadow: 0 4px 10px rgba(0,0,0,0.15); }\n\n\n\n            .tax-row { \n    display: grid; \n    grid-template-columns: 1fr 1fr 1fr auto; \n    gap: 15px; \n    align-items: flex-end; \n    padding: 10px; \n    background: #f0f0f0; \n    border-radius: 6px; \n}\n.delete-tax-row-btn { \n    background: #f8d7da; \n    color: #721c24; \n    border: 1px solid #f5c6cb; \n    border-radius: 50%; \n    width: 32px; \n    height: 32px; \n    font-size: 20px; \n    cursor: pointer; \n}\n    /* --- âœ… Ø¨Ø¯Ø§ÙŠØ© Ø£Ù†Ù…Ø§Ø· Ù‚Ø³Ù… Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ --- */\n.summary-grid {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 25px;\n    margin-bottom: 30px;\n}\n.summary-card {\n    background: #ffffff;\n    border-radius: 12px;\n    padding: 25px;\n    display: flex;\n    align-items: center;\n    gap: 20px;\n    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.06);\n    border: 1px solid #e9ecef;\n}\n.summary-card .card-icon {\n    font-size: 36px;\n    background-color: #e7f3ff;\n    color: #007bff;\n    width: 60px;\n    height: 60px;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n.summary-card.grand-total .card-icon {\n    background-color: #d4edda;\n    color: #155724;\n}\n.summary-card .card-content {\n    display: flex;\n    flex-direction: column;\n}\n.summary-card .card-label {\n    font-size: 15px;\n    color: #6c757d;\n    margin-bottom: 5px;\n}\n.summary-card .card-value {\n    font-size: 26px;\n    font-weight: 700;\n    color: #343a40;\n}\n.tax-details-container {\n    background: #ffffff;\n    border-radius: 12px;\n    padding: 20px;\n    margin-bottom: 30px;\n    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.06);\n}\n.tax-details-header {\n    margin: 0 0 15px 0;\n    color: #1d3557;\n    border-bottom: 1px solid #eee;\n    padding-bottom: 10px;\n}\n.tax-details-body {\n    display: flex;\n    flex-direction: column;\n    gap: 12px;\n}\n.tax-detail-row {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 10px;\n    background-color: #f8f9fa;\n    border-radius: 8px;\n    font-size: 16px;\n}\n.tax-detail-row .tax-name {\n    font-weight: 600;\n    color: #495057;\n}\n.tax-detail-row .tax-amount {\n    font-weight: bold;\n    color: #212529;\n    direction: ltr;\n}\n.tax-detail-row.withholding-tax .tax-amount {\n    color: #c0392b; /* Ù„ÙˆÙ† Ø£Ø­Ù…Ø± Ù„Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø®ØµÙ… */\n}\n.tax-placeholder {\n    text-align: center;\n    color: #888;\n    padding: 20px;\n}\n.payment-section {\n    display: grid;\n    grid-template-columns: 1fr 2fr;\n    gap: 25px;\n    align-items: flex-end;\n    margin-top: 20px;\n    border-top: 1px solid #dee2e6;\n    padding-top: 30px;\n}\n.actions-container {\n    display: flex;\n    gap: 15px;\n}\n.actions-container .action-button {\n    flex-grow: 1;\n    padding: 15px;\n    font-size: 18px;\n    font-weight: bold;\n}\n.actions-container .draft-btn { background-color: #ffc107; color: #333; }\n.actions-container .send-btn { background-color: #28a745; color: white; }\n/* --- âœ… Ù†Ù‡Ø§ÙŠØ© Ø£Ù†Ù…Ø§Ø· Ù‚Ø³Ù… Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ --- */\n\n/* --- âœ… Ø¨Ø¯Ø§ÙŠØ© Ø£Ù†Ù…Ø§Ø· Ù‚Ø³Ù… Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ø±Ø£Ø³ÙŠ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ --- */\n.summary-container {\n    background: #ffffff;\n    border-radius: 12px;\n    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.07);\n    border: 1px solid #e9ecef;\n    overflow: hidden;\n    margin-bottom: 30px;\n}\n.summary-header {\n    margin: 0;\n    padding: 18px 25px;\n    background-color: #f8f9fa;\n    color: #1d3557;\n    font-size: 18px;\n    border-bottom: 1px solid #dee2e6;\n}\n.summary-list {\n    padding: 15px 25px;\n}\n.summary-item {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 15px 0;\n    border-bottom: 1px dashed #e0e0e0;\n}\n.summary-list .summary-item:last-child {\n    border-bottom: none;\n}\n.summary-label {\n    font-size: 16px;\n    color: #495057;\n    font-weight: 600;\n}\n.summary-value {\n    font-size: 18px;\n    font-weight: 700;\n    direction: ltr;\n}\n.summary-value.sales { color: #007bff; }\n.summary-value.discount { color: #e67e22; }\n\n.tax-detail-row {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 12px 0;\n    border-bottom: 1px dashed #e0e0e0;\n}\n.tax-detail-row .tax-name {\n    font-size: 15px;\n    color: #6c757d;\n}\n.tax-detail-row .tax-amount {\n    font-weight: 600;\n    color: #28a745;\n    direction: ltr;\n}\n.tax-detail-row.withholding-tax .tax-amount {\n    color: #c0392b; /* Ù„ÙˆÙ† Ø£Ø­Ù…Ø± Ù„Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø®ØµÙ… */\n}\n\n.summary-item.grand-total {\n    background-color: #f8f9fa;\n    padding: 20px 25px;\n    margin: 15px -25px -15px -25px;\n    border-top: 1px solid #dee2e6;\n}\n.summary-item.grand-total .summary-label {\n    font-size: 18px;\n    color: #1d3557;\n}\n.summary-item.grand-total .summary-value {\n    font-size: 28px;\n    color: #155724;\n}\n.payment-section-vertical {\n    margin-bottom: 30px;\n}\n.payment-section-vertical label {\n    font-weight: bold;\n    margin-bottom: 10px;\n    display: block;\n}\n.payment-section-vertical select {\n    width: 100%;\n    padding: 12px;\n    font-size: 16px;\n}\n.actions-container {\n    display: flex;\n    gap: 15px;\n}\n.actions-container .action-button {\n    flex-grow: 1;\n    padding: 15px;\n    font-size: 18px;\n    font-weight: bold;\n}\n.actions-container .draft-btn { background-color: #ffc107; color: #333; }\n.actions-container .send-btn { background-color: #28a745; color: white; }\n/* --- âœ… Ù†Ù‡Ø§ÙŠØ© Ø£Ù†Ù…Ø§Ø· Ù‚Ø³Ù… Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ø±Ø£Ø³ÙŠ --- */\n\n        ";
      document.head.appendChild(tmp122);
    }
    const tmp123 = p58.querySelector("#manualSendModal");
    const tmp124 = p58.querySelector(".manual-modal-header");
    fn79(tmp123, tmp124);
    const tmp125 = p58.querySelector("#manual-buyer-id");
    const tmp126 = p58.querySelector("#nid-validation-status");
    async function fn26(p63) {
      if (!p63 || p63.length !== 14 || !/^\d+$/.test(p63)) {
        return {
          valid: false,
          message: "ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ 14 Ø±Ù‚Ù…Ù‹Ø§ ØµØ­ÙŠØ­Ù‹Ø§."
        };
      }
      try {
        const tmpHex57971a = getAccessTokenFromUserData();
        if (!tmpHex57971a) {
          return {
            valid: false,
            message: "Ø®Ø·Ø£ Ù…ØµØ§Ø¯Ù‚Ø©."
          };
        }
        const tmp127 = await fetch("https://api-portal.invoicing.eta.gov.eg/api/v1/person/" + p63, {
          headers: {
            Authorization: "Bearer " + tmpHex57971a
          }
        });
        if (tmp127.status === 200) {
          const tmp128 = await tmp127.json();
          const tmp129 = ((tmp128.firstName || "") + " " + (tmp128.otherNames || "")).trim();
          return {
            valid: true,
            message: "ØµØ­ÙŠØ­ (" + (tmp129 || "Ø´Ø®Øµ") + ")"
          };
        } else if (tmp127.status === 400) {
          const tmp130 = await tmp127.json();
          return {
            valid: false,
            message: tmp130.error.details[0].message || "Ø±Ù‚Ù… Ù‚ÙˆÙ…ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­."
          };
        } else {
          return {
            valid: false,
            message: "Ø®Ø·Ø£ " + tmp127.status + " Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…."
          };
        }
      } catch (e9) {
        return {
          valid: false,
          message: "ÙØ´Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù‚Ù…."
        };
      }
    }
    tmp125.addEventListener("blur", async () => {
      const tmp131 = tmp125.value.trim();
      if (!tmp131) {
        tmp126.textContent = "";
        tmp125.style.backgroundColor = "";
        tmp125.style.borderColor = "";
        return;
      }
      tmp126.textContent = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...";
      tmp126.style.color = "#007bff";
      const tmp132 = await fn26(tmp131);
      if (tmp132.valid) {
        tmp126.textContent = "âœ… " + tmp132.message;
        tmp126.style.color = "#28a745";
        tmp125.style.backgroundColor = "#d4edda";
        tmp125.style.borderColor = "#28a745";
      } else {
        tmp126.textContent = "âŒ " + tmp132.message;
        tmp126.style.color = "#dc3545";
        tmp125.style.backgroundColor = "#f8d7da";
        tmp125.style.borderColor = "#dc3545";
      }
    });
    tmp125.addEventListener("input", () => {
      if (tmp125.style.backgroundColor !== "") {
        tmp126.textContent = "";
        tmp125.style.backgroundColor = "";
        tmp125.style.borderColor = "";
      }
    });
    p58.querySelector("#closeManualModalBtn").onclick = () => {
      tmp123.style.display = "none";
      p58.innerHTML = "";
    };
    const tmp133 = p58.querySelector("#pos-device-select");
    tmp133.addEventListener("change", p64 => {
      const tmp134 = p64.target.options[p64.target.selectedIndex];
      const tmp135 = JSON.parse(tmp134.dataset.address || "{}");
      let tmp136 = tmp135.buildingNumber || "";
      let tmp137 = tmp135.street || "";
      if (tmp137 && !tmp136) {
        const tmp138 = tmp137.match(/^(\d+)\s+/);
        if (tmp138) {
          tmp136 = tmp138[1];
          tmp137 = tmp137.substring(tmp138[0].length).trim();
        }
      }
      p58.querySelector("#manual-seller-governate").value = tmp135.governate || "";
      p58.querySelector("#manual-seller-regionCity").value = tmp135.regionCity || "";
      p58.querySelector("#manual-seller-street").value = tmp137;
      p58.querySelector("#manual-seller-building").value = tmp136;
    });
    tmp133.dispatchEvent(new Event("change"));
    const tmp139 = Array.from(p58.querySelectorAll(".manual-tab-btn"));
    const tmp140 = Array.from(p58.querySelectorAll(".manual-tab-content"));
    const tmp141 = p58.querySelector("#prevTabBtn");
    const tmp142 = p58.querySelector("#nextTabBtn");
    let vLN02 = 0;
    function fn27(p65) {
      if (p65 < 0 || p65 >= tmp139.length) {
        return;
      }
      fn29();
      tmp139.forEach(p66 => p66.classList.remove("active"));
      tmp140.forEach(p67 => p67.classList.remove("active"));
      tmp139[p65].classList.add("active");
      tmp140[p65].classList.add("active");
      vLN02 = p65;
      tmp141.disabled = vLN02 === 0;
      tmp142.disabled = vLN02 === tmp139.length - 1;
    }
    tmp139.forEach(p68 => p68.addEventListener("click", () => fn27(parseInt(p68.dataset.tabIndex))));
    tmp141.addEventListener("click", () => fn27(vLN02 - 1));
    tmp142.addEventListener("click", () => fn27(vLN02 + 1));
    function fn28(p69) {
      const tmp143 = tmp140[p69];
      const tmp144 = tmp139[p69].querySelector(".tab-status-indicator");
      let tmp145 = true;
      if (p69 === 1) {
        tmp145 = vA6.length > 0;
      } else {
        const tmp146 = tmp143.querySelectorAll("[required]");
        for (const tmp147 of tmp146) {
          if (!tmp147.value.trim()) {
            tmp145 = false;
            break;
          }
        }
      }
      tmp144.classList.remove("valid", "invalid");
      tmp144.classList.add(tmp145 ? "valid" : "invalid");
    }
    function fn29() {
      tmp139.forEach((p70, p71) => fn28(p71));
    }
    tmp123.querySelectorAll("input[required], select[required]").forEach(p72 => p72.addEventListener("input", fn29));
    const tmp148 = p58.querySelector("#add-new-item-button");
    const tmp149 = p58.querySelector("#item-form-wrapper");
    tmp148.addEventListener("click", () => {
      tmp149.style.display = "block";
      tmp148.style.display = "none";
      fn32();
      tmp149.scrollIntoView({
        behavior: "smooth",
        block: "start"
      });
    });
    function fn32() {
      tmp173.reset();
      tmp158.innerHTML = "";
      vF4();
      tmp109 = -1;
      tmp175.textContent = "Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙ†Ù";
      tmp176.style.display = "none";
      tmp174.querySelectorAll("tr").forEach(p73 => p73.classList.remove("editing-item"));
      tmp149.style.display = "none";
      tmp148.style.display = "block";
    }
    const tmp150 = p58.querySelector("#item-quantity");
    const tmp151 = p58.querySelector("#item-unit-price");
    const tmp152 = p58.querySelector("#item-currency");
    const tmp153 = p58.querySelector("#item-exchange-rate");
    const tmp154 = p58.querySelector("#item-total-egp");
    const vF5 = () => {
      const tmp155 = parseFloat(tmp150.value) || 0;
      const tmp156 = parseFloat(tmp151.value) || 0;
      const tmp157 = parseFloat(tmp153.value) || 1;
      tmp154.value = (tmp155 * tmp156 * tmp157).toFixed(5);
    };
    tmp152.addEventListener("change", () => {
      if (tmp152.value === "EGP") {
        tmp153.value = 1;
        tmp153.readOnly = true;
        tmp153.style.backgroundColor = "#eee";
      } else {
        tmp153.readOnly = false;
        tmp153.style.backgroundColor = "white";
      }
      vF5();
    });
    [tmp150, tmp151, tmp153, tmp152].forEach(p74 => p74.addEventListener("input", vF5));
    tmp152.dispatchEvent(new Event("change"));
    const tmp158 = p58.querySelector("#item-taxes-container");
    let vLN03 = 0;
    function fn31(p75 = null) {
      if (tmp158.children.length >= 2) {
        fn74("Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø£ÙƒØ«Ø± Ù…Ù† Ø¶Ø±ÙŠØ¨ØªÙŠÙ†.", 3000);
        return;
      }
      const tmp159 = document.createElement("div");
      tmp159.className = "tax-row";
      tmp159.innerHTML = "\n        <div class=\"form-group\"><label>Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ</label><select class=\"tax-type\">" + vA4.map(p76 => "<option value=\"" + p76.Code + "\">" + p76.Desc_ar + "</option>").join("") + "</select></div>\n        <div class=\"form-group\"><label>Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ</label><select class=\"tax-subtype\"></select></div>\n        <div class=\"form-group\"><label>Ø§Ù„Ù†Ø³Ø¨Ø© %</label><input type=\"number\" class=\"tax-rate\" step=\"any\" placeholder=\"Ù…Ø«Ø§Ù„: 14\"></div>\n        <button type=\"button\" class=\"delete-tax-row-btn\" title=\"Ø­Ø°Ù Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©\">&times;</button>\n    ";
      tmp158.appendChild(tmp159);
      const tmp160 = tmp159.querySelector(".tax-type");
      const tmp161 = tmp159.querySelector(".tax-subtype");
      const vF6 = () => {
        const tmp162 = tmp160.value;
        const tmp163 = vA5.filter(p77 => {
          const tmp164 = vA4.find(p78 => p78.Code === tmp162);
          return p77.TaxtypeReference === tmp164?.Desc_ar || p77.TaxtypeReference === tmp162;
        });
        tmp161.innerHTML = tmp163.map(p79 => "<option value=\"" + p79.Code + "\">" + p79.Desc_ar + "</option>").join("");
        if (tmp162 === "T1") {
          tmp161.value = "V009";
        }
      };
      tmp160.addEventListener("change", vF6);
      vF6();
      if (p75) {
        tmp160.value = p75.taxType;
        vF6();
        tmp161.value = p75.subType;
        tmp159.querySelector(".tax-rate").value = p75.rate;
      }
      tmp159.querySelector(".delete-tax-row-btn").onclick = () => {
        tmp159.remove();
        fn35();
      };
      tmp159.querySelector(".tax-rate").addEventListener("input", fn35);
    }
    p58.querySelector("#add-tax-row-btn").onclick = () => fn31();
    const tmp165 = p58.querySelector("#item-code");
    const tmp166 = p58.querySelector("#item-code-name");
    const tmp167 = p58.querySelector("#item-code-type");
    const tmp168 = tmp165.parentElement;
    tmp168.style.position = "relative";
    const tmp169 = document.createElement("span");
    tmp169.innerHTML = "ğŸ”";
    Object.assign(tmp169.style, {
      position: "absolute",
      left: "10px",
      top: "50%",
      transform: "translateY(-50%)",
      cursor: "pointer",
      fontSize: "18px",
      display: tmp167.value === "EGS" ? "block" : "none"
    });
    tmp168.appendChild(tmp169);
    const vF7 = () => {
      tmp169.style.display = tmp167.value === "EGS" ? "block" : "none";
    };
    tmp167.addEventListener("change", vF7);
    tmp169.addEventListener("click", p80 => {
      p80.stopPropagation();
      fn38(p81 => {
        tmp165.value = p81.codeLookupValue;
        tmp166.value = p81.codeNameSecondaryLang;
        p58.querySelector("#item-description").value = p81.codeNameSecondaryLang;
      });
    });
    const vF10 = async () => {
      const tmp170 = tmp165.value.trim();
      const tmp171 = tmp167.value;
      if (!tmp170) {
        tmp166.value = "";
        return;
      }
      tmp166.value = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚...";
      let tmp172 = null;
      if (tmp171 === "EGS") {
        tmp172 = await fn92(tmp170);
      } else if (tmp171 === "GS1") {
        tmp172 = await fn93(tmp170);
      }
      tmp166.value = tmp172 ? tmp172.codeNameSecondaryLang : "!! ÙƒÙˆØ¯ ØºÙŠØ± ØµØ§Ù„Ø­ !!";
    };
    tmp165.addEventListener("blur", vF10);
    tmp167.addEventListener("change", vF10);
    const tmp173 = p58.querySelector("#item-form");
    const tmp174 = p58.querySelector("#items-table tbody");
    const tmp175 = p58.querySelector("#add-item-btn");
    const tmp176 = p58.querySelector("#cancel-edit-btn");
    function fn32() {
      tmp173.reset();
      tmp158.innerHTML = "";
      vLN03 = 0;
      vF4();
      tmp109 = -1;
      tmp175.textContent = "Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙ†Ù";
      tmp176.style.display = "none";
      tmp174.querySelectorAll("tr").forEach(p82 => p82.classList.remove("editing-item"));
    }
    tmp176.addEventListener("click", fn32);
    function fn33(p83) {
      p58.querySelector("#item-code-type").value = p83.itemType;
      p58.querySelector("#item-code").value = p83.itemCode;
      p58.querySelector("#item-description").value = p83.description;
      p58.querySelector("#item-quantity").value = p83.quantity;
      const tmp177 = p58.querySelector("#item-currency");
      const tmp178 = p58.querySelector("#item-exchange-rate");
      const tmp179 = p58.querySelector("#item-unit-price");
      tmp177.value = p83.currencySold || "EGP";
      tmp178.value = p83.exchangeRate || 1;
      tmp179.value = p83.unitPrice;
      tmp177.dispatchEvent(new Event("change"));
      vF5();
      const tmp180 = p58.querySelector("#item-taxes-container");
      tmp180.innerHTML = "";
      if (p83.taxableItems && p83.taxableItems.length > 0) {
        p83.taxableItems.forEach(p84 => {
          fn31(p84);
        });
      }
      p58.querySelector("#item-code").dispatchEvent(new Event("blur"));
    }
    function fn34() {
      tmp174.innerHTML = "";
      vA6.forEach((p85, p86) => {
        const tmp181 = tmp174.insertRow();
        tmp181.dataset.index = p86;
        tmp181.className = p86 === tmp109 ? "editing-item" : "";
        const tmp182 = p85.taxableItems.map(p87 => p87.taxType + "(" + p87.rate + "%)").join(", ") || "<span style=\"color: #999;\">Ù„Ø§ ÙŠÙˆØ¬Ø¯</span>";
        tmp181.innerHTML = "\n    <td>" + p85.itemCode + "</td>\n    <td>" + p85.description + "</td>\n    <td>" + p85.quantity + "</td>\n    <td>" + p85.unitPrice.toFixed(2) + "</td>\n    <td style=\"font-size: 12px; font-weight: bold;\">" + tmp182 + "</td>\n    <td>" + p85.total.toFixed(5) + "</td>\n    <td><button class=\"delete-item-btn\" data-index=\"" + p86 + "\" style=\"background: #dc3545; color: white; border: none; border-radius: 50%; cursor: pointer; width: 28px; height: 28px;\">&times;</button></td>\n";
        tmp181.addEventListener("click", p88 => {
          if (p88.target.classList.contains("delete-item-btn")) {
            return;
          }
          tmp174.querySelectorAll("tr").forEach(p89 => p89.classList.remove("editing-item"));
          tmp181.classList.add("editing-item");
          tmp109 = p86;
          fn33(vA6[p86]);
          tmp175.textContent = "Ø­ÙØ¸ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª";
          tmp176.style.display = "inline-block";
          tmp173.scrollIntoView({
            behavior: "smooth"
          });
        });
      });
      p58.querySelectorAll(".delete-item-btn").forEach(p90 => {
        p90.onclick = p91 => {
          p91.stopPropagation();
          vA6.splice(p90.dataset.index, 1);
          if (tmp109 == p90.dataset.index) {
            fn32();
          }
          fn34();
          fn29();
        };
      });
      fn35();
      if (vA6.length === 0) {
        tmp149.style.display = "none";
        tmp148.style.display = "block";
      } else {
        tmp149.style.display = "block";
        tmp148.style.display = "none";
      }
    }
    tmp173.addEventListener("submit", p92 => {
      p92.preventDefault();
      const vO5 = {
        itemType: p58.querySelector("#item-code-type").value,
        itemCode: p58.querySelector("#item-code").value,
        description: p58.querySelector("#item-description").value,
        unitType: "EA",
        quantity: parseFloat(tmp150.value) || 0,
        unitPrice: parseFloat(tmp151.value) || 0,
        currencySold: tmp152.value,
        exchangeRate: parseFloat(tmp153.value) || 1,
        total: parseFloat(tmp154.value) || 0,
        taxableItems: []
      };
      const tmp183 = tmp158.querySelectorAll(".tax-row");
      tmp183.forEach((p93, p94) => {
        const tmp184 = p93.querySelector(".tax-rate");
        const tmp185 = p93.querySelector(".tax-type");
        const tmp186 = p93.querySelector(".tax-subtype");
        if (tmp184 && tmp184.value.trim() !== "") {
          const vParseFloat = parseFloat(tmp184.value);
          if (!isNaN(vParseFloat)) {
            const vO6 = {
              taxType: tmp185.value,
              subType: tmp186.value,
              rate: vParseFloat
            };
            vO5.taxableItems.push(vO6);
          } else {}
        } else {}
      });
      if (tmp109 > -1) {
        vA6[tmp109] = vO5;
      } else {
        vA6.push(vO5);
      }
      fn32();
      fn34();
      fn29();
    });
    if (tmp101) {
      const tmp187 = p58.querySelector("#fetch-invoice-details-btn");
      const tmp188 = p58.querySelector("#original-invoice-items-container");
      const tmp189 = p58.querySelector("#original-items-list");
      const tmp190 = p58.querySelector("#add-selected-to-return-btn");
      tmp187.addEventListener("click", async () => {
        const tmp191 = p58.querySelector("#manual-reference-uuid").value.trim();
        if (!tmp191) {
          alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ UUID Ø£ÙˆÙ„Ø§Ù‹.");
          return;
        }
        const tmp192 = tmp187.textContent;
        tmp187.textContent = "â³";
        tmp187.disabled = true;
        try {
          const tmpHex57971a2 = getAccessTokenFromUserData();
          if (!tmpHex57971a2) {
            throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªÙˆÙƒÙ† Ø§Ù„Ø¯Ø®ÙˆÙ„.");
          }
          const tmp193 = "https://api-portal.invoicing.eta.gov.eg/api/v1/receipts/" + tmp191 + "/details";
          const tmp194 = await fetch(tmp193, {
            headers: {
              Authorization: "Bearer " + tmpHex57971a2
            }
          });
          if (!tmp194.ok) {
            const tmp195 = await tmp194.text();
            throw new Error(tmp195 || "ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Ø±Ù…Ø² Ø§Ù„Ø­Ø§Ù„Ø©: " + tmp194.status + ")");
          }
          const tmp196 = await tmp194.json();
          tmp110 = tmp196.receipt;
          p58.querySelector("#manual-buyer-name").value = tmp110.buyer?.buyerName || "";
          p58.querySelector("#manual-buyer-id").value = tmp110.buyer?.buyerId || "";
          fn74("âœ… ØªÙ… Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­.", 3000);
          if (tmp110.itemData && tmp110.itemData.length > 0) {
            tmp189.innerHTML = tmp110.itemData.map((p95, p96) => "\n                        <div style=\"padding: 8px; border-bottom: 1px solid #eee; display: flex; align-items: center; gap: 10px;\">\n                            <input type=\"checkbox\" class=\"original-item-checkbox\" data-index=\"" + p96 + "\" style=\"width: 18px; height: 18px;\">\n                            <label style=\"flex-grow: 1;\">\n                                " + p95.description + " (Ø§Ù„ÙƒÙ…ÙŠØ©: " + p95.quantity + ", Ø§Ù„Ø³Ø¹Ø±: " + p95.unitPrice.toFixed(2) + ")\n                            </label>\n                        </div>\n                    ").join("");
            tmp188.style.display = "block";
          } else {
            tmp189.innerHTML = "<p style=\"color: #888;\">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£ØµÙ†Ø§Ù ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„ÙØ§ØªÙˆØ±Ø©.</p>";
          }
        } catch (e10) {
          alert("âŒ Ø®Ø·Ø£: " + e10.message);
          tmp188.style.display = "none";
        } finally {
          tmp187.textContent = tmp192;
          tmp187.disabled = false;
        }
      });
      tmp190.addEventListener("click", () => {
        const tmp197 = p58.querySelectorAll(".original-item-checkbox:checked");
        if (tmp197.length === 0) {
          alert("ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ ØµÙ†Ù ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù„Ø¥Ø¶Ø§ÙØªÙ‡ Ù„Ù„Ù…Ø±ØªØ¬Ø¹.");
          return;
        }
        const tmp198 = tmp110.currency || "EGP";
        const tmp199 = tmp110.exchangeRate || 1;
        tmp197.forEach(p97 => {
          const vParseInt = parseInt(p97.dataset.index, 10);
          const tmp200 = tmp110.itemData[vParseInt];
          if (tmp200) {
            let tmp201;
            if (tmp198 !== "EGP" && tmp200.unitValue && typeof tmp200.unitValue.amountSold !== "undefined") {
              tmp201 = tmp200.unitValue.amountSold;
            } else {
              tmp201 = tmp200.unitPrice;
            }
            const vO7 = {
              itemType: tmp200.itemType,
              itemCode: tmp200.itemCode,
              description: tmp200.description,
              unitType: tmp200.unitType,
              quantity: tmp200.quantity,
              unitPrice: tmp201,
              currencySold: tmp198,
              exchangeRate: tmp199,
              total: tmp200.total,
              taxableItems: tmp200.taxableItems.map(p98 => ({
                taxType: p98.taxType,
                subType: p98.subType,
                rate: p98.rate,
                amount: p98.amount
              }))
            };
            vA6.push(vO7);
          }
        });
        fn34();
        fn29();
        tmp188.style.display = "none";
        fn74("âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© " + tmp197.length + " ØµÙ†Ù Ù„Ù„Ù…Ø±ØªØ¬Ø¹.", 3000);
      });
    }
    function fn35() {
      const vO8 = {
        T1: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©",
        T2: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„ (Ù†Ø³Ø¨ÙŠØ©)",
        T3: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„ (Ø§Ù„Ù†ÙˆØ¹ÙŠØ©)",
        T4: "Ø®ØµÙ… Ù…Ù† Ø§Ù„Ù…Ù†Ø¨Ø¹",
        T5: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¯Ù…ØºØ© (Ù†Ø³Ø¨ÙŠØ©)",
        T6: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¯Ù…ØºØ© (Ù‚Ø·Ø¹ÙŠØ©)",
        T7: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù…Ù„Ø§Ù‡ÙŠ",
        T8: "Ø±Ø³Ù… ØªÙ†Ù…ÙŠØ© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯",
        T9: "Ø±Ø³Ù… Ø®Ø¯Ù…Ø©",
        T10: "Ø±Ø³Ù… Ø§Ù„Ù…Ø­Ù„ÙŠØ§Øª",
        T11: "Ø±Ø³Ù… Ø§Ù„ØªØ£Ù…ÙŠÙ† Ø§Ù„ØµØ­ÙŠ",
        T12: "Ø±Ø³ÙˆÙ… Ø£Ø®Ø±Ù‰"
      };
      const tmp202 = p58.querySelector("#summary-tax-details");
      const tmp203 = p58.querySelector("#summary-discount-row");
      let vLN04 = 0;
      let vLN05 = 0;
      const tmp204 = new Map();
      vA6.forEach(p99 => {
        const tmp205 = p99.quantity || 0;
        const tmp206 = p99.unitPrice || 0;
        const tmp207 = p99.exchangeRate || 1;
        const tmp208 = tmp205 * tmp206 * tmp207;
        vLN04 += tmp208;
        const tmp209 = p99.discount?.amount || 0;
        vLN05 += tmp209;
        const tmp210 = tmp208 - tmp209;
        let vLN06 = 0;
        p99.taxableItems.forEach(p100 => {
          if (p100.taxType === "T2" || p100.taxType === "T3") {
            vLN06 += tmp210 * ((p100.rate || 0) / 100);
          }
        });
        const tmp211 = tmp210 + vLN06;
        p99.taxableItems.forEach(p101 => {
          const tmp212 = p101.taxType === "T1" ? tmp211 : tmp210;
          const tmp213 = tmp212 * ((p101.rate || 0) / 100);
          tmp204.set(p101.taxType, (tmp204.get(p101.taxType) || 0) + tmp213);
        });
      });
      if (vLN05 > 0) {
        tmp203.style.display = "flex";
        p58.querySelector("#summary-discount-total").textContent = "-" + vLN05.toFixed(2) + " Ø¬.Ù…";
      } else {
        tmp203.style.display = "none";
      }
      let tmp214 = vLN04 - vLN05;
      let tmpLocal3 = "";
      if (tmp204.size > 0) {
        tmp204.forEach((p102, p103) => {
          const tmp215 = vO8[p103] || p103;
          const tmp216 = p103 === "T4";
          tmp214 += tmp216 ? -p102 : p102;
          tmpLocal3 += "\n                <div class=\"tax-detail-row " + (tmp216 ? "withholding-tax" : "") + "\">\n                    <span class=\"tax-name\">" + tmp215 + "</span>\n                    <span class=\"tax-amount\">" + (tmp216 ? "-" : "") + p102.toFixed(5) + " Ø¬.Ù…</span>\n                </div>\n            ";
        });
        tmp202.innerHTML = tmpLocal3;
      } else {
        tmp202.innerHTML = "<div class=\"tax-placeholder\">Ù„Ù… ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø£ÙŠ Ø¶Ø±Ø§Ø¦Ø¨.</div>";
      }
      p58.querySelector("#summary-sales-total").textContent = vLN04.toFixed(2) + " Ø¬.Ù…";
      p58.querySelector("#summary-grand-total").textContent = tmp214.toFixed(2) + " Ø¬.Ù…";
    }
    function fn36(p104) {
      const vO9 = {};
      p104.querySelectorAll("[data-field], [data-issuer-field], [data-receiver-field], [data-invoice-field]").forEach(p105 => {
        const tmp217 = p105.dataset.field || p105.dataset.issuerField || p105.dataset.receiverField || p105.dataset.invoiceField;
        if (tmp217) {
          vO9[tmp217] = p105.textContent.trim();
        }
      });
      let vLN07 = 0;
      let vLN08 = 0;
      const tmp218 = new Map();
      const vA7 = [];
      const vA8 = [];
      p104.querySelectorAll(".items-table tbody tr").forEach(p106 => {
        const vO10 = {};
        p106.querySelectorAll("[data-field]").forEach(p107 => {
          if (p107.querySelectorAll("span[data-field]").length > 0) {
            p107.querySelectorAll("span[data-field]").forEach(p108 => {
              vO10[p108.dataset.field] = p108.textContent.trim();
            });
          } else {
            vO10[p107.dataset.field] = p107.textContent.trim();
          }
        });
        vA8.push(vO10);
        const tmp219 = parseFloat(vO10.quantity) || 0;
        const tmp220 = parseFloat(vO10.unit_price) || 0;
        const vParseFloat2 = parseFloat((tmp219 * tmp220).toFixed(5));
        vLN07 += vParseFloat2;
        const tmp221 = parseFloat(vO10.discount_amount) || vParseFloat2 * (parseFloat(vO10.discount_rate) || 0) / 100;
        vLN08 += tmp221;
        const vParseFloat3 = parseFloat((vParseFloat2 - tmp221).toFixed(5));
        const vA9 = [];
        let vLN09 = 0;
        for (let vLN1 = 1; vLN1 <= 3; vLN1++) {
          const tmp222 = vO10["tax_type_" + vLN1]?.trim().toUpperCase();
          const tmp223 = vO10["tax_rate_" + vLN1];
          if (tmp222 && tmp223 != null && tmp223.trim() !== "" && !isNaN(parseFloat(tmp223))) {
            const vParseFloat4 = parseFloat(tmp223);
            const vParseFloat5 = parseFloat((vParseFloat3 * (vParseFloat4 / 100)).toFixed(5));
            const tmp224 = vO10["tax_subtype_" + vLN1]?.trim() || vO64[tmp222] || "";
            vA9.push({
              taxType: tmp222,
              amount: vParseFloat5,
              subType: tmp224,
              rate: vParseFloat4
            });
            vLN09 += tmp222 === "T4" ? -vParseFloat5 : vParseFloat5;
            tmp218.set(tmp222, (tmp218.get(tmp222) || 0) + vParseFloat5);
          }
        }
        vA7.push({
          description: vO10.item_description,
          itemType: vO10.item_type,
          itemCode: vO10.item_code,
          internalCode: vO10.item_internal_code || vO10.item_code,
          unitType: vO10.unit_type,
          quantity: tmp219,
          unitValue: {
            currencySold: "EGP",
            amountEGP: tmp220
          },
          salesTotal: vParseFloat2,
          discount: {
            amount: tmp221
          },
          netTotal: vParseFloat3,
          taxableItems: vA9,
          total: parseFloat((vParseFloat3 + vLN09).toFixed(5)),
          valueDifference: 0,
          totalTaxableFees: 0,
          itemsDiscount: 0
        });
      });
      const tmp225 = Array.from(tmp218, ([tmp226, tmp227]) => ({
        taxType: tmp226,
        amount: parseFloat(tmp227.toFixed(5))
      }));
      const tmp228 = vA7.reduce((p109, p110) => p109 + p110.total, 0);
      const vO11 = {
        tags: ["FullInvoice", "SignatureRequired"],
        document: {
          documentType: "I",
          documentTypeVersion: "1.0",
          dateTimeIssued: firstLine.dateTimeIssued && !isNaN(new Date(firstLine.dateTimeIssued)) ? new Date(firstLine.dateTimeIssued).toISOString().split(".")[0] + "Z" : new Date().toISOString().split(".")[0] + "Z",
          serviceDeliveryDate: firstLine.serviceDeliveryDate && !isNaN(new Date(firstLine.serviceDeliveryDate)) ? new Date(firstLine.serviceDeliveryDate).toISOString().split("T")[0] : undefined,
          taxpayerActivityCode: document.getElementById("activity-select-editor")?.value || "4690",
          internalID: vO9.internalID,
          issuer: {
            type: "B",
            id: vO9.id,
            name: vO9.name,
            address: {
              branchID: "0",
              country: "EG",
              governate: vO9.governate,
              regionCity: vO9.regionCity,
              street: vO9.street,
              buildingNumber: vO9.buildingNumber
            }
          },
          receiver: {
            type: vO9.receiver_type,
            id: vO9.receiver_id,
            name: vO9.receiver_name,
            address: {
              country: vO9.receiver_country,
              governate: vO9.receiver_governate,
              regionCity: vO9.receiver_city,
              street: vO9.receiver_street,
              buildingNumber: vO9.receiver_building
            }
          },
          invoiceLines: vA7,
          totalSalesAmount: parseFloat(vLN07.toFixed(5)),
          totalDiscountAmount: parseFloat(vLN08.toFixed(5)),
          netAmount: parseFloat((vLN07 - vLN08).toFixed(5)),
          taxTotals: tmp225,
          totalAmount: parseFloat(tmp228.toFixed(5)),
          signatures: [{
            signatureType: "I",
            value: "VGVtcG9yYXJ5IFNpZ25hdHVyZSBIb2xkZXI="
          }]
        },
        lineItemCodes: vA8.map(p111 => ({
          codeType: p111.item_type,
          itemCode: p111.item_code,
          codeNamePrimaryLang: p111.item_code_name || p111.item_description,
          codeNameSecondaryLang: p111.item_code_name || p111.item_description
        }))
      };
      return vO11;
    }
    function fn37() {
      if (vA6.length === 0) {
        alert("Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­ÙØ¸ Ù…Ø³ÙˆØ¯Ø© ÙØ§Ø±ØºØ©. ÙŠØ±Ø¬Ù‰ Ø¥Ø¶Ø§ÙØ© ØµÙ†Ù ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.");
        return null;
      }
      const tmp229 = p58.querySelector("#manual-datetime-issued").value;
      const vO12 = {
        receiptNumber: p58.querySelector("#manual-receipt-number").value,
        dateTimeIssued: tmp229,
        buyerName: p58.querySelector("#manual-buyer-name").value,
        buyerId: p58.querySelector("#manual-buyer-id").value,
        documentType: p60,
        referenceUUID: tmp101 ? p58.querySelector("#manual-reference-uuid")?.value || "" : undefined,
        items: vA6
      };
      return vO12;
    }
    p58.querySelector("#save-draft-btn").onclick = () => {
      const vF37 = fn37();
      if (vF37) {
        const tmp230 = JSON.parse(localStorage.getItem("receiptDrafts") || "[]");
        tmp230.unshift(vF37);
        localStorage.setItem("receiptDrafts", JSON.stringify(tmp230));
        fn74("âœ… ØªÙ… Ø­ÙØ¸ \"" + vF37.receiptNumber + "\" ÙƒÙ…Ø³ÙˆØ¯Ø© Ø¨Ù†Ø¬Ø§Ø­.", 4000);
        const tmp231 = p58.querySelector("#manualSendModal");
        tmp231.style.display = "none";
        p58.innerHTML = "";
        fn40();
      }
    };
    p58.querySelector("#read-json-btn").onclick = async () => {
      fn29();
      if (p58.querySelector(".tab-status-indicator.invalid")) {
        alert("ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„ØªÙŠ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¹Ù„Ø§Ù…Ø© (âœ–) ÙˆØªØµØ­ÙŠØ­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù‚Ø¨Ù„ Ù‚Ø±Ø§Ø¡Ø© JSON.");
        return;
      }
      const tmp232 = p58.querySelector("#pos-device-select").value;
      const tmp233 = p58.querySelector("#manual-activity-code").value;
      const vF372 = fn37();
      if (!vF372) {
        return;
      }
      const tmp234 = vF372.items.map(p112 => ({
        receiptNumber: vF372.receiptNumber,
        buyerName: vF372.buyerName,
        buyerId: vF372.buyerId,
        paymentMethod: p58.querySelector("#payment-method").value,
        referenceUUID: vF372.referenceUUID,
        ...p112
      }));
      tmp234.forEach(p113 => {
        const tmp235 = parseFloat(p113.quantity) || 0;
        const tmp236 = parseFloat(p113.unitPrice) || 0;
        const tmp237 = tmp235 * tmp236;
        let vLN010 = 0;
        p113.taxableItems.forEach(p114 => {
          if (p114.taxType === "T2" || p114.taxType === "T3") {
            vLN010 += tmp237 * (parseFloat(p114.rate) / 100);
          }
        });
        const tmp238 = tmp237 + vLN010;
        p113.taxableItems.forEach(p115 => {
          const tmp239 = p115.taxType === "T1" ? tmp238 : tmp237;
          p115.amount = parseFloat((tmp239 * (parseFloat(p115.rate) / 100)).toFixed(5));
        });
      });
      let tmp240 = tmp101 ? fn127(tmp234, tmp106, tmp232, tmp233) : fn49(tmp234, tmp106, tmp232, tmp233);
      const tmp241 = p58.querySelector("#manual-datetime-issued").value;
      tmp240.header.dateTimeIssued = fn4(tmp241);
      const vO13 = {
        receipts: [tmp240]
      };
      try {
        const tmp242 = JSON.stringify(vO13, null, 4);
        const tmp243 = window.open("", "_blank");
        tmp243.document.write("<pre style=\"direction: ltr; text-align: left; white-space: pre-wrap; word-wrap: break-word;\">" + tmp242 + "</pre>");
        tmp243.document.close();
      } catch (e11) {
        alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ JSON: " + e11.message);
      }
    };
    p58.querySelector("#send-manual-receipt-btn").onclick = async () => {
      fn29();
      if (p58.querySelector(".tab-status-indicator.invalid")) {
        alert("ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª Ø§Ù„ØªÙŠ ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¹Ù„Ø§Ù…Ø© (âœ–) ÙˆØªØµØ­ÙŠØ­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.");
        return;
      }
      const tmp244 = p58.querySelector("#summary-grand-total")?.textContent || "0";
      const vParseFloat6 = parseFloat(tmp244.replace(/[^0-9.]/g, ""));
      const tmp245 = p58.querySelector("#manual-buyer-id").value.trim();
      if (vParseFloat6 > 150000) {
        if (!tmp245) {
          alert("âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ù„Ø£Ù† Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø© ÙŠØªØ¬Ø§ÙˆØ² 150,000 Ø¬Ù†ÙŠÙ‡.");
          return;
        }
        const tmp246 = await fn26(tmp245);
        if (!tmp246.valid) {
          alert("âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ø§Ù„Ù…Ø¯Ø®Ù„ ØºÙŠØ± ØµØ­ÙŠØ­. (" + tmp246.message + ")");
          return;
        }
      } else if (tmp245) {
        const tmp247 = await fn26(tmp245);
        if (!tmp247.valid) {
          alert("âŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ø§Ù„Ù…Ø¯Ø®Ù„ ØºÙŠØ± ØµØ­ÙŠØ­. (" + tmp247.message + ")");
          return;
        }
      }
      const tmp248 = p58.querySelector("#pos-device-select").value;
      const tmp249 = p58.querySelector("#manual-activity-code").value;
      const vF373 = fn37();
      if (!vF373) {
        return;
      }
      const tmp250 = vF373.items.map(p116 => ({
        receiptNumber: vF373.receiptNumber,
        buyerName: vF373.buyerName,
        buyerId: vF373.buyerId,
        paymentMethod: p58.querySelector("#payment-method").value,
        referenceUUID: vF373.referenceUUID,
        ...p116
      }));
      tmp250.forEach(p117 => {
        const tmp251 = parseFloat(p117.quantity) || 0;
        const tmp252 = parseFloat(p117.unitPrice) || 0;
        const tmp253 = parseFloat(p117.exchangeRate) || 1;
        const tmp254 = tmp251 * tmp252;
        let vLN011 = 0;
        p117.taxableItems.forEach(p118 => {
          if (p118.taxType === "T2" || p118.taxType === "T3") {
            vLN011 += tmp254 * (parseFloat(p118.rate) / 100);
          }
        });
        const tmp255 = tmp254 + vLN011;
        p117.taxableItems.forEach(p119 => {
          const tmp256 = p119.taxType === "T1" ? tmp255 : tmp254;
          p119.amount = parseFloat((tmp256 * (parseFloat(p119.rate) / 100)).toFixed(5));
        });
      });
      let tmp257 = tmp101 ? fn127(tmp250, tmp106, tmp248, tmp249) : fn49(tmp250, tmp106, tmp248, tmp249);
      const tmp258 = p58.querySelector("#manual-datetime-issued").value;
      tmp257.header.dateTimeIssued = fn4(tmp258);
      const tmp259 = JSON.stringify({
        receipts: [tmp257]
      });
      tmp257.header.uuid = await vF.computeUuidFromRawText(tmp259);
      if (!tmp257.header.uuid) {
        alert("ÙØ´Ù„ ØªÙˆÙ„ÙŠØ¯ UUID. Ù„Ù† ÙŠØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„.");
        return;
      }
      const vO14 = {
        receipts: [tmp257]
      };
      const tmp260 = await fn128(vO14, "Ø¥Ø±Ø³Ø§Ù„ ÙŠØ¯ÙˆÙŠ: " + tmp257.header.receiptNumber);
      if (tmp260.success) {
        alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ " + (tmp101 ? "Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø±ØªØ¬Ø¹" : "Ø§Ù„Ø¥ÙŠØµØ§Ù„") + " Ø¨Ù†Ø¬Ø§Ø­.");
        const tmp261 = p58.querySelector("#manualSendModal");
        tmp261.style.display = "none";
        p58.innerHTML = "";
      } else {
        alert("ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯. Ø§Ù„Ø®Ø·Ø£ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…: " + tmp260.error);
      }
    };
    p58.querySelector("#manual-datetime-issued").valueAsDate = new Date();
    fn32();
    fn29();
  }
  async function fn38(p120) {
    const tmp262 = document.createElement("div");
    tmp262.className = "code-search-modal";
    tmp262.innerHTML = "\n        <div class=\"code-search-content\">\n            <div class=\"code-search-header\">\n                <h4>Ø§Ø®ØªØ± ÙƒÙˆØ¯ EGS</h4>\n                <input type=\"text\" id=\"egs-search-input\" placeholder=\"Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„ÙƒÙˆØ¯...\">\n                <button id=\"close-code-search-btn\" title=\"Ø¥ØºÙ„Ø§Ù‚\" style=\"background:none; border:none; font-size:24px; cursor:pointer;\">&times;</button>\n            </div>\n            <div class=\"code-search-body\">\n                <div class=\"code-search-placeholder\">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯...</div>\n                <table class=\"code-search-table\" style=\"display:none;\">\n                    <thead><tr><th>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠ</th><th>Ø§Ù„ÙƒÙˆØ¯</th></tr></thead>\n                    <tbody></tbody>\n                </table>\n            </div>\n        </div>\n    ";
    document.body.appendChild(tmp262);
    const tmp263 = tmp262.querySelector("#egs-search-input");
    const tmp264 = tmp262.querySelector(".code-search-table tbody");
    const tmp265 = tmp262.querySelector(".code-search-table");
    const tmp266 = tmp262.querySelector(".code-search-placeholder");
    const vF11 = () => tmp262.remove();
    tmp262.querySelector("#close-code-search-btn").onclick = vF11;
    tmp262.addEventListener("click", p121 => {
      if (p121.target === tmp262) {
        vF11();
      }
    });
    let vA10 = [];
    try {
      const tmpHex57971a3 = getAccessTokenFromUserData();
      if (!tmpHex57971a3) {
        throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªÙˆÙƒÙ† Ø§Ù„Ø¯Ø®ÙˆÙ„.");
      }
      const tmp267 = await fetch("https://api-portal.invoicing.eta.gov.eg/api/v1/codetypes/codes/my?CodeTypeID=9&Ps=1000", {
        headers: {
          Authorization: "Bearer " + tmpHex57971a3
        }
      });
      if (!tmp267.ok) {
        throw new Error("ÙØ´Ù„ Ø¬Ù„Ø¨ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£ÙƒÙˆØ§Ø¯.");
      }
      const tmp268 = await tmp267.json();
      vA10 = tmp268.result || [];
      if (vA10.length === 0) {
        tmp266.textContent = "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£ÙƒÙˆØ§Ø¯ EGS Ù…Ø³Ø¬Ù„Ø© ÙÙŠ Ø­Ø³Ø§Ø¨Ùƒ.";
      } else {
        tmp266.style.display = "none";
        tmp265.style.display = "table";
        fn39(vA10);
      }
    } catch (e12) {
      tmp266.textContent = "Ø®Ø·Ø£: " + e12.message;
    }
    function fn39(p122) {
      tmp264.innerHTML = p122.map(p123 => "\n            <tr data-code='" + JSON.stringify(p123) + "'>\n                <td>" + p123.codeNameSecondaryLang + "</td>\n                <td class=\"code-value\">" + p123.codeLookupValue + "</td>\n            </tr>\n        ").join("");
      tmp264.querySelectorAll("tr").forEach(p124 => {
        p124.onclick = () => {
          const tmp269 = JSON.parse(p124.dataset.code);
          p120(tmp269);
          vF11();
        };
      });
    }
    tmp263.addEventListener("input", () => {
      const tmp270 = tmp263.value.toLowerCase().trim();
      const tmp271 = vA10.filter(p125 => p125.codeNameSecondaryLang.toLowerCase().includes(tmp270) || p125.codeLookupValue.toLowerCase().includes(tmp270));
      fn39(tmp271);
    });
  }
  function fn40() {
    const tmp272 = document.getElementById("drafts-container");
    if (!tmp272) {
      return;
    }
    const tmp273 = JSON.parse(localStorage.getItem("receiptDrafts") || "[]");
    const tmpLocalDraftscardstyles = "drafts-card-styles";
    if (!document.getElementById(tmpLocalDraftscardstyles)) {
      const tmp274 = document.createElement("style");
      tmp274.id = tmpLocalDraftscardstyles;
      tmp274.innerHTML = "\n            .drafts-list { display: flex; flex-direction: column; gap: 15px; }\n            .draft-card {\n                background: #fff;\n                border-radius: 10px;\n                border: 1px solid #e9ecef;\n                box-shadow: 0 3px 10px rgba(0,0,0,0.05);\n                display: grid;\n                grid-template-columns: auto 1fr auto;\n                align-items: center;\n                gap: 20px;\n                padding: 15px 20px;\n                transition: all 0.2s ease-in-out;\n            }\n            .draft-card:hover {\n                transform: translateY(-3px);\n                box-shadow: 0 5px 15px rgba(0,0,0,0.08);\n                border-color: #007bff;\n            }\n            .draft-card .select-col { display: flex; align-items: center; }\n            .draft-card .draft-checkbox { width: 20px; height: 20px; }\n            .draft-card .info-col { display: flex; flex-direction: column; gap: 5px; }\n            .draft-card .receipt-number { font-weight: 700; font-size: 17px; color: #1d3557; }\n            .draft-card .details-row { display: flex; gap: 15px; font-size: 14px; color: #6c757d; }\n            .draft-card .actions-col { display: flex; gap: 10px; }\n            .draft-card .action-btn {\n                padding: 8px 15px;\n                font-size: 14px;\n                font-weight: 600;\n                border: none;\n                border-radius: 6px;\n                cursor: pointer;\n                transition: all 0.2s;\n            }\n            .draft-card .edit-btn { background-color: #e7f3ff; color: #0056b3; }\n            .draft-card .edit-btn:hover { background-color: #007bff; color: white; }\n            .draft-card .delete-btn { background-color: #f8d7da; color: #721c24; }\n            .draft-card .delete-btn:hover { background-color: #dc3545; color: white; }\n        ";
      document.head.appendChild(tmp274);
    }
    if (tmp273.length === 0) {
      tmp272.innerHTML = "<p style=\"text-align: center; color: #888; padding: 20px;\">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø³ÙˆØ¯Ø§Øª Ù…Ø­ÙÙˆØ¸Ø© Ø­Ø§Ù„ÙŠÙ‹Ø§.</p>";
      return;
    }
    tmp272.innerHTML = "\n        <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding: 10px; background-color: #f8f9fa; border-radius: 8px;\">\n            <label style=\"font-weight: bold; display: flex; align-items: center; gap: 8px;\">\n                <input type=\"checkbox\" id=\"selectAllDraftsCheckbox\" style=\"width: 18px; height: 18px;\">\n                ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙƒÙ„\n            </label>\n            <button id=\"sendSelectedDraftsBtn\" class=\"action-button\" style=\"background-color: #28a745; color: white; padding: 10px 20px; font-size: 15px; width: auto;\">\n                ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø­Ø¯Ø¯ (0)\n            </button>\n        </div>\n        <div class=\"drafts-list\">\n            " + tmp273.map((p126, p127) => "\n                <div class=\"draft-card\">\n                    <div class=\"select-col\">\n                        <input type=\"checkbox\" class=\"draft-checkbox\" data-index=\"" + p127 + "\">\n                    </div>\n                    <div class=\"info-col\">\n                        <span class=\"receipt-number\">" + p126.receiptNumber + "</span>\n                        <div class=\"details-row\">\n                            <span>" + (p126.documentType === "return" ? "â†©ï¸ Ø¥Ø´Ø¹Ø§Ø± Ù…Ø±ØªØ¬Ø¹" : "ğŸ§¾ Ø¥ÙŠØµØ§Ù„ Ø¨ÙŠØ¹") + "</span>\n                            <span>|</span>\n                            <span>Ø¹Ø¯Ø¯ Ø§Ù„Ø¨Ù†ÙˆØ¯: " + p126.items.length + "</span>\n                        </div>\n                    </div>\n                    <div class=\"actions-col\">\n                        <button class=\"action-btn edit-btn edit-draft-btn\" data-index=\"" + p127 + "\">ØªØ¹Ø¯ÙŠÙ„</button>\n                        <button class=\"action-btn delete-btn delete-draft-btn\" data-index=\"" + p127 + "\">Ø­Ø°Ù</button>\n                    </div>\n                </div>\n            ").join("") + "\n        </div>\n    ";
    const tmp275 = document.getElementById("sendSelectedDraftsBtn");
    const tmp276 = document.getElementById("selectAllDraftsCheckbox");
    const tmp277 = tmp272.querySelectorAll(".draft-checkbox");
    function fn41() {
      const tmp278 = tmp272.querySelectorAll(".draft-checkbox:checked").length;
      tmp275.textContent = "ğŸ“¤ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø­Ø¯Ø¯ (" + tmp278 + ")";
      tmp275.disabled = tmp278 === 0;
    }
    tmp276.addEventListener("change", p128 => {
      tmp277.forEach(p129 => p129.checked = p128.target.checked);
      fn41();
    });
    tmp277.forEach(p130 => {
      p130.addEventListener("change", fn41);
    });
    tmp275.addEventListener("click", fn42);
    tmp272.querySelectorAll(".edit-draft-btn").forEach(p131 => {
      p131.addEventListener("click", p132 => {
        p132.stopPropagation();
        fn43(p131.dataset.index);
      });
    });
    tmp272.querySelectorAll(".delete-draft-btn").forEach(p133 => {
      p133.addEventListener("click", p134 => {
        p134.stopPropagation();
        fn98(p133.dataset.index);
      });
    });
    fn41();
  }
  async function fn42() {
    const tmp279 = document.querySelectorAll("#drafts-container .draft-checkbox:checked");
    if (tmp279.length === 0) {
      alert("ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ Ù…Ø³ÙˆØ¯Ø© ÙˆØ§Ø­Ø¯Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù„Ø¥Ø±Ø³Ø§Ù„Ù‡Ø§.");
      return;
    }
    if (!confirm("Ø³ÙŠØªÙ… Ø§Ù„Ø¢Ù† Ø¥Ø±Ø³Ø§Ù„ " + tmp279.length + " Ù…Ø³ØªÙ†Ø¯. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©ØŸ")) {
      return;
    }
    const tmpHex39bd1e3 = fn74("Ø¬Ø§Ø±ÙŠ ØªØ¬Ù‡ÙŠØ² " + tmp279.length + " Ù…Ø³ØªÙ†Ø¯ Ù„Ù„Ø¥Ø±Ø³Ø§Ù„...", 0);
    const tmp280 = JSON.parse(localStorage.getItem("receiptDrafts") || "[]");
    const vA11 = [];
    const vA12 = [];
    try {
      if (!window.receiptUploaderData) {
        throw new Error("Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø§ÙØ¹ (Ø§Ù„Ø¨Ø§Ø¦Ø¹ ÙˆÙ†Ù‚Ø·Ø© Ø§Ù„Ø¨ÙŠØ¹) ØºÙŠØ± Ù…Ù‡ÙŠØ£Ø©. ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© ÙØªØ­ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©.");
      }
      const {
        seller: _0x80c466,
        serial: _0x174060
      } = window.receiptUploaderData;
      let tmp281 = (JSON.parse(localStorage.getItem("receiptHistory") || "[]")[0] || {}).uuid || "";
      for (const tmp282 of tmp279) {
        const vParseInt2 = parseInt(tmp282.dataset.index, 10);
        const tmp283 = tmp280[vParseInt2];
        if (!tmp283) {
          continue;
        }
        const tmp284 = tmp283.items.map(p135 => ({
          ...p135,
          ...tmp283
        }));
        const tmp285 = tmp283.documentType === "return" ? fn127(tmp284, _0x80c466, _0x174060) : fn49(tmp284, _0x80c466, _0x174060);
        tmp285.header.previousUUID = tmp281;
        const tmp286 = JSON.stringify({
          receipts: [tmp285]
        });
        const tmp287 = await vF.computeUuidFromRawText(tmp286);
        if (!tmp287) {
          throw new Error("ÙØ´Ù„ ØªÙˆÙ„ÙŠØ¯ UUID Ù„Ø£Ø­Ø¯ Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª.");
        }
        tmp285.header.uuid = tmp287;
        vA12.push(tmp285);
        tmp281 = tmp287;
        vA11.push(vParseInt2);
      }
      if (vA12.length === 0) {
        throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø³ÙˆØ¯Ø§Øª ØµØ§Ù„Ø­Ø© Ù„Ù„Ø¥Ø±Ø³Ø§Ù„.");
      }
      tmpHex39bd1e3.update("Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ " + vA12.length + " Ù…Ø³ØªÙ†Ø¯...");
      const vO15 = {
        receipts: vA12
      };
      const tmp288 = await fn128(vO15, "Ø¯ÙØ¹Ø© Ù…Ù† " + vA12.length + " Ù…Ø³ÙˆØ¯Ø©");
      if (tmp288.success) {
        vA11.sort((p136, p137) => p137 - p136).forEach(p138 => tmp280.splice(p138, 1));
        localStorage.setItem("receiptDrafts", JSON.stringify(tmp280));
        tmpHex39bd1e3.remove();
        fn74("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ " + vA12.length + " Ù…Ø³ØªÙ†Ø¯ Ø¨Ù†Ø¬Ø§Ø­!", 5000);
        fn40();
      } else {
        throw new Error(tmp288.error || "ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¯ÙØ¹Ø©.");
      }
    } catch (e13) {
      tmpHex39bd1e3.remove();
      alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: " + e13.message);
    }
  }
  async function fn43(p139) {
    const tmp289 = JSON.parse(localStorage.getItem("receiptDrafts") || "[]");
    const tmp290 = tmp289[p139];
    if (!tmp290) {
      alert("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³ÙˆØ¯Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©.");
      return;
    }
    document.querySelector(".sidebar-btn[data-target=\"panel-manual\"]").click();
    const tmp291 = document.getElementById("manualDocumentTypeSelect");
    tmp291.value = tmp290.documentType;
    tmp291.dispatchEvent(new Event("change"));
    const tmp292 = document.getElementById("dynamicManualSendContent");
    let vLN012 = 0;
    const vLN50 = 50;
    while (!tmp292.querySelector("#manual-receipt-number") && vLN012 < vLN50) {
      await new Promise(p140 => setTimeout(p140, 100));
      vLN012++;
    }
    if (!tmp292.querySelector("#manual-receipt-number")) {
      fn74("âŒ Ø®Ø·Ø£: ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.", 4000);
      return;
    }
    tmp292.querySelector("#manual-receipt-number").value = tmp290.receiptNumber;
    tmp292.querySelector("#manual-buyer-name").value = tmp290.buyerName || "Ø¹Ù…ÙŠÙ„ Ù†Ù‚Ø¯ÙŠ";
    if (tmp290.dateTimeIssued) {
      tmp292.querySelector("#manual-datetime-issued").value = tmp290.dateTimeIssued;
    }
    if (tmp290.documentType === "return" && tmp290.referenceUUID) {
      tmp292.querySelector("#manual-reference-uuid").value = tmp290.referenceUUID;
    }
    for (const tmp293 of tmp290.items) {
      tmp292.querySelector("#item-code-type").value = tmp293.itemType;
      tmp292.querySelector("#item-code").value = tmp293.itemCode;
      tmp292.querySelector("#item-description").value = tmp293.description;
      tmp292.querySelector("#item-quantity").value = tmp293.quantity;
      tmp292.querySelector("#item-unit-price").value = tmp293.unitPrice;
      tmp292.querySelector("#item-code").dispatchEvent(new Event("blur"));
      await new Promise(p141 => setTimeout(p141, 300));
      const tmp294 = tmp292.querySelector("#item-taxes-container");
      tmp294.innerHTML = "";
      if (tmp293.taxableItems && tmp293.taxableItems.length > 0) {
        for (const tmp295 of tmp293.taxableItems) {
          if (!tmp295 || !tmp295.taxType) {
            continue;
          }
          document.getElementById("add-tax-row-btn").click();
          await new Promise(p142 => setTimeout(p142, 50));
          const tmp296 = tmp294.lastElementChild;
          if (tmp296) {
            const tmp297 = tmp296.querySelector(".tax-type");
            tmp297.value = tmp295.taxType;
            tmp297.dispatchEvent(new Event("change"));
            await new Promise(p143 => setTimeout(p143, 50));
            tmp296.querySelector(".tax-subtype").value = tmp295.subType;
            tmp296.querySelector(".tax-rate").value = tmp295.rate;
            tmp296.querySelector(".tax-rate").dispatchEvent(new Event("input"));
          }
        }
      } else {}
      await new Promise(p144 => setTimeout(p144, 50));
      tmp292.querySelector("#add-item-btn").click();
    }
    fn74("ØªÙ… ÙØªØ­ Ø§Ù„Ù…Ø³ÙˆØ¯Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„. Ø§Ø¶ØºØ· \"Ø­ÙØ¸ ÙƒÙ…Ø³ÙˆØ¯Ø©\" Ø£Ùˆ \"Ø¥Ø±Ø³Ø§Ù„\" Ù„Ø­ÙØ¸ Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª.", 5000);
  }
  window.sendDraft = async function (p145) {
    const tmp298 = JSON.parse(localStorage.getItem("receiptDrafts") || "[]");
    const tmp299 = tmp298[p145];
    if (!tmp299) {
      return;
    }
    if (!confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥ÙŠØµØ§Ù„ Ø±Ù‚Ù… \"" + tmp299.receiptNumber + "\"ØŸ")) {
      return;
    }
    if (!window.receiptUploaderData) {
      alert("Ø®Ø·Ø£: Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø§ÙØ¹ ØºÙŠØ± Ù…Ù‡ÙŠØ£Ø©. ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© ÙØªØ­ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©.");
      return;
    }
    const tmpHex6cb45c = fn49(tmp299.items);
    const tmp300 = await fn50(tmpHex6cb45c);
    if (tmp300) {
      tmp298.splice(p145, 1);
      localStorage.setItem("receiptDrafts", JSON.stringify(tmp298));
      fn40();
      alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥ÙŠØµØ§Ù„ Ø¨Ù†Ø¬Ø§Ø­.");
    } else {
      alert("ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥ÙŠØµØ§Ù„.");
    }
  };
  window.deleteDraft = function (p146) {
    const tmp301 = JSON.parse(localStorage.getItem("receiptDrafts") || "[]");
    const tmp302 = tmp301[p146];
    if (!tmp302) {
      return;
    }
    if (!confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ù…Ø³ÙˆØ¯Ø© Ø±Ù‚Ù… \"" + tmp302.receiptNumber + "\"ØŸ")) {
      return;
    }
    tmp301.splice(p146, 1);
    localStorage.setItem("receiptDrafts", JSON.stringify(tmp301));
    fn40();
    alert("ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø³ÙˆØ¯Ø©.");
  };
  async function fn44() {
    if (document.getElementById("receiptUploaderUI")) {
      document.getElementById("receiptUploaderUI").style.display = "flex";
      return;
    }
    const tmp303 = document.createElement("div");
    tmp303.id = "receiptUploaderUI";
    Object.assign(tmp303.style, {
      position: "fixed",
      top: "50%",
      left: "50%",
      transform: "translate(-50%, -50%)",
      width: "800px",
      height: "600px",
      backgroundColor: "#f4f7fa",
      borderRadius: "12px",
      boxShadow: "0 10px 40px rgba(0, 0, 0, 0.2)",
      zIndex: "9999",
      fontFamily: "'Cairo', 'Segoe UI', Tahoma, sans-serif",
      display: "flex",
      flexDirection: "column",
      direction: "rtl"
    });
    tmp303.innerHTML = "\n        <div style=\"padding: 15px 25px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; background-color: #fff;\">\n            <h3 style=\"margin: 0; color: #1d3557;\">Ø±ÙØ¹ Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª Ù…Ù† Ù…Ù„Ù Excel</h3>\n            <button id=\"closeReceiptUIBtn\" title=\"Ø¥ØºÙ„Ø§Ù‚\" style=\"background: none; border: none; font-size: 24px; cursor: pointer;\">&times;</button>\n        </div>\n        <div style=\"display: flex; flex-grow: 1; overflow: hidden;\">\n            <div style=\"width: 300px; padding: 20px; border-left: 1px solid #e0e0e0; display: flex; flex-direction: column; gap: 20px; background-color: #fff;\">\n                <div>\n                    <label class=\"content-label\" style=\"font-weight: bold; margin-bottom: 10px; display: block;\">Ø§Ù„Ø®Ø·ÙˆØ© 1: ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬</label>\n                    <a id=\"downloadReceiptTemplateBtn\" class=\"action-button download-btn\" style=\"display: block; text-align: center; padding: 12px; background-color: #5a67d8; color: white; border-radius: 8px; text-decoration: none; cursor: pointer;\">ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ù†Ù…ÙˆØ°Ø¬ Excel</a>\n                </div>\n                <hr style=\"border: none; border-top: 1px solid #eee;\">\n                <div>\n                    <label class=\"content-label\" style=\"font-weight: bold; margin-bottom: 10px; display: block;\">Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù</label>\n                    <label for=\"receiptExcelInput\" class=\"action-button upload-btn\" style=\"display: block; text-align: center; padding: 12px; background-color: #38a169; color: white; border-radius: 8px; cursor: pointer;\">ğŸ“‚ Ø§Ø®ØªØ± Ù…Ù„Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª</label>\n                    <input type=\"file\" id=\"receiptExcelInput\" accept=\".xlsx, .xls\" style=\"display: none;\">\n                </div>\n            </div>\n            <div style=\"flex-grow: 1; padding: 20px; display: flex; flex-direction: column;\">\n                <h4 style=\"margin-top: 0; color: #333;\">Ø³Ø¬Ù„ Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ù…Ø±Ø³Ù„Ø© ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø¬Ù„Ø³Ø©</h4>\n                <div style=\"flex-grow: 1; overflow-y: auto; border: 1px solid #ccc; border-radius: 8px; background: #fff;\">\n                    <table id=\"receiptHistoryTable\" style=\"width: 100%; border-collapse: collapse;\">\n                        <thead>\n                            <tr style=\"background-color: #e9ecef; position: sticky; top: 0;\">\n                                <th style=\"padding: 10px; text-align: right;\">Ø±Ù‚Ù… Ø§Ù„Ø¥ÙŠØµØ§Ù„</th>\n                                <th style=\"padding: 10px; text-align: left;\">UUID</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ø³Ø¬Ù„ Ù‡Ù†Ø§ -->\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        </div>\n    ";
    document.body.appendChild(tmp303);
    document.getElementById("closeReceiptUIBtn").onclick = () => tmp303.style.display = "none";
    document.getElementById("receiptExcelInput").onchange = fn116;
    document.getElementById("downloadReceiptTemplateBtn").onclick = fn46;
    fn45();
    const tmpHex39bd1e4 = fn74("Ø¬Ø§Ø±ÙŠ ØªÙ‡ÙŠØ¦Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø§Ø¦Ø¹ ÙˆÙ†Ù‚Ø·Ø© Ø§Ù„Ø¨ÙŠØ¹...");
    try {
      const tmp304 = await fn51();
      if (!tmp304) {
        throw new Error("ÙØ´Ù„ Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ø§Ø¦Ø¹.");
      }
      const tmp305 = await fn52();
      if (!tmp305) {
        throw new Error("ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ³Ù„Ø³Ù„ÙŠ Ù„Ù†Ù‚Ø·Ø© Ø§Ù„Ø¨ÙŠØ¹.");
      }
      window.receiptUploaderData = {
        seller: tmp304,
        serial: tmp305
      };
      tmpHex39bd1e4.remove();
      fn74("âœ… Ø§Ù„Ø£Ø¯Ø§Ø© Ø¬Ø§Ù‡Ø²Ø© Ù„Ø±ÙØ¹ Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª.", 3000);
    } catch (e14) {
      tmpHex39bd1e4.remove();
      alert("âŒ Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£Ø¯Ø§Ø©: " + e14.message + ". ÙŠØ±Ø¬Ù‰ Ù…Ø­Ø§ÙˆÙ„Ø© Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ÙˆÙØªØ­Ù‡Ø§ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.");
      tmp303.style.display = "none";
    }
  }
  function fn45() {
    const tmp306 = JSON.parse(localStorage.getItem("receiptHistory") || "[]");
    const tmp307 = document.querySelector("#receiptHistoryTable tbody");
    if (!tmp307) {
      return;
    }
    tmp307.innerHTML = "";
    tmp306.forEach(p147 => {
      const tmp308 = tmp307.insertRow(0);
      tmp308.innerHTML = "\n            <td style=\"padding: 8px; text-align: center; font-family: monospace;\">" + p147.receiptNumber + "</td>\n            <td style=\"padding: 8px; text-align: center; font-family: monospace; font-size: 12px; direction: ltr;\">" + p147.uuid + "</td>\n        ";
    });
  }
  async function fn46() {
    const tmpHex39bd1e5 = fn74("Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø¥ÙŠØµØ§Ù„Ø§Øª Ø§Ù„Ø¨ÙŠØ¹...", 0);
    try {
      if (typeof ExcelJS === "undefined") {
        throw new Error("Ù…ÙƒØªØ¨Ø© ExcelJS ØºÙŠØ± Ù…Ø­Ù…Ù„Ø©.");
      }
      const tmp309 = new ExcelJS.Workbook();
      const tmp310 = tmp309.addWorksheet("Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª");
      const tmp311 = tmp309.addWorksheet("Lists");
      const vA13 = [{
        code: "EGS"
      }, {
        code: "GS1"
      }];
      const vA14 = [{
        code: "EA",
        desc_ar: "Ù‚Ø·Ø¹Ø©"
      }, {
        code: "KGM",
        desc_ar: "ÙƒÙŠÙ„ÙˆØ¬Ø±Ø§Ù…"
      }, {
        code: "LTR",
        desc_ar: "Ù„ØªØ±"
      }, {
        code: "MTR",
        desc_ar: "Ù…ØªØ±"
      }];
      const vO16 = {
        T1: {
          desc: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©",
          subtypes: [{
            code: "V009",
            desc: "Ø³Ù„Ø¹ Ø¹Ø§Ù…Ø© (14%)"
          }, {
            code: "V003",
            desc: "Ø³Ù„Ø¹Ø© Ù…Ø¹ÙØ§Ø©"
          }]
        },
        T4: {
          desc: "Ø®ØµÙ… ØªØ­Øª Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©",
          subtypes: [{
            code: "W002",
            desc: "ØªÙˆØ±ÙŠØ¯Ø§Øª"
          }]
        }
      };
      tmp311.getCell("A1").value = "CodeTypes";
      tmp311.getCell("B1").value = "UnitTypes";
      tmp311.getCell("C1").value = "MainTaxTypes";
      vA13.forEach((p148, p149) => {
        tmp311.getCell("A" + (p149 + 2)).value = p148.code;
      });
      vA14.forEach((p150, p151) => {
        tmp311.getCell("B" + (p151 + 2)).value = p150.desc_ar;
      });
      Object.values(vO16).forEach((p152, p153) => {
        tmp311.getCell("C" + (p153 + 2)).value = p152.desc;
      });
      let vLN4 = 4;
      Object.values(vO16).forEach(p154 => {
        const tmp312 = tmp311.getCell(1, vLN4);
        tmp312.value = p154.desc.replace(/[ ()]/g, "_");
        p154.subtypes.forEach((p155, p156) => {
          tmp311.getCell(p156 + 2, vLN4).value = p155.desc;
        });
        vLN4++;
      });
      const vO17 = {
        "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ù„Ù„ÙØ§ØªÙˆØ±Ø©": "Ø§ÙƒØªØ¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¹Ù„ÙŠ Ø­Ø³Ø¨ Ø§Ù„Ø³Ø±ÙŠØ§Ù„ ",
        "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: Ø£Ø¯Ø®Ù„ ØªØ§Ø±ÙŠØ® Ø¥ØµØ¯Ø§Ø± Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¨ØµÙŠØºØ© YYYY-MM-DD. Ø¥Ø°Ø§ ØªØ±Ùƒ ÙØ§Ø±ØºÙ‹Ø§ØŒ Ø³ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ.",
        "ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ù„ÙŠÙ…": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: Ø£Ø¯Ø®Ù„ ØªØ§Ø±ÙŠØ® ØªØ³Ù„ÙŠÙ… Ø§Ù„Ø®Ø¯Ù…Ø© Ø£Ùˆ Ø§Ù„Ø¨Ø¶Ø§Ø¹Ø© Ø¨ØµÙŠØºØ© YYYY-MM-DD.",
        "Ø±Ù‚Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ„Ù…": " ÙÙŠ Ø­Ø§Ù„Ù‡ Ø§Ø®ØªÙŠØ§Ø± Ø´Ø±ÙƒØ© ÙŠØªÙ… ÙƒØªØ§Ø¨Ù‡ Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ Ø§Ù„Ù…ÙƒÙˆÙ† Ù…Ù† 9 Ø§Ø±Ù‚Ø§Ù… - ÙÙŠ Ø­Ø§Ù„Ù‡ Ø§Ø®ØªÙŠØ§Ø± Ø´Ø®ØµÙŠ ÙŠØªÙ… ÙƒØªØ§Ø¨Ù‡ 123456789 Ø§Ùˆ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ø§Ù† ÙˆØ¬Ø¯ ÙˆØ¨Ø¹Ø¯ Ø§Ù„Ø±ÙØ¹ ØªÙ‚ÙˆÙ… Ø¨Ø­Ø°ÙÙ‡  ÙˆØ§Ù„Ø§Ø¬Ù†Ø¨ÙŠ Ù†ÙØ³ Ø§Ù„Ù†Ø¸Ø§Ù… ",
        "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…": "ØºÙŠØ± Ù…Ø·Ù„ÙˆØ¨ ÙÙŠ Ø­Ø§Ù„Ù‡ ÙƒØªØ§Ø¨Ù‡ Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„",
        "Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªÙ„Ù…": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©: B Ù„Ø´Ø±ÙƒØ©ØŒ P Ù„Ø´Ø®ØµÙŠØŒ F Ù„Ø£Ø¬Ù†Ø¨ÙŠ.",
        "Ø¯ÙˆÙ„Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù…": "ØºÙŠØ± Ù…Ø·Ù„ÙˆØ¨ ÙÙŠ Ø­Ø§Ù„Ù‡ ÙƒØªØ§Ø¨Ù‡ Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„",
        "Ù…Ø­Ø§ÙØ¸Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù…": "ØºÙŠØ± Ù…Ø·Ù„ÙˆØ¨ ÙÙŠ Ø­Ø§Ù„Ù‡ ÙƒØªØ§Ø¨Ù‡ Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„",
        "Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù…": "ØºÙŠØ± Ù…Ø·Ù„ÙˆØ¨ ÙÙŠ Ø­Ø§Ù„Ù‡ ÙƒØªØ§Ø¨Ù‡ Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„",
        "Ø´Ø§Ø±Ø¹ Ø§Ù„Ù…Ø³ØªÙ„Ù…": "ØºÙŠØ± Ù…Ø·Ù„ÙˆØ¨ ÙÙŠ Ø­Ø§Ù„Ù‡ ÙƒØªØ§Ø¨Ù‡ Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„",
        "Ù…Ø¨Ù†Ù‰ Ø§Ù„Ù…Ø³ØªÙ„Ù…": "ØºÙŠØ± Ù…Ø·Ù„ÙˆØ¨ ÙÙŠ Ø­Ø§Ù„Ù‡ ÙƒØªØ§Ø¨Ù‡ Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„",
        "ÙˆØµÙ Ø§Ù„ØµÙ†Ù": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ø³Ù… Ø£Ùˆ ÙˆØµÙ ÙˆØ§Ø¶Ø­ Ù„Ù„Ø³Ù„Ø¹Ø© Ø£Ùˆ Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø¨Ø§Ø¹Ø©.",
        "Ù†ÙˆØ¹ ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù": "ÙÙŠ Ø­Ø§Ù„Ù‡ Ø§Ø®ØªÙŠØ§Ø± GS1  ÙŠØªÙ… ÙƒØªØ§Ø¨Ù‡ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ Ù…Ø«Ø§Ù„ : - 10007598 Ø§Ù… ÙÙŠ Ø­Ø§Ù„Ù‡ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙƒÙˆØ¯ EGS  ÙŠØªÙ… ÙƒØªØ§Ø¨Ù‡ Ø§Ù„ÙƒÙˆØ¯ EG-Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„-Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ù…Ø«Ø§Ù„ EG-123456789-100",
        "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù": "ÙÙŠ Ø­Ø§Ù„Ù‡ Ø§Ù„Ø§ÙŠØµØ§Ù„Ø§Øª Ù…Ø·Ù„ÙˆØ¨ Ø§Ø¬Ø¨Ø§Ø±ÙŠ ÙƒØªØ§Ø¨Ù‡ Ø§Ù„ÙƒÙˆØ¯ Ù…Ø«Ø§Ù„ 1 Ø§Ù… ÙÙŠ Ø­Ø§Ù„Ù‡ Ø§Ù„ÙÙˆØ§ØªÙŠØ± ØºÙŠØ± Ù…Ø·Ù„ÙˆØ¨ ",
        "ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚ÙŠØ§Ø³": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ø®ØªØ± ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© (Ù…Ø«Ø§Ù„: Ù‚Ø·Ø¹Ø©).",
        Ø§Ù„ÙƒÙ…ÙŠØ©: "Ù…Ø·Ù„ÙˆØ¨: Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¨Ø§Ø¹ Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„ØµÙ†Ù.",
        "Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø©": "Ù…Ø·Ù„ÙˆØ¨: Ø³Ø¹Ø± Ø§Ù„Ù‚Ø·Ø¹Ø© Ø§Ù„ÙˆØ§Ø­Ø¯Ø© Ù…Ù† Ø§Ù„ØµÙ†Ù.",
        "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 1": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© (Ù…Ø«Ø§Ù„: Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©).",
        "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ 1": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ Ù„Ù„Ø¶Ø±ÙŠØ¨Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªØ±Ø§Ø¨Ø·Ø©.",
        "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 1": "Ù…Ø·Ù„ÙˆØ¨: Ø£Ø¯Ø®Ù„ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© Ù„Ù„Ø¶Ø±ÙŠØ¨Ø© (Ù…Ø«Ø§Ù„: 14).",
        "UUID Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©": "Ù…Ø·Ù„ÙˆØ¨ Ù„Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª ÙÙ‚Ø·: Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ¹Ø±ÙŠÙÙŠ Ø§Ù„ÙØ±ÙŠØ¯ Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø¨ÙŠØ¹ Ø§Ù„Ø£ØµÙ„ÙŠØ©."
      };
      const tmp313 = Object.keys(vO17);
      tmp310.columns = tmp313.map(p157 => ({
        header: p157,
        key: p157
      }));
      tmp310.getRow(1).eachCell(p158 => {
        const tmp314 = p158.value;
        p158.font = {
          name: "Arial",
          bold: true,
          size: 14,
          color: {
            argb: "FFFFFFFF"
          }
        };
        p158.fill = {
          type: "pattern",
          pattern: "solid",
          fgColor: {
            argb: "FF343A40"
          }
        };
        p158.alignment = {
          vertical: "middle",
          horizontal: "center"
        };
        if (vO17[tmp314]) {
          p158.note = vO17[tmp314];
        }
      });
      tmp310.autoFilter = {
        from: "A1",
        to: {
          row: 1,
          column: tmp313.length
        }
      };
      tmp310.columns.forEach(p159 => {
        p159.width = 30;
      });
      const vF12 = (p160, p161) => {
        for (let vLN22 = 2; vLN22 <= 1001; vLN22++) {
          tmp310.getCell("" + p160 + vLN22).dataValidation = {
            type: "list",
            allowBlank: true,
            formulae: [p161]
          };
        }
      };
      vF12("G", "=Lists!$A$2:$A$3");
      vF12("I", "=Lists!$B$2:$B$" + (vA14.length + 1));
      vF12("L", "=Lists!$C$2:$C$" + (Object.keys(vO16).length + 1));
      vF12("O", "=Lists!$C$2:$C$" + (Object.keys(vO16).length + 1));
      const tmpLocalINDIRECTSUBSTITUTESU3 = "=INDIRECT(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(L2,\" \",\"_\"),\"(\",\"_\"),\")\",\"_\"))";
      const tmpLocalINDIRECTSUBSTITUTESU4 = "=INDIRECT(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(O2,\" \",\"_\"),\"(\",\"_\"),\")\",\"_\"))";
      vF12("M", tmpLocalINDIRECTSUBSTITUTESU3);
      vF12("P", tmpLocalINDIRECTSUBSTITUTESU4);
      Object.values(vO16).forEach((p162, p163) => {
        const tmp315 = String.fromCharCode("A".charCodeAt(0) + 3 + p163);
        const tmp316 = p162.desc.replace(/[ ()]/g, "_");
        const tmp317 = "Lists!$" + tmp315 + "$2:$" + tmp315 + "$" + (p162.subtypes.length + 1);
        tmp309.definedNames.add(tmp317, tmp316);
      });
      tmp311.state = "hidden";
      tmp310.views = [{
        rightToLeft: true
      }];
      const tmp318 = await tmp309.xlsx.writeBuffer();
      const tmp319 = new Blob([tmp318], {
        type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
      });
      if (typeof saveAs === "undefined") {
        throw new Error("Ù…ÙƒØªØ¨Ø© FileSaver.js ØºÙŠØ± Ù…Ø­Ù…Ù„Ø©.");
      }
      saveAs(tmp319, "Ù†Ù…ÙˆØ°Ø¬_Ø±ÙØ¹_Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª_Ù…Ø¹Ø¯Ù„.xlsx");
    } catch (e15) {
      alert("ÙØ´Ù„ Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥ÙƒØ³ÙŠÙ„: " + e15.message);
    } finally {
      tmpHex39bd1e5.remove();
    }
  }
  async function fn47(p164, p165 = "sale") {
    document.getElementById("receiptEditorModal")?.remove();
    const vO18 = {
      T1: "Ù‚ÙŠÙ…Ø© Ù…Ø¶Ø§ÙØ©",
      T2: "Ø¬Ø¯ÙˆÙ„ (Ù†Ø³Ø¨ÙŠ)",
      T3: "Ø¬Ø¯ÙˆÙ„ (Ù†ÙˆØ¹ÙŠ)",
      T4: "Ø®ØµÙ… ØªØ­ØµÙŠÙ„",
      T5: "Ø¯Ù…ØºØ© (Ù†Ø³Ø¨ÙŠ)",
      T6: "Ø¯Ù…ØºØ© (Ù‚Ø·Ø¹ÙŠ)",
      T7: "Ù…Ù„Ø§Ù‡ÙŠ",
      T8: "ØªÙ†Ù…ÙŠØ© Ù…ÙˆØ§Ø±Ø¯",
      T9: "Ø±Ø³Ù… Ø®Ø¯Ù…Ø©",
      T10: "Ù…Ø­Ù„ÙŠØ§Øª",
      T11: "ØªØ£Ù…ÙŠÙ† ØµØ­ÙŠ",
      T12: "Ø±Ø³ÙˆÙ… Ø£Ø®Ø±Ù‰"
    };
    const tmp320 = document.createElement("div");
    tmp320.id = "receiptEditorModal";
    tmp320.style.cssText = "\n        position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n        background-color: rgba(0,0,0,0.6); z-index: 10000;\n        display: flex; align-items: center; justify-content: center;\n        direction: rtl; font-family: 'Segoe UI', Tahoma, sans-serif;\n    ";
    const tmp321 = document.createElement("div");
    tmp321.style.cssText = "\n        background-color: #f4f7fc; width: 95%; max-width: 1800px; height: 95%;\n        border-radius: 12px; display: flex; flex-direction: column;\n        box-shadow: 0 5px 25px rgba(0,0,0,0.2); overflow: hidden;\n    ";
    tmp321.innerHTML = "<div style=\"display:flex; align-items:center; justify-content:center; height:100%; font-size: 22px; color: #555;\">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù„Ø§Ø²Ù…Ø©...</div>";
    tmp320.appendChild(tmp321);
    document.body.appendChild(tmp320);
    let tmp322;
    let tmp323;
    let tmp324;
    let tmp325;
    try {
      tmp322 = await fetchTaxpayerInfo();
      if (!tmp322) {
        throw new Error("ÙØ´Ù„ Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù…ÙˆÙ„.");
      }
      tmp323 = await fn52();
      if (!tmp323 || tmp323.length === 0) {
        throw new Error("ÙØ´Ù„ Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ù‚Ø§Ø· Ø§Ù„Ø¨ÙŠØ¹.");
      }
      tmp324 = tmp323[0];
      const tmp326 = tmp322.activities || [];
      tmp325 = "4690";
      let tmpLocal4 = "";
      if (tmp326.length > 0) {
        const tmp327 = tmp326.find(p166 => p166.toDate === null) || tmp326[0];
        tmp325 = tmp327.activityTypeCode;
        tmpLocal4 = "\n                <div class=\"form-group\">\n                    <label for=\"activity-select-editor\" class=\"select-label\">ÙƒÙˆØ¯ Ø§Ù„Ù†Ø´Ø§Ø·:</label>\n                    <select id=\"activity-select-editor\" class=\"custom-select\">\n                        " + tmp326.map(p167 => "<option value=\"" + p167.activityTypeCode + "\" " + (p167.activityTypeCode === tmp327.activityTypeCode ? "selected" : "") + ">" + p167.activityTypeCode + " - " + p167.activityTypeNameSecondaryLang + "</option>").join("") + "\n                    </select>\n                </div>";
      } else {
        tmpLocal4 = "<div class=\"form-group\"><label class=\"select-label\">ÙƒÙˆØ¯ Ø§Ù„Ù†Ø´Ø§Ø·:</label><div class=\"info-div\">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£Ù†Ø´Ø·Ø©</div></div>";
      }
      let tmpLocal5 = "";
      p164.forEach((p168, p169) => {
        const tmp328 = p168[0] || {};
        const tmp329 = p165 === "return" ? fn127(p168, tmp322, tmp324.serialNumber, tmp325) : fn49(p168, tmp322, tmp324.serialNumber, tmp325);
        const tmp330 = p165 === "return" ? "Ø¥Ø´Ø¹Ø§Ø± Ù…Ø±ØªØ¬Ø¹" : "Ø¥ÙŠØµØ§Ù„ Ø¨ÙŠØ¹";
        const tmp331 = p165 === "return" ? "#c0392b" : "#2980b9";
        const tmp332 = p165 === "return" ? "<tr><th>UUID Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©</th><td style=\"font-family: monospace; font-size: 14px; direction: ltr; background: #fff5f5;\">" + (tmp328.referenceUUID || "<span style=\"color:red;\">Ù…Ø·Ù„ÙˆØ¨!</span>") + "</td></tr>" : "";
        const tmp333 = tmp329.itemData.map((p170, p171) => {
          const tmp334 = p170.taxableItems.reduce((p172, p173) => p172 + p173.amount, 0);
          return "\n                    <tr style=\"border-bottom: 1px solid #f1f1f1;\">\n                        <td style=\"padding: 10px;\">" + p170.itemType + "</td>\n                        <td style=\"padding: 10px; font-family: monospace;\">" + p170.itemCode + "</td>\n                        <td style=\"padding: 10px; background-color: #f0f8ff;\">" + (p168[p171].officialCodeName || "") + "</td>\n                        <td style=\"padding: 10px; text-align: right;\">" + p170.description + "</td>\n                        <td style=\"padding: 10px;\">" + p170.quantity + "</td>\n                        <td style=\"padding: 10px;\">" + p170.unitPrice.toFixed(2) + "</td>\n                        <td style=\"padding: 10px;\">" + p170.totalSale.toFixed(2) + "</td>\n                        <td style=\"padding: 10px; color: #c0392b;\">" + tmp334.toFixed(5) + "</td>\n                        <td style=\"padding: 10px; font-weight: bold;\">" + p170.total.toFixed(2) + "</td>\n                    </tr>\n                ";
        }).join("");
        const tmp335 = "\n                <tr><td class=\"details-total-label\">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</td><td class=\"details-total-value\">" + tmp329.totalSales.toFixed(2) + "</td></tr>\n                " + tmp329.taxTotals.map(p174 => "<tr><td class=\"details-total-label\">" + (vO18[p174.taxType] || p174.taxType) + "</td><td class=\"details-total-value\">" + p174.amount.toFixed(2) + "</td></tr>").join("") + "\n                <tr class=\"details-grand-total\"><td class=\"details-total-label\">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</td><td class=\"details-total-value\">" + tmp329.totalAmount.toFixed(2) + "</td></tr>\n            ";
        tmpLocal5 += "\n               <tbody data-receipt-number=\"" + p169 + "\" data-doc-type=\"" + p165 + "\">\n                    <tr style=\"background-color: #fff; border-bottom: 1px solid #e9ecef; cursor: pointer;\" class=\"toggle-details-trigger\">\n                        <td style=\"width: 50px; padding: 15px; text-align: center; vertical-align: middle;\"><input type=\"checkbox\" class=\"receipt-checkbox\" style=\"width: 20px; height: 20px; vertical-align: middle;\"></td>\n                        <td class=\"toggle-details-icon\" style=\"font-weight: bold; font-size: 28px; width: 40px; color: #007bff; text-align: center; padding: 15px; vertical-align: middle;\">+</td>\n                        <td style=\"padding: 15px; text-align: center; vertical-align: middle; font-size: 16px;\">" + p169 + " <span style=\"color: " + tmp331 + "; font-weight: bold;\">(" + tmp330 + ")</span></td>\n                        <td style=\"padding: 15px; text-align: center; vertical-align: middle; font-size: 16px;\">" + (tmp328.buyerName || "Ø¹Ù…ÙŠÙ„ Ù†Ù‚Ø¯ÙŠ") + "</td>\n                        <td style=\"padding: 15px; text-align: center; vertical-align: middle; font-weight: 600; font-size: 16px;\">" + tmp329.totalSales.toFixed(2) + "</td>\n                        <td style=\"padding: 15px; text-align: center; vertical-align: middle; font-weight: bold; font-size: 18px;\">" + tmp329.totalAmount.toFixed(2) + "</td>\n                        <td style=\"padding: 15px; text-align: center; vertical-align: middle;\"><button class=\"delete-receipt-btn\" title=\"Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªÙ†Ø¯\" style=\"background: #dc3545; color: white; border: none; border-radius: 50%; cursor: pointer; width: 32px; height: 32px; font-size: 20px; line-height: 32px;\">&times;</button></td>\n                    </tr>\n                    <tr class=\"receipt-details-row\" style=\"display: none;\">\n                        <td colspan=\"7\" style=\"padding: 0 !important;\">\n                            <div style=\"padding: 25px; background-color: #f0f2f5; border-top: 4px solid #0d6efd;\">\n                                <div class=\"details-grid\">\n                                    <div class=\"details-card receiver-card\">\n                                        <h4 class=\"details-card-header\">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙ„Ù… (Ø§Ù„Ù…Ø´ØªØ±ÙŠ)</h4>\n                                        <table class=\"details-table\">\n                                            <tbody>\n                                                " + tmp332 + "\n                                               <tr><th>Ø§Ù„Ø§Ø³Ù…</th><td>" + (tmp328.buyerName || "") + "</td></tr>\n                                                <tr><th>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ</th><td>" + (tmp328.buyerId || "") + "</td></tr>\n                                            </tbody>\n                                        </table>\n                                    </div>\n                                    <div class=\"details-card items-details-card\">\n                                        <h4 class=\"details-card-header\">Ø¨Ù†ÙˆØ¯ Ø§Ù„Ù…Ø³ØªÙ†Ø¯</h4>\n                                        <table class=\"details-table items-details-table\">\n                                            <thead>\n                                                <tr>\n                                                    <th>Ù†ÙˆØ¹ Ø§Ù„ÙƒÙˆØ¯</th><th>ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù</th><th>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø³Ù…ÙŠ</th><th>Ø§Ù„ÙˆØµÙ</th>\n                                                    <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th><th>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©</th><th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</th>\n                                                </tr>\n                                            </thead>\n                                            <tbody>" + tmp333 + "</tbody>\n                                        </table>\n                                    </div>\n                                    <div class=\"details-card totals-details-card\">\n                                        <h4 class=\"details-card-header\">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª</h4>\n                                        <table class=\"details-table totals-details-table\">\n                                            <tbody>" + tmp335 + "</tbody>\n                                        </table>\n                                    </div>\n                                </div>\n                            </div>\n                        </td>\n                    </tr>\n                </tbody>";
      });
      tmp321.innerHTML = "\n            <div style=\"padding: 20px 25px; border-bottom: 1px solid #ddd; background-color: #f8f9fa; flex-shrink: 0;\">\n                <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;\">\n                    <h3 style=\"margin: 0; color: #2161a1; font-size: 22px;\">Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØªØ£ÙƒÙŠØ¯ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª (" + p164.size + ")</h3>\n                    <div style=\"display: flex; gap: 12px;\">\n                        <button id=\"saveAllAsDraftsBtn\" class=\"header-btn\" style=\"background-color: #ffc107; color: #333;\">ğŸ“ Ø­ÙØ¸ Ø§Ù„ÙƒÙ„ ÙƒÙ…Ø³ÙˆØ¯Ø§Øª</button>\n                        <button id=\"sendSelectedReceiptsBtn\" class=\"header-btn send-btn\">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ø­Ø¯Ø¯</button>\n                        <button id=\"readJsonBtn\" class=\"header-btn\" style=\"background-color: #fd7e14; color: white;\">ğŸ” Ù‚Ø±Ø§Ø¡Ø© JSON</button>\n                        <button id=\"closeReceiptEditorBtn\" class=\"header-btn close-btn\">Ø¥ØºÙ„Ø§Ù‚</button>\n                    </div>\n                </div>\n                \n                <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 15px 20px; background-color: #e9ecef; padding: 20px; border-radius: 8px;\">\n                    <div class=\"form-group\">\n                        <label for=\"pos-select-editor\" class=\"select-label\">Ù†Ù‚Ø·Ø© Ø§Ù„Ø¨ÙŠØ¹ (POS):</label>\n                        <select id=\"pos-select-editor\" class=\"custom-select\">\n                            " + tmp323.map(p175 => {
        const tmp336 = p175.address || {};
        const tmp337 = (p175.formatedAddress || (tmp336.street || "") + ", " + (tmp336.regionCity || "")).replace(/^0\s+/, "").trim();
        let vO19 = {};
        if (p175.formatedAddress) {
          const tmp338 = p175.formatedAddress.trim();
          const tmp339 = tmp338.split(",");
          const tmp340 = tmp339[0] || "";
          const tmp341 = tmp340.match(/^(\d+)\s+/);
          let tmpLocal6 = "";
          let vV340 = tmp340;
          if (tmp341) {
            tmpLocal6 = tmp341[1];
            vV340 = tmp340.substring(tmp341[0].length).trim();
          }
          vO19 = {
            buildingNumber: tmpLocal6,
            street: vV340,
            regionCity: tmp339[1]?.trim() || "",
            governate: tmp339[2]?.trim() || ""
          };
        } else if (p175.address) {
          vO19 = {
            ...p175.address,
            buildingNumber: p175.address.buildingNo || ""
          };
        }
        return "<option value=\"" + p175.serialNumber + "\" data-address='" + JSON.stringify(vO19) + "' " + (p175.serialNumber === tmp324.serialNumber ? "selected" : "") + ">\n                                            " + (tmp337 || p175.serialNumber) + "\n                                        </option>";
      }).join("") + "\n                        </select>\n                    </div>\n                    " + tmpLocal4 + "\n                    <div class=\"form-group\"><label for=\"editor-seller-name\" class=\"select-label\">Ø§Ø³Ù… Ø§Ù„Ù…ØµØ¯Ø±:</label><input type=\"text\" id=\"editor-seller-name\" class=\"custom-select\" value=\"" + tmp322.name + "\"></div>\n                    <div class=\"form-group\"><label for=\"editor-seller-governate\" class=\"select-label\">Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©:</label><input type=\"text\" id=\"editor-seller-governate\" class=\"custom-select\" value=\"" + tmp322.governate + "\"></div>\n                    <div class=\"form-group\"><label for=\"editor-seller-regionCity\" class=\"select-label\">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</label><input type=\"text\" id=\"editor-seller-regionCity\" class=\"custom-select\" value=\"" + tmp322.regionCity + "\"></div>\n                    <div class=\"form-group\"><label for=\"editor-seller-street\" class=\"select-label\">Ø§Ù„Ø´Ø§Ø±Ø¹:</label><input type=\"text\" id=\"editor-seller-street\" class=\"custom-select\" value=\"" + tmp322.street + "\"></div>\n                    <div class=\"form-group\"><label for=\"editor-seller-building\" class=\"select-label\">Ø±Ù‚Ù… Ø§Ù„Ù…Ø¨Ù†Ù‰:</label><input type=\"text\" id=\"editor-seller-building\" class=\"custom-select\" value=\"" + (tmp322.buildingNumber || "") + "\"></div>\n                </div>\n            </div>\n            <div style=\"overflow-y: auto; flex-grow: 1;\">\n                <table style=\"width: 100%; border-collapse: collapse;\">\n                    <thead style=\"position: sticky; top: 0; background: #020b18ff; color: white; z-index: 10;\">\n                       <tr>\n                            <th style=\"padding: 15px; text-align: center;\"><input type=\"checkbox\" id=\"selectAllCheckbox\" style=\"width: 20px; height: 20px;\"></th>\n                            <th></th><th>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ (ÙˆØ§Ù„Ù†ÙˆØ¹)</th><th>Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„</th><th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù‚Ø¨Ù„ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©</th>\n                            <th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</th><th>Ø­Ø°Ù</th>\n                       </tr>\n                    </thead>\n                    <tbody>" + tmpLocal5 + "</tbody>\n                </table>\n            </div>\n            <div style=\"padding: 15px 25px; background-color: #343a40; color: white; text-align: center; border-top: 4px solid #0d6efd; flex-shrink: 0;\">\n                <strong style=\"font-size: 18px;\">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©: <span id=\"grandTotalAmount\" style=\"color: #28a745; font-size: 22px;\">0.00</span></strong>\n            </div>\n        ";
      const tmp342 = document.createElement("style");
      tmp342.innerHTML = "\n            .details-grid { display: grid; grid-template-columns: 1fr 2fr; gap: 20px; }\n            .issuer-card { display: none; } /* Ø¥Ø®ÙØ§Ø¡ Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…ØµØ¯Ø± Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© */\n            .receiver-card { grid-column: 1 / 2; grid-row: 1 / 2; }\n            .items-details-card { grid-column: 2 / 3; grid-row: 1 / 3; }\n            .totals-details-card { grid-column: 1 / 2; grid-row: 2 / 3; }\n            .details-card { background: #fff; border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; }\n            .details-card-header { color: #0d6efd; border-bottom: 2px solid #eee; padding-bottom: 8px; margin-top: 0; margin-bottom: 15px; font-size: 16px; }\n            .details-table { width: 100%; border-collapse: collapse; }\n            .details-table th, .details-table td { border: 1px solid #f0f0f0; padding: 8px; text-align: right; font-size: 13px; }\n            .details-table th { background-color: #f8f9fa; width: 100px; font-weight: 600; }\n            .items-details-table th, .items-details-table td { text-align: center; padding: 6px; white-space: nowrap; }\n            .totals-details-table .details-total-label { font-weight: bold; }\n            .totals-details-table .details-grand-total td { font-size: 16px; font-weight: bold; background-color: #e9ecef; }\n            .header-btn { padding: 10px 22px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 15px; }\n            .send-btn { background-color: #28a745; color: white; }\n            .close-btn { background-color: #6c757d; color: white; }\n            .form-group { display: flex; flex-direction: column; }\n            .select-label { font-size: 14px; font-weight: 600; margin-bottom: 5px; display: block; color: #343a40; }\n            .custom-select { width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc; font-size: 14px; }\n            .info-div { padding: 10px; background-color: #fff; border-radius: 5px; border: 1px solid #ccc; }\n        ";
      tmp320.appendChild(tmp342);
      const vF13 = () => tmp320.remove();
      document.getElementById("closeReceiptEditorBtn").onclick = vF13;
      tmp320.querySelectorAll(".toggle-details-trigger").forEach(p176 => {
        p176.onclick = p177 => {
          if (p177.target.tagName === "BUTTON" || p177.target.tagName === "INPUT") {
            return;
          }
          const tmp343 = p176.nextElementSibling;
          const tmp344 = p176.querySelector(".toggle-details-icon");
          const tmp345 = tmp343.style.display !== "none";
          tmp343.style.display = tmp345 ? "none" : "table-row";
          tmp344.textContent = tmp345 ? "+" : "-";
        };
      });
      tmp320.querySelectorAll(".delete-receipt-btn").forEach(p178 => {
        p178.onclick = p179 => {
          p179.stopPropagation();
          const tmp346 = p179.target.closest("tbody");
          if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø±Ù‚Ù… \"" + tmp346.dataset.receiptNumber + "\"ØŸ")) {
            tmp346.remove();
            vF14();
          }
        };
      });
      const tmp347 = document.getElementById("grandTotalAmount");
      const vF14 = () => {
        let vLN013 = 0;
        const tmp348 = document.getElementById("activity-select-editor")?.value || tmp325;
        const tmp349 = document.getElementById("pos-select-editor").value;
        const vO20 = {
          id: tmp322.id,
          name: document.getElementById("editor-seller-name").value,
          governate: document.getElementById("editor-seller-governate").value,
          regionCity: document.getElementById("editor-seller-regionCity").value,
          street: document.getElementById("editor-seller-street").value,
          buildingNumber: document.getElementById("editor-seller-building").value
        };
        tmp320.querySelectorAll(".receipt-checkbox:checked").forEach(p180 => {
          const tmp350 = p180.closest("tbody");
          const tmp351 = tmp350.dataset.receiptNumber;
          const tmp352 = tmp350.dataset.docType;
          const tmp353 = p164.get(tmp351);
          const tmp354 = tmp352 === "return" ? fn127(tmp353, vO20, tmp349, tmp348) : fn49(tmp353, vO20, tmp349, tmp348);
          vLN013 += tmp354.totalAmount;
        });
        tmp347.textContent = vLN013.toFixed(2);
      };
      document.getElementById("selectAllCheckbox").onchange = p181 => {
        tmp320.querySelectorAll(".receipt-checkbox").forEach(p182 => p182.checked = p181.target.checked);
        vF14();
      };
      tmp320.querySelectorAll(".receipt-checkbox, #pos-select-editor, #activity-select-editor, #editor-seller-name, #editor-seller-governate, #editor-seller-regionCity, #editor-seller-street, #editor-seller-building").forEach(p183 => {
        p183.onchange = vF14;
        p183.oninput = vF14;
      });
      vF14();
      document.getElementById("saveAllAsDraftsBtn").onclick = () => {};
      document.getElementById("sendSelectedReceiptsBtn").onclick = async () => {
        const tmp355 = document.getElementById("sendSelectedReceiptsBtn");
        const tmp356 = Array.from(tmp320.querySelectorAll(".receipt-checkbox:checked")).map(p184 => p184.closest("tbody"));
        if (tmp356.length === 0) {
          alert("ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ Ù…Ø³ØªÙ†Ø¯ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù„Ø¥Ø±Ø³Ø§Ù„Ù‡.");
          return;
        }
        if (!confirm("Ø³ÙŠØªÙ… Ø§Ù„Ø¢Ù† ØªØ¬Ù…ÙŠØ¹ " + tmp356.length + " Ù…Ø³ØªÙ†Ø¯ ÙÙŠ Ø¯ÙØ¹Ø© ÙˆØ§Ø­Ø¯Ø© ÙˆØ¥Ø±Ø³Ø§Ù„Ù‡Ø§. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©ØŸ")) {
          return;
        }
        tmp355.disabled = true;
        const tmpHex39bd1e6 = fn74("Ø¬Ø§Ø±ÙŠ Ø¨Ù†Ø§Ø¡ Ø³Ù„Ø³Ù„Ø© UUID Ù„Ù€ " + tmp356.length + " Ù…Ø³ØªÙ†Ø¯...");
        try {
          const tmp357 = document.getElementById("pos-select-editor").value;
          const tmp358 = document.getElementById("activity-select-editor");
          const tmp359 = tmp358 ? tmp358.value : tmp325;
          const vO21 = {
            id: tmp322.id,
            name: document.getElementById("editor-seller-name").value,
            governate: document.getElementById("editor-seller-governate").value,
            regionCity: document.getElementById("editor-seller-regionCity").value,
            street: document.getElementById("editor-seller-street").value,
            buildingNumber: document.getElementById("editor-seller-building").value
          };
          const vA15 = [];
          let tmp360 = (JSON.parse(localStorage.getItem("receiptHistory") || "[]")[0] || {}).uuid || "";
          for (const tmp361 of tmp356) {
            const tmp362 = tmp361.dataset.receiptNumber;
            const tmp363 = tmp361.dataset.docType;
            const tmp364 = p164.get(tmp362);
            const tmp365 = tmp363 === "return" ? fn127(tmp364, vO21, tmp357, tmp359) : fn49(tmp364, vO21, tmp357, tmp359);
            tmp365.header.previousUUID = tmp360;
            const tmp366 = JSON.stringify({
              receipts: [tmp365]
            });
            const tmp367 = await vF.computeUuidFromRawText(tmp366);
            tmp365.header.uuid = tmp367;
            vA15.push(tmp365);
            tmp360 = tmp367;
          }
          const vO22 = {
            receipts: vA15
          };
          const tmp368 = await fn128(vO22, "Ø¯ÙØ¹Ø© Ù…Ù† " + vA15.length + " Ù…Ø³ØªÙ†Ø¯");
          if (tmp368.success) {
            tmpHex39bd1e6.remove();
            alert("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø¯ÙØ¹Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ " + vA15.length + " Ù…Ø³ØªÙ†Ø¯ Ø¨Ù†Ø¬Ø§Ø­!");
            vF13();
          } else {
            throw new Error(tmp368.error || "ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¯ÙØ¹Ø©.");
          }
        } catch (e16) {
          tmpHex39bd1e6.remove();
          alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙØ§Ø¯Ø­ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: " + e16.message);
        } finally {
          tmp355.disabled = false;
        }
      };
      document.getElementById("readJsonBtn").addEventListener("click", async () => {
        const tmp369 = Array.from(document.querySelectorAll("#receiptEditorModal .receipt-checkbox:checked")).map(p185 => p185.closest("tbody"));
        if (tmp369.length === 0) {
          alert("ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ Ù…Ø³ØªÙ†Ø¯ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù„Ù‚Ø±Ø§Ø¡Ø© Ø¨ÙŠØ§Ù†Ø§ØªÙ‡.");
          return;
        }
        try {
          const tmp370 = document.getElementById("pos-select-editor").value;
          const tmp371 = document.getElementById("activity-select-editor");
          const tmp372 = tmp371 ? tmp371.value : tmp325;
          const vO23 = {
            id: tmp322.id,
            name: document.getElementById("editor-seller-name").value,
            governate: document.getElementById("editor-seller-governate").value,
            regionCity: document.getElementById("editor-seller-regionCity").value,
            street: document.getElementById("editor-seller-street").value,
            buildingNumber: document.getElementById("editor-seller-building").value
          };
          const vA16 = [];
          let tmp373 = (JSON.parse(localStorage.getItem("receiptHistory") || "[]")[0] || {}).uuid || "";
          for (const tmp374 of tmp369) {
            const tmp375 = tmp374.dataset.receiptNumber;
            const tmp376 = tmp374.dataset.docType;
            const tmp377 = p164.get(tmp375);
            if (!tmp377) {
              continue;
            }
            const tmp378 = tmp376 === "return" ? fn127(tmp377, vO23, tmp370, tmp372) : fn49(tmp377, vO23, tmp370, tmp372);
            tmp378.header.previousUUID = tmp373;
            const tmp379 = JSON.stringify({
              receipts: [tmp378]
            });
            const tmp380 = await vF.computeUuidFromRawText(tmp379);
            tmp378.header.uuid = tmp380;
            tmp373 = tmp380;
            vA16.push(tmp378);
          }
          const vO24 = {
            receipts: vA16
          };
          const tmp381 = JSON.stringify(vO24, null, 4);
          const tmp382 = window.open("", "_blank");
          tmp382.document.write("<pre style=\"direction: ltr; text-align: left; white-space: pre-wrap; word-wrap: break-word;\">" + tmp381 + "</pre>");
          tmp382.document.close();
        } catch (e17) {
          alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¨Ù†Ø§Ø¡ JSON: " + e17.message);
        }
      });
      const tmp383 = document.getElementById("pos-select-editor");
      if (tmp383) {
        tmp383.addEventListener("change", p186 => {
          const tmp384 = p186.target.options[p186.target.selectedIndex];
          const tmp385 = JSON.parse(tmp384.dataset.address || "{}");
          document.getElementById("editor-seller-governate").value = tmp385.governate || "";
          document.getElementById("editor-seller-regionCity").value = tmp385.regionCity || "";
          document.getElementById("editor-seller-street").value = tmp385.street || "";
          document.getElementById("editor-seller-building").value = tmp385.buildingNumber || "";
        });
        tmp383.dispatchEvent(new Event("change"));
      }
    } catch (e18) {
      tmp321.innerHTML = "<div style=\"display:flex; flex-direction:column; align-items:center; justify-content:center; height:100%; font-size: 22px; color: #d9534f; text-align: center; padding: 20px;\">\n            <p>ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©.</p>\n            <p style=\"font-size: 16px; color: #555;\">Ø§Ù„Ø®Ø·Ø£: " + e18.message + "</p>\n            <button id=\"closeErrorModal\" class=\"header-btn close-btn\" style=\"margin-top: 20px;\">Ø¥ØºÙ„Ø§Ù‚</button>\n        </div>";
      tmp321.querySelector("#closeErrorModal").onclick = () => tmp320.remove();
    }
  }
  async function fn50(p187, p188) {
    let tmpLocal7 = "";
    try {
      const tmp386 = p187.receipts;
      if (!tmp386 || tmp386.length === 0) {
        throw new Error("ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: ÙƒØ§Ø¦Ù† Ø§Ù„Ø¯ÙØ¹Ø© ÙØ§Ø±Øº Ø£Ùˆ Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¥ÙŠØµØ§Ù„Ø§Øª.");
      }
      tmpLocal7 = tmp386[tmp386.length - 1].header.uuid;
      const tmp387 = JSON.stringify(p187, null, 2);
      const tmp388 = new JSZip();
      tmp388.file("receipts.json", tmp387);
      const tmp389 = await tmp388.generateAsync({
        type: "blob",
        compression: "DEFLATE"
      });
      const tmp390 = document.querySelector("input[type=\"file\"]");
      if (!tmp390) {
        throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø­Ù‚Ù„ Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª.");
      }
      const tmp391 = new File([tmp389], "receipts.zip", {
        type: "application/zip"
      });
      const tmp392 = new DataTransfer();
      tmp392.items.add(tmp391);
      tmp390.files = tmp392.files;
      tmp390.dispatchEvent(new Event("change", {
        bubbles: true
      }));
      await new Promise(p189 => setTimeout(p189, 200));
      const tmp393 = Array.from(document.querySelectorAll("button span.ms-Button-label")).find(p190 => p190.textContent.trim() === "Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©");
      if (!tmp393) {
        throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø²Ø± \"Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©\".");
      }
      const tmp394 = tmp393.closest("button");
      tmp394.click();
      await new Promise((p191, p192) => {
        const vLN30000 = 30000;
        const vLN250 = 250;
        let vLN015 = 0;
        const vSetInterval3 = setInterval(() => {
          const tmp395 = document.body.contains(tmp394) && tmp394.offsetParent !== null;
          if (!tmp395) {
            clearInterval(vSetInterval3);
            p191();
          } else if (vLN015 >= vLN30000) {
            clearInterval(vSetInterval3);
            p191();
          }
          vLN015 += vLN250;
        }, vLN250);
      });
      return {
        success: true,
        uuid: tmpLocal7,
        error: null
      };
    } catch (e19) {
      return {
        success: false,
        uuid: tmpLocal7,
        error: e19.message
      };
    }
  }
  function fn49(p193, p194, p195, p196, p197 = null) {
    const vO25 = {
      id: (p194 || window.receiptUploaderData.seller).id,
      name: fn120(document.getElementById("editor-seller-name")?.value || (p194 || window.receiptUploaderData.seller).name),
      governate: fn120(document.getElementById("editor-seller-governate")?.value || (p194 || window.receiptUploaderData.seller).governate),
      regionCity: fn120(document.getElementById("editor-seller-regionCity")?.value || (p194 || window.receiptUploaderData.seller).regionCity),
      street: fn120(document.getElementById("editor-seller-street")?.value || (p194 || window.receiptUploaderData.seller).street),
      buildingNumber: String(document.getElementById("editor-seller-building")?.value || (p194 || window.receiptUploaderData.seller).buildingNumber || "0").trim()
    };
    const tmp396 = p195 || window.receiptUploaderData.serial;
    const tmp397 = p196 || (p194 || window.receiptUploaderData.seller).taxpayerActivityCode || "4690";
    const tmp398 = p193[0];
    const tmp399 = JSON.parse(localStorage.getItem("receiptHistory") || "[]");
    const tmp400 = tmp399.length > 0 ? tmp399[0].uuid : "";
    let tmpLocalEGP = "EGP";
    let vLN016 = 0;
    const tmp401 = p193.find(p198 => p198.currencySold && p198.currencySold !== "EGP");
    if (tmp401) {
      tmpLocalEGP = tmp401.currencySold;
      vLN016 = parseFloat(tmp401.exchangeRate) || 1;
    }
    const vO26 = {
      dateTimeIssued: fn4(tmp398.dateTimeIssued),
      receiptNumber: String(tmp398.receiptNumber || "RCPT_" + Math.floor(Date.now() / 1000)),
      previousUUID: tmp400,
      uuid: "",
      currency: tmpLocalEGP,
      exchangeRate: parseFloat(vLN016.toFixed(5))
    };
    let vLN017 = 0;
    const tmp402 = new Map();
    const tmp403 = p193.map(p199 => {
      const vParseFloat7 = parseFloat((parseFloat(p199.quantity) || 0).toFixed(5));
      const vParseFloat8 = parseFloat((parseFloat(p199.unitPrice) || 0).toFixed(5));
      const vVParseFloat8 = vParseFloat8;
      const vParseFloat9 = parseFloat((vParseFloat7 * vVParseFloat8).toFixed(5));
      const vVParseFloat9 = vParseFloat9;
      const vA17 = [];
      let vLN018 = 0;
      for (let vLN12 = 1; vLN12 <= 2; vLN12++) {
        const tmp404 = p199["taxType_" + vLN12];
        const vParseFloat10 = parseFloat(p199["taxRate_" + vLN12]);
        if (tmp404 && !isNaN(vParseFloat10) && vParseFloat10 > 0) {
          const vParseFloat11 = parseFloat((vVParseFloat9 * (vParseFloat10 / 100)).toFixed(5));
          vA17.push({
            taxType: String(tmp404),
            amount: vParseFloat11,
            subType: String(p199["taxSubType_" + vLN12]),
            rate: vParseFloat10
          });
          vLN018 += tmp404 === "T4" ? -vParseFloat11 : vParseFloat11;
          tmp402.set(String(tmp404), (tmp402.get(String(tmp404)) || 0) + vParseFloat11);
        }
      }
      const vParseFloat12 = parseFloat((vVParseFloat9 + vLN018).toFixed(5));
      vLN017 += vParseFloat9;
      return {
        internalCode: String(p199.internalCode || p199.itemCode),
        description: fn120(String(p199.description), 100).padEnd(5, " "),
        itemType: String(p199.itemType || "EGS"),
        itemCode: String(p199.itemCode),
        unitType: String(p199.unitType || "EA"),
        quantity: vParseFloat7,
        unitPrice: vVParseFloat8,
        netSale: vVParseFloat9,
        totalSale: vParseFloat9,
        total: vParseFloat12,
        valueDifference: 0,
        taxableItems: vA17,
        itemDiscountData: []
      };
    });
    const vO27 = {
      header: vO26,
      documentType: {
        receiptType: "S",
        typeVersion: "1.2"
      },
      seller: {
        rin: vO25.id,
        companyTradeName: vO25.name,
        branchCode: "0",
        branchAddress: {
          country: "EG",
          governate: vO25.governate,
          regionCity: vO25.regionCity,
          street: vO25.street,
          buildingNumber: vO25.buildingNumber
        },
        deviceSerialNumber: tmp396,
        activityCode: tmp397
      },
      buyer: {
        type: "P",
        id: tmp398.buyerId,
        name: tmp398.buyerName || undefined,
        mobileNumber: "",
        paymentNumber: ""
      },
      itemData: tmp403,
      totalSales: parseFloat(vLN017.toFixed(5)),
      totalItemsDiscount: 0,
      netAmount: parseFloat(vLN017.toFixed(5)),
      taxTotals: Array.from(tmp402, ([tmp405, tmp406]) => ({
        taxType: tmp405,
        amount: parseFloat(tmp406.toFixed(5))
      })),
      totalAmount: parseFloat(tmp403.reduce((p200, p201) => p200 + p201.total, 0).toFixed(5)),
      paymentMethod: "C",
      feesAmount: 0,
      adjustment: 0
    };
    return vO27;
  }
  async function fn50(p202) {
    const tmpHex39bd1e7 = fn74("ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...");
    try {
      const tmp407 = JSON.stringify({
        receipts: [p202]
      });
      const tmp408 = await vF.computeUuidFromRawText(tmp407);
      p202.header.uuid = tmp408;
      const tmp409 = JSON.stringify({
        receipts: [p202]
      }, null, 2);
      const tmp410 = new JSZip();
      tmp410.file("receipts.json", tmp409);
      const tmp411 = await tmp410.generateAsync({
        type: "blob",
        compression: "DEFLATE"
      });
      const tmp412 = document.querySelector("input[type=\"file\"]");
      if (!tmp412) {
        throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø­Ù‚Ù„ Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª.");
      }
      const tmp413 = new File([tmp411], "receipts.zip", {
        type: "application/zip"
      });
      const tmp414 = new DataTransfer();
      tmp414.items.add(tmp413);
      tmp412.files = tmp414.files;
      tmp412.dispatchEvent(new Event("change", {
        bubbles: true
      }));
      const tmp415 = Array.from(document.querySelectorAll("button span.ms-Button-label")).find(p203 => p203.textContent.trim() === "Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©");
      if (!tmp415) {
        throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø²Ø± \"Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©\".");
      }
      tmp415.closest("button").click();
      const tmp416 = JSON.parse(localStorage.getItem("receiptHistory") || "[]");
      const vO28 = {
        receiptNumber: p202.header.receiptNumber,
        uuid: p202.header.uuid
      };
      tmp416.unshift(vO28);
      localStorage.setItem("receiptHistory", JSON.stringify(tmp416.slice(0, 50)));
      fn45();
      tmpHex39bd1e7.remove();
      fn74("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥ÙŠØµØ§Ù„ " + vO28.receiptNumber + " Ø¨Ù†Ø¬Ø§Ø­!", 5000);
    } catch (e20) {
      alert("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙØ§Ø¯Ø­ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„: " + e20.message);
    } finally {
      if (tmpHex39bd1e7) {
        tmpHex39bd1e7.remove();
      }
    }
  }
  async function fn51() {
    return await fetchTaxpayerInfo();
  }
  async function fn52() {
    const tmpHex57971a4 = getAccessTokenFromUserData();
    if (!tmpHex57971a4) {
      return null;
    }
    try {
      const tmpUrlHttpsapiportalinvoic = "https://api-portal.invoicing.eta.gov.eg/api/v1/pos/devices/current?Ps=100";
      const tmp417 = await fetch(tmpUrlHttpsapiportalinvoic, {
        headers: {
          Authorization: "Bearer " + tmpHex57971a4
        }
      });
      if (!tmp417.ok) {
        const tmp418 = await tmp417.text();
        return null;
      }
      const tmp419 = await tmp417.json();
      const tmp420 = tmp419?.data?.filter(p204 => p204.status === "Active");
      if (tmp420 && tmp420.length > 0) {
        tmp420.sort((p205, p206) => {
          const tmp421 = new Date(p205.firstAuthenticationDate);
          const tmp422 = new Date(p206.firstAuthenticationDate);
          return tmp422 - tmp421;
        });
        return tmp420;
      } else {
        return [];
      }
    } catch (e21) {
      return null;
    }
  }
  let tmp423 = false;
  let vLN019 = 0;
  const vLN10 = 10;
  const vO29 = {
    T1: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©",
    T2: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„ (Ù†Ø³Ø¨ÙŠØ©)",
    T3: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„ (Ø§Ù„Ù†ÙˆØ¹ÙŠØ©)",
    T4: "Ø§Ù„Ø®ØµÙ… ØªØ­Øª Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©",
    T5: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¯Ù…ØºØ© (Ù†Ø³Ø¨ÙŠØ©)",
    T6: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¯Ù…ØºØ© (Ù‚Ø·Ø¹ÙŠØ© Ø¨Ù…Ù‚Ø¯Ø§Ø± Ø«Ø§Ø¨Øª)",
    T7: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù…Ù„Ø§Ù‡ÙŠ",
    T8: "Ø±Ø³Ù… ØªÙ†Ù…ÙŠØ© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯",
    T9: "Ø±Ø³Ù… Ø®Ø¯Ù…Ø©",
    T10: "Ø±Ø³Ù… Ø§Ù„Ù…Ø­Ù„ÙŠØ§Øª",
    T11: "Ø±Ø³Ù… Ø§Ù„ØªØ£Ù…ÙŠÙ† Ø§Ù„ØµØ­ÙŠ",
    T12: "Ø±Ø³ÙˆÙ… Ø£Ø®Ø±Ù‰",
    T13: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¯Ù…ØºØ© (Ù†Ø³Ø¨ÙŠØ©)",
    T14: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¯Ù…ØºØ© (Ù‚Ø·Ø¹ÙŠØ© Ø¨Ù…Ù‚Ø¯Ø§Ø± Ø«Ø§Ø¨Øª)",
    T15: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù…Ù„Ø§Ù‡ÙŠ",
    T16: "Ø±Ø³Ù… ØªÙ†Ù…ÙŠØ© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯",
    T17: "Ø±Ø³Ù… Ø®Ø¯Ù…Ø©",
    T18: "Ø±Ø³Ù… Ø§Ù„Ù…Ø­Ù„ÙŠØ§Øª",
    T19: "Ø±Ø³Ù… Ø§Ù„ØªØ£Ù…ÙŠÙ† Ø§Ù„ØµØ­ÙŠ",
    T20: "Ø±Ø³ÙˆÙ… Ø£Ø®Ø±Ù‰"
  };
  async function fetchTaxpayerInfo() {
    try {
      const tmpHex57971a5 = getAccessTokenFromUserData();
      const tmp424 = JSON.parse(localStorage.getItem("USER_DATA") || "{}");
      const tmp425 = tmp424?.profile?.TaxRin || tmp424?.profile?.taxRin;
      if (!tmpHex57971a5 || !tmp425) {
        return null;
      }
      const tmp426 = await fetch("https://api-portal.invoicing.eta.gov.eg/api/v1/taxpayers/" + tmp425 + "/light", {
        headers: {
          Authorization: "Bearer " + tmpHex57971a5,
          Accept: "application/json"
        }
      });
      if (!tmp426.ok) {
        return null;
      }
      const tmp427 = await tmp426.json();
      const tmp428 = tmp427.taxpayerBranchs?.[0];
      const tmp429 = tmp428?.address;
      const tmp430 = tmp428?.taxpayerActivities || [];
      let tmpLocal4690 = "4690";
      if (tmp430.length > 0) {
        const tmp431 = tmp430.find(p207 => p207.toDate === null);
        if (tmp431) {
          tmpLocal4690 = tmp431.activityTypeCode;
        } else {
          tmpLocal4690 = tmp430[tmp430.length - 1].activityTypeCode;
        }
      } else {}
      return {
        id: tmp427.registrationNumber,
        name: tmp427.nameSecondaryLang || tmp427.namePrimaryLang || "Ø§Ø³Ù… ØºÙŠØ± Ù…Ø­Ø¯Ø¯",
        taxpayerActivityCode: tmpLocal4690,
        activities: tmp430,
        governate: tmp429?.governorateNameSecondaryLang || "",
        regionCity: tmp429?.cityNameSecondaryLang || "",
        street: tmp429?.streetName || "",
        buildingNumber: tmp429?.buildingNo || ""
      };
    } catch (e22) {
      return null;
    }
  }
  function fn54() {
    if (window.location.pathname !== "/newdocument") {
      return;
    }
    if (document.getElementById("customInvoiceCreatorBtn")) {
      return;
    }
    const tmp432 = document.querySelector("button[id^='Pivot'][id$='-Tab3']");
    if (!tmp432) {
      if (vLN019 < vLN10) {
        vLN019++;
        setTimeout(fn54, 500);
        return;
      }
      return;
    }
    const tmp433 = document.createElement("button");
    tmp433.id = "customInvoiceCreatorBtn";
    tmp433.type = "button";
    tmp433.className = tmp432.className.replace("is-selected", "").replace("linkIsSelected-135", "");
    const tmpLocalsvgWidth24Height24Vi2 = "\n        <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <path d=\"M14 2H6C4.89543 2 4 2.89543 4 4V20C4 21.1046 4.89543 22 6 22H18C19.1046 22 20 21.1046 20 20V8L14 2Z\" fill=\"#107C41\"/>\n            <path d=\"M14 2V8H20\" fill=\"#10B981\" fill-opacity=\"0.5\"/>\n            <path d=\"M12.5 13.5L15 17M15 13.5L12.5 17\" stroke=\"white\" stroke-width=\"1.5\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n            <path d=\"M9.5 17H10.5L12 14.75L10.5 12H9.5L8 14.25L9.5 17Z\" stroke=\"white\" stroke-width=\"1.5\" stroke-linejoin=\"round\"/>\n        </svg>\n    ";
    tmp433.innerHTML = "\n        <span class=\"btn-content-wrapper\">\n            <span class=\"btn-icon-container\">" + tmpLocalsvgWidth24Height24Vi2 + "</span>\n            <span class=\"ms-Pivot-text btn-text\">Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù† Excel</span>\n        </span>\n    ";
    const tmp434 = document.createElement("style");
    tmp434.id = "customButtonStyles";
    if (!document.getElementById(tmp434.id)) {
      tmp434.innerHTML = "\n            #customInvoiceCreatorBtn {\n                background: rgba(22, 163, 74, 0.1);\n                border: 1px solid rgba(22, 163, 74, 0.3);\n                border-radius: 6px;\n                backdrop-filter: blur(10px);\n                -webkit-backdrop-filter: blur(10px);\n                transition: all 0.3s ease;\n                margin: 0 10px;\n                position: relative;\n                overflow: hidden;\n            }\n            #customInvoiceCreatorBtn .btn-content-wrapper {\n                display: flex;\n                align-items: center;\n                gap: 8px;\n                padding: 4px 8px;\n            }\n            #customInvoiceCreatorBtn .btn-icon-container {\n                background-color: #16A34A;\n                border-radius: 4px;\n                padding: 4px;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                box-shadow: 0 1px 3px rgba(0,0,0,0.2);\n            }\n            #customInvoiceCreatorBtn .btn-text {\n                color: #14532d;\n                font-weight: 600;\n            }\n            #customInvoiceCreatorBtn::before {\n                content: '';\n                position: absolute;\n                top: 50%; left: 50%;\n                width: 300px; height: 300px;\n                background: radial-gradient(circle, rgba(255,255,255,0.4) 0%, rgba(255,255,255,0) 70%);\n                transform: translate(-50%, -50%) scale(0);\n                transition: transform 0.5s ease;\n                opacity: 0;\n            }\n            #customInvoiceCreatorBtn:hover::before {\n                transform: translate(-50%, -50%) scale(1);\n                opacity: 1;\n            }\n            #customInvoiceCreatorBtn:hover {\n                border-color: rgba(22, 163, 74, 0.5);\n                background: rgba(22, 163, 74, 0.2);\n                box-shadow: 0 4px 15px rgba(22, 163, 74, 0.2);\n            }\n        ";
      document.head.appendChild(tmp434);
    }
    tmp433.addEventListener("click", async p208 => {
      p208.preventDefault();
      const tmp435 = await verifyEtaSubscriptionOrPrompt();
      fn55(tmp435);
    });
    tmp432.parentNode.insertBefore(tmp433, tmp432);
    vLN019 = 0;
  }
  async function fn55(p209 = true) {
    if (document.getElementById("invoiceCreatorMainUI")) {
      const tmp436 = document.getElementById("invoiceCreatorMainUI");
      tmp436.style.display = "flex";
      tmp436.querySelector(".sidebar-btn[data-target=\"panel-create\"]").click();
      return;
    }
    const tmp437 = document.createElement("link");
    tmp437.href = "https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Kufam:wght@600&display=swap";
    tmp437.rel = "stylesheet";
    document.head.appendChild(tmp437);
    const tmp438 = document.createElement("div");
    tmp438.id = "invoiceCreatorMainUI";
    Object.assign(tmp438.style, {
      position: "fixed",
      top: "50%",
      left: "50%",
      transform: "translate(-50%, -50%)",
      width: "1080px",
      height: "700px",
      backgroundColor: "#ffffff",
      borderRadius: "12px",
      boxShadow: "0 10px 40px rgba(0, 0, 0, 0.2)",
      zIndex: "9999",
      fontFamily: "'Cairo', 'Segoe UI', Tahoma, sans-serif",
      overflow: "hidden",
      display: "flex",
      direction: "rtl"
    });
    tmp438.innerHTML = "\n        \n       <div class=\"sidebar\">\n            <div class=\"sidebar-header\"><h3>ğŸš€ Ø§Ù„ÙÙˆØ§ØªÙŠØ±</h3></div>\n            <div class=\"sidebar-menu\">\n                " + (p209 ? "\n                    <button class=\"sidebar-btn\" data-target=\"panel-create\"><span class=\"btn-icon\">â•</span> Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù† Excel</button>\n                    <button class=\"sidebar-btn\" data-target=\"panel-credit-note\"><span class=\"btn-icon\">â†©ï¸</span> Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø± Ø¯Ø§Ø¦Ù†</button>\n                " : "") + "\n                <button class=\"sidebar-btn\" data-target=\"panel-drafts\"><span class=\"btn-icon\">ğŸ–¨ï¸</span> Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø³ÙˆØ¯Ø§Øª</button>\n                <button class=\"sidebar-btn\" data-target=\"panel-taxpayer-query\"><span class=\"btn-icon\">ğŸ”</span> Ø§Ø³ØªØ¹Ù„Ø§Ù… Ø¹Ù† Ù…Ù…ÙˆÙ„</button>\n                <button class=\"sidebar-btn\" data-target=\"panel-codes-explorer\"><span class=\"btn-icon\">ğŸ“¦</span> Ù…Ø³ØªÙƒØ´Ù Ø§Ù„Ø£ÙƒÙˆØ§Ø¯</button>\n                " + (!p209 ? "\n                    <button class=\"sidebar-btn active\" data-target=\"panel-subscription\" style=\"margin-top: auto; background-color: #1a4a7d;\">\n                        <span class=\"btn-icon\">â­</span> Ø§Ù„Ø§Ø´ØªØ±Ø§Ùƒ ÙˆØ§Ù„Ø¯Ø¹Ù…\n                    </button>\n                " : "") + "\n            </div>\n        </div>\n        <div class=\"main-panel\">\n            <button id=\"closeInvoiceCreatorBtn\" title=\"Ø¥ØºÙ„Ø§Ù‚\">&times;</button>\n            <div class=\"panel-content-wrapper\">\n                " + (p209 ? "\n                    <div id=\"panel-create\" class=\"panel-content\"></div>\n                    <div id=\"panel-credit-note\" class=\"panel-content\"></div>\n                " : "") + "\n                <div id=\"panel-drafts\" class=\"panel-content\"></div>\n                <div id=\"panel-taxpayer-query\" class=\"panel-content\"></div>\n                <div id=\"panel-codes-explorer\" class=\"panel-content\"></div>\n                " + (!p209 ? "\n                    <div id=\"panel-subscription\" class=\"panel-content\"></div>\n                " : "") + "\n            </div>\n            <div id=\"info-sidebar\" class=\"info-sidebar\">\n                <div id=\"taxpayer-info-box\" class=\"info-card\">\n                    <div class=\"card-header\"><span class=\"card-icon\">ğŸ‘¤</span><h3>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù…ÙˆÙ„</h3></div>\n                    <div class=\"card-body\"><p>Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</p></div>\n                </div>\n                <div class=\"info-card prayer-card\"><p>Ø§Ù„Ù„Ù‡ÙÙ… ØµÙ„Ù‘Ù Ø¹Ù„Ù‰ Ù…ÙØ­Ù…Ø¯</p></div>\n                <div id=\"designer-info-box\" class=\"info-card\">\n                     <div class=\"card-header\"><span class=\"card-icon\">ğŸ’»</span><h3>Ø§Ù„Ù…ØµÙ…Ù…</h3></div>\n                     <div class=\"card-body\">\n                        <p class=\"designer-name\">Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ : Ù…Ø­Ù…Ø¯ ØµØ¨Ø±ÙŠ</p>\n                        <p class=\"designer-contact\"><span class=\"card-icon\" style=\"font-size: 14px;\">ğŸ“</span>ÙˆØ§ØªØ³Ø§Ø¨: 01060872599</p>\n                     </div>\n                </div>\n            </div>\n        </div>\n    ";
    fn56();
    const tmp439 = document.createElement("style");
    tmp439.innerHTML = "\n        .sidebar { width: 220px; background-color: #0d1b2a; color: #e0e1dd; display: flex; flex-direction: column; flex-shrink: 0; }\n        .sidebar-header { padding: 20px; text-align: center; border-bottom: 1px solid #415a77; }\n        .sidebar-menu { flex-grow: 1; padding-top: 15px; }\n        .sidebar-btn { display: flex; align-items: center; width: 100%; padding: 15px 20px; background-color: transparent; border: none; color: #e0e1dd; font-size: 16px; font-family: 'Cairo', sans-serif; text-align: right; cursor: pointer; transition: background-color 0.3s, color 0.3s; border-right: 4px solid transparent; }\n        .sidebar-btn:hover { background-color: #1b263b; }\n        .sidebar-btn.active { background-color: #415a77; color: #ffffff; font-weight: 700; border-right-color: #778da9; }\n        .sidebar-btn .btn-icon { margin-left: 12px; font-size: 18px; }\n        .main-panel { flex-grow: 1; background-color: #f4f7fa; display: flex; position: relative; }\n        #closeInvoiceCreatorBtn { position: absolute; top: 10px; left: 10px; width: 32px; height: 32px; background-color: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; border-radius: 50%; font-size: 24px; line-height: 30px; text-align: center; cursor: pointer; z-index: 10; transition: all 0.2s ease; }\n        #closeInvoiceCreatorBtn:hover { background-color: #e63946; color: white; transform: scale(1.1); box-shadow: 0 2px 8px rgba(0,0,0,0.2); }\n        .panel-content-wrapper { flex-grow: 1; overflow-y: auto; position: relative; }\n        .panel-content { display: none; padding: 25px; height: 100%; box-sizing: border-box; }\n        .panel-content.active { display: block; animation: fadeIn 0.5s; }\n        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }\n        .info-sidebar { width: 350px; flex-shrink: 0; background-color: #e9ecef; border-right: 1px solid #dee2e6; padding: 20px 15px; display: flex; flex-direction: column; gap: 20px; transition: opacity 0.3s, visibility 0.3s; }\n        .info-card { background-color: #fff; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.07); border: 1px solid #dbe4f0; }\n        .info-card .card-header { display: flex; align-items: center; gap: 10px; background-color: #f8f9fa; padding: 10px 15px; border-bottom: 1px solid #e9ecef; border-top-left-radius: 9px; border-top-right-radius: 9px; }\n        .info-card .card-header h3 { margin: 0; font-size: 15px; color: #1d3557; }\n        .info-card .card-icon { font-size: 18px; color: #457b9d; }\n        .info-card .card-body { padding: 15px; font-size: 14px; color: #343a40; }\n        .info-card .card-body p { margin: 5px 0; line-height: 1.6; }\n        #taxpayer-info-box strong { color: #0d1b2a; }\n        .prayer-card { text-align: center; padding: 20px; background: linear-gradient(135deg, #1d3557, #457b9d); color: #fff; text-shadow: 1px 1px 3px rgba(0,0,0,0.3); }\n        .prayer-card p { font-family: 'Kufam', cursive; font-size: 22px; font-weight: 600; margin: 0; }\n        #designer-info-box .designer-name { font-weight: bold; color: #1d3557; }\n        #designer-info-box .designer-contact { font-size: 13px; color: #007bff; display: flex; align-items: center; gap: 8px; }\n        .panel-header { border-bottom: 1px solid #dee2e6; padding-bottom: 15px; margin-bottom: 25px; }\n        .panel-header h2 { margin: 0 0 5px 0; color: #0d1b2a; font-size: 22px; }\n        .panel-header p { margin: 0; color: #6c757d; font-size: 15px; }\n        .content-step { margin-bottom: 20px; }\n        .content-label { display: block; font-size: 15px; font-weight: 600; color: #343a40; margin-bottom: 8px; }\n        .content-select { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ced4da; font-size: 15px; }\n        .button-group { display: flex; gap: 15px; }\n        .action-button { padding: 12px 20px; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 15px; flex-grow: 1; text-align: center; display: flex; align-items: center; justify-content: center; transition: transform 0.2s; }\n        .action-button:hover { transform: translateY(-2px); }\n        .download-btn { background-color: #5a67d8; }\n        .upload-btn { background-color: #38a169; }\n        .drafts-btn-main { background-color: #dd6b20; width: 60%; margin: 20px auto; padding: 15px; font-size: 18px; }\n        .comments-area { display: flex; flex-direction: column; height: 100%; }\n        .comments-container { flex-grow: 1; overflow-y: auto; padding: 10px; background: #e9ecef; border-radius: 8px; margin-bottom: 20px; }\n        .comment-box { background: white; padding: 15px; border-radius: 10px; margin-bottom: 15px; border-right: 5px solid #a8dadc; box-shadow: 0 2px 5px rgba(0,0,0,0.05); position: relative; }\n        .comment-box.admin-comment { border-right-color: #fca311; }\n        .comment-image { max-width: 150px; max-height: 150px; border-radius: 8px; margin-top: 10px; cursor: pointer; transition: transform 0.3s; object-fit: cover; }\n        .admin-form-container { background-color: #fff; padding: 40px; border-radius: 12px; text-align: center; max-width: 400px; margin: 40px auto; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }\n        .admin-input { width: 100%; padding: 12px; margin-bottom: 20px; border: 1px solid #ccc; border-radius: 8px; font-size: 16px; text-align: center; }\n        .admin-submit-btn { background-color: #1d3557; color: white; padding: 12px 30px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 16px; width: 100%; }\n        .help-section { margin-bottom: 25px; }\n        .help-title { font-size: 18px; color: #1d3557; border-bottom: 2px solid #a8dadc; padding-bottom: 8px; margin-bottom: 15px; }\n        .help-table { width: 100%; border-collapse: collapse; font-size: 14px; }\n        .help-table th, .help-table td { border: 1px solid #dee2e6; padding: 12px; text-align: right; vertical-align: middle; }\n        .help-table th { background-color: #f8f9fa; font-weight: 700; color: #495057; }\n        .help-table tbody tr:nth-child(even) { background-color: #f9f9f9; }\n        .help-table td strong { color: #0d1b2a; }\n        .required-star { color: #e63946; font-weight: bold; margin-right: 4px; }\n        .help-notes { background-color: #fffbe6; border: 1px solid #ffe58f; border-right: 5px solid #fca311; padding: 15px 20px; border-radius: 8px; }\n        .help-notes ul { padding-right: 20px; margin: 0; }\n        .help-notes li { margin-bottom: 12px; line-height: 1.7; font-size: 15px; }\n        .note-highlight { font-weight: bold; color: #1d3557; }\n        .query-container { display: flex; gap: 10px; margin-bottom: 20px; align-items: center; padding: 10px; background: #f8f9fa; border-radius: 12px; border: 1px solid #e9ecef; }\n        #taxpayerQueryInput { flex-grow: 1; padding: 12px 15px; border: 1px solid #ced4da; border-radius: 8px; font-size: 16px; text-align: left; direction: ltr; transition: all 0.3s ease; }\n        #taxpayerQueryInput:focus { border-color: #007bff; box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.15); outline: none; }\n        #taxpayerQueryBtn { padding: 12px 25px; font-size: 16px; font-weight: bold; background: linear-gradient(145deg, #007bff, #0056b3); color: white; border: none; border-radius: 8px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 10px rgba(0, 123, 255, 0.2); }\n        #taxpayerQueryBtn:hover { transform: translateY(-2px); box-shadow: 0 6px 15px rgba(0, 123, 255, 0.3); }\n        #queryResultContainer { background-color: #e9ecef; border-radius: 8px; padding: 15px; height: calc(100% - 150px); overflow-y: auto; }\n        .query-placeholder { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; font-size: 20px; color: #6c757d; text-align: center; }\n        .query-placeholder svg { width: 80px; height: 80px; margin-bottom: 20px; opacity: 0.5; }\n        .profile-card, .branch-card, .activity-card { background: #ffffff; border-radius: 12px; margin-bottom: 20px; border: 1px solid #dee2e6; box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05); overflow: hidden; animation: fadeIn 0.5s ease-out; }\n        .card-header { display: flex; align-items: center; gap: 12px; padding: 15px 20px; background: #f8f9fa; border-bottom: 1px solid #e9ecef; }\n        .card-header .icon { font-size: 24px; color: #007bff; }\n        .card-header h3 { margin: 0; font-size: 18px; font-weight: 700; color: #343a40; }\n        .card-body { padding: 20px; display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px 25px; }\n        .info-field { display: flex; align-items: center; background: #f8f9fa; border-radius: 8px; padding: 8px 12px; border: 1px solid #e9ecef; }\n        .info-field .label-icon { font-size: 18px; color: #6c757d; margin-left: 10px; }\n        .info-field .value { font-size: 15px; color: #212529; font-weight: 500; }\n        .info-field .value.ltr { direction: ltr; text-align: left; flex-grow: 1; }\n        .info-field .status { padding: 4px 10px; border-radius: 15px; font-weight: bold; font-size: 13px; }\n        .info-field .status.active { background-color: #d4edda; color: #155724; }\n        .info-field .status.inactive { background-color: #f8d7da; color: #721c24; }\n        .activity-card { border-left: 5px solid #17a2b8; }\n        .activity-card .card-header .icon { color: #17a2b8; }\n        .codes-explorer-grid { display: grid; grid-template-columns: 350px 1fr; gap: 20px; height: 100%; }\n        .search-panel { display: flex; flex-direction: column; background: #f8f9fa; border-radius: 12px; padding: 15px; border: 1px solid #e9ecef; }\n        .details-panel { display: flex; flex-direction: column; }\n        .search-options { display: flex; gap: 10px; margin-bottom: 15px; }\n        .search-options select { flex-grow: 1; padding: 10px; border: 1px solid #ced4da; border-radius: 8px; }\n        #code-search-input { width: 100%; padding: 12px 15px; border: 1px solid #ced4da; border-radius: 8px; font-size: 16px; margin-bottom: 15px; }\n        #search-results-list { list-style: none; padding: 0; margin: 0; overflow-y: auto; flex-grow: 1; border: 1px solid #e9ecef; border-radius: 8px; background: #fff; }\n        .search-result-item { padding: 12px 15px; border-bottom: 1px solid #e9ecef; cursor: pointer; transition: background-color 0.2s; }\n        .search-result-item:last-child { border-bottom: none; }\n        .search-result-item:hover, .search-result-item.selected { background-color: #e0e7ff; }\n        .search-result-item strong { display: block; color: #1d3557; font-size: 15px; }\n        .search-result-item span { font-size: 13px; color: #007bff; font-family: monospace; }\n        #code-details-container { padding: 20px; background: #fff; border-radius: 12px; border: 1px solid #dee2e6; overflow-y: auto; flex-grow: 1; }\n        .detail-card { background: #f8f9fa; border-radius: 8px; padding: 15px; margin-bottom: 15px; border-left: 4px solid #007bff; }\n        .detail-card h4 { margin: 0 0 10px 0; color: #343a40; font-size: 16px; }\n        .detail-card p { margin: 5px 0; font-size: 15px; }\n        .detail-card p .label { font-weight: 600; color: #495057; min-width: 100px; display: inline-block; }\n        .detail-card p .value { color: #1d3557; }\n        .detail-card p .value.code { color: #e63946; font-family: monospace; font-weight: bold; }\n        .list-placeholder { text-align: center; color: #888; padding: 20px; }\n    ";
    document.body.appendChild(tmp439);
    document.body.appendChild(tmp438);
    function fn56() {
      const tmp440 = document.getElementById("panel-credit-note");
      if (!tmp440) {
        return;
      }
      tmp440.innerHTML = "\n        <div class=\"panel-header\">\n            <h2>Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø± Ø¯Ø§Ø¦Ù† (Credit Note) Ù…Ù† Ù…Ù„Ù Excel</h2>\n            <p>Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ù„Ø±ÙØ¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¯Ø§Ø¦Ù†Ø©.</p>\n        </div>\n\n        <!-- 1. Ø§Ø®ØªÙŠØ§Ø± Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¯Ø§Ø¦Ù† -->\n        <div class=\"content-step\">\n            <label class=\"content-label\">Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¯Ø§Ø¦Ù†</label>\n            <select id=\"creditNoteTypeSelect\" class=\"content-select\">\n                <option value=\"with_reference\" selected>Ø¥Ø´Ø¹Ø§Ø± Ø¯Ø§Ø¦Ù† Ø¨Ø±Ø¨Ø· (ÙŠØªØ·Ù„Ø¨ UUID Ù„ÙØ§ØªÙˆØ±Ø© Ø³Ø§Ø¨Ù‚Ø©)</option>\n                <option value=\"without_reference\">Ø¥Ø´Ø¹Ø§Ø± Ø¯Ø§Ø¦Ù† Ø¨Ø¯ÙˆÙ† Ø±Ø¨Ø·</option>\n            </select>\n        </div>\n\n        <!-- 2. Ø§Ø®ØªÙŠØ§Ø± Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ø³ØªÙ†Ø¯ -->\n        <div class=\"content-step\">\n            <label class=\"content-label\">Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø§Ø®ØªØ± Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ø³ØªÙ†Ø¯</label>\n            <select id=\"creditNoteVersionSelect\" class=\"content-select\">\n                <option value=\"1.0\" selected>Ø¥ØµØ¯Ø§Ø± 1.0 (Ù…Ø³ØªÙ†Ø¯ Ù†Ù‡Ø§Ø¦ÙŠ ÙˆÙ…ÙˆÙ‚Ø¹)</option>\n                <option value=\"0.9\">Ø¥ØµØ¯Ø§Ø± 0.9 (Ù…Ø³ÙˆØ¯Ø© ØºÙŠØ± Ù…ÙˆÙ‚Ø¹Ø©)</option>\n            </select>\n        </div>\n\n        <!-- 3. ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙˆØ±ÙØ¹ Ø§Ù„Ù…Ù„Ù -->\n        <div class=\"content-step\">\n            <label class=\"content-label\">Ø§Ù„Ø®Ø·ÙˆØ© 3: ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙˆØ±ÙØ¹ Ø§Ù„Ù…Ù„Ù</label>\n            <div class=\"button-group\">\n                <button id=\"downloadCreditNoteTemplateBtn\" class=\"action-button download-btn\" style=\"background-color: #c0392b;\">\n                    <span class=\"btn-icon\">ğŸ“¥</span> ØªØ­Ù…ÙŠÙ„ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¯Ø§Ø¦Ù†\n                </button>\n                <label for=\"creditNoteExcelUploadInput\" class=\"action-button upload-btn\" style=\"background-color: #e67e22;\">\n                    <span class=\"btn-icon\">ğŸ“‚</span> Ø±ÙØ¹ Ù…Ù„Ù Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¯Ø§Ø¦Ù†\n                </label>\n                <input type=\"file\" id=\"creditNoteExcelUploadInput\" accept=\".xlsx, .xls\" style=\"display: none;\">\n            </div>\n        </div>\n\n        <!-- 4. Ù…Ù„Ø§Ø­Ø¸Ø§Øª ØªÙˆØ¶ÙŠØ­ÙŠØ© -->\n        <div id=\"creditNoteHelp\" class=\"help-notes\" style=\"margin-top: 20px;\">\n            <!-- Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù‡Ù†Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠÙ‹Ø§ -->\n        </div>\n    ";
      const tmp441 = document.getElementById("creditNoteTypeSelect");
      const tmp442 = document.getElementById("creditNoteHelp");
      function fn57() {
        if (tmp441.value === "with_reference") {
          tmp442.innerHTML = "\n                <h3 class=\"help-title\">Ù…Ù„Ø§Ø­Ø¸Ø© Ù‡Ø§Ù…Ø© (Ù„Ù„Ø±Ø¨Ø·)</h3>\n                <p>Ù„Ø±Ø¨Ø· Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø¨Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©ØŒ ÙŠØ¬Ø¨ ÙˆØ¶Ø¹ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ¹Ø±ÙŠÙÙŠ (UUID) Ù„Ù„ÙØ§ØªÙˆØ±Ø© ÙÙŠ Ø¹Ù…ÙˆØ¯ \"Ù…Ø±Ø¬Ø¹ Ø´Ø±Ø§Ø¡\" ÙÙŠ Ù…Ù„Ù Ø§Ù„Ø¥ÙƒØ³ÙŠÙ„. Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ø¥Ø¬Ø¨Ø§Ø±ÙŠ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø§Ù„Ø©.</p>\n            ";
        } else {
          tmp442.innerHTML = "\n                <h3 class=\"help-title\">Ù…Ù„Ø§Ø­Ø¸Ø© Ù‡Ø§Ù…Ø© (Ø¨Ø¯ÙˆÙ† Ø±Ø¨Ø·)</h3>\n                <p>ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ÙˆØ¶Ø¹ØŒ ÙŠÙ…ÙƒÙ†Ùƒ ØªØ±Ùƒ Ø¹Ù…ÙˆØ¯ \"Ù…Ø±Ø¬Ø¹ Ø´Ø±Ø§Ø¡\" ÙØ§Ø±ØºÙ‹Ø§. Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø¥Ø´Ø¹Ø§Ø± Ø¯Ø§Ø¦Ù† Ù…Ø³ØªÙ‚Ù„ ØºÙŠØ± Ù…Ø±ØªØ¨Ø· Ø¨ÙØ§ØªÙˆØ±Ø© Ø³Ø§Ø¨Ù‚Ø©.</p>\n            ";
        }
      }
      tmp441.addEventListener("change", fn57);
      document.getElementById("downloadCreditNoteTemplateBtn").addEventListener("click", fn58);
      document.getElementById("creditNoteExcelUploadInput").addEventListener("change", fn60);
      fn57();
    }
    async function fn58() {
      const tmpHex281f75 = fn69("Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¯Ø§Ø¦Ù† Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ...", 0);
      try {
        if (typeof ExcelJS === "undefined") {
          await fn11("exceljs.min.js");
        }
        const tmp443 = new ExcelJS.Workbook();
        const tmp444 = tmp443.addWorksheet("CreditNotes");
        const tmp445 = tmp443.addWorksheet("Lists");
        tmp445.getCell("A1").value = "ReceiverTypes";
        vA50.forEach((p210, p211) => {
          tmp445.getCell("A" + (p211 + 2)).value = p210.desc;
        });
        tmp445.getCell("B1").value = "CodeTypes";
        vA51.forEach((p212, p213) => {
          tmp445.getCell("B" + (p213 + 2)).value = p212.code;
        });
        tmp445.getCell("C1").value = "UnitTypes";
        vA53.forEach((p214, p215) => {
          tmp445.getCell("C" + (p215 + 2)).value = p214.desc_ar;
        });
        tmp445.getCell("D1").value = "Countries";
        vA52.forEach((p216, p217) => {
          tmp445.getCell("D" + (p217 + 2)).value = p216.Desc_ar;
        });
        tmp445.getCell("E1").value = "MainTaxTypes";
        Object.values(vO62).forEach((p218, p219) => {
          tmp445.getCell("E" + (p219 + 2)).value = p218.desc;
        });
        let vLN6 = 6;
        Object.values(vO62).forEach(p220 => {
          const tmp446 = tmp445.getCell(1, vLN6);
          const tmp447 = p220.desc.replace(/[ ()]/g, "_");
          tmp446.value = tmp447;
          p220.subtypes.forEach((p221, p222) => {
            tmp445.getCell(p222 + 2, vLN6).value = p221.desc;
          });
          const tmp448 = String.fromCharCode("A".charCodeAt(0) + vLN6 - 1);
          const tmp449 = "'Lists'!$" + tmp448 + "$2:$" + tmp448 + "$" + (p220.subtypes.length + 1);
          tmp443.definedNames.add(tmp449, tmp447);
          vLN6++;
        });
        const vA18 = ["Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ù„Ù„Ø¥Ø´Ø¹Ø§Ø± (*)", "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±", "Ù…Ø±Ø¬Ø¹ Ø´Ø±Ø§Ø¡ (*)", "Ø±Ù‚Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ„Ù… (*)", "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…", "Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªÙ„Ù… (*)", "Ø¯ÙˆÙ„Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù…", "Ù…Ø­Ø§ÙØ¸Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù…", "Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù…", "Ø´Ø§Ø±Ø¹ Ø§Ù„Ù…Ø³ØªÙ„Ù…", "Ù…Ø¨Ù†Ù‰ Ø§Ù„Ù…Ø³ØªÙ„Ù…", "ÙˆØµÙ Ø§Ù„ØµÙ†Ù (*)", "Ù†ÙˆØ¹ ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (*)", "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (*)", "ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ (*)", "Ø§Ù„ÙƒÙ…ÙŠØ© (*)", "Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø© (*)", "Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ…", "Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ…", "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 1 (*)", "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ 1 (*)", "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 1 (*)", "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 2", "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ 2", "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 2", "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 3", "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ 3", "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 3"];
        const vO30 = {
          "Ù…Ø±Ø¬Ø¹ Ø´Ø±Ø§Ø¡ (*)": "Ø¥Ø¬Ø¨Ø§Ø±ÙŠ: Ø¶Ø¹ Ù‡Ù†Ø§ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ¹Ø±ÙŠÙÙŠ (UUID) Ù„Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©.",
          "Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ…": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: Ø£Ø¯Ø®Ù„ Ù…Ø¨Ù„Øº Ø§Ù„Ø®ØµÙ… Ø¨Ø§Ù„Ø¬Ù†ÙŠÙ‡. Ø¥Ø°Ø§ ØªÙ… Ø¥Ø¯Ø®Ø§Ù„Ù‡ØŒ Ø³ÙŠØªÙ… ØªØ¬Ø§Ù‡Ù„ Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ….",
          "Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ…": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: Ø£Ø¯Ø®Ù„ Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ… (Ù…Ø«Ø§Ù„: 5 Ù„Ù€ 5%). Ø³ÙŠØªÙ… ØªØ¬Ø§Ù‡Ù„Ù‡ Ø¥Ø°Ø§ ØªÙ… Ø¥Ø¯Ø®Ø§Ù„ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ….",
          "Ù…Ø­Ø§ÙØ¸Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù…": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ØµØ­ÙŠØ­Ø§Ù‹.",
          "Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù…": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.",
          "Ø´Ø§Ø±Ø¹ Ø§Ù„Ù…Ø³ØªÙ„Ù…": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹.",
          "Ù…Ø¨Ù†Ù‰ Ø§Ù„Ù…Ø³ØªÙ„Ù…": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹."
        };
        tmp444.columns = vA18.map(p223 => ({
          header: p223,
          key: p223,
          width: 30
        }));
        tmp444.getRow(1).eachCell(p224 => {
          p224.note = vO30[p224.value] || vO55[p224.value.replace(" (*)", "")] || "";
          p224.font = {
            name: "Arial",
            bold: true,
            size: 12,
            color: {
              argb: "FFFFFFFF"
            }
          };
          p224.fill = {
            type: "pattern",
            pattern: "solid",
            fgColor: {
              argb: "FFD9534F"
            }
          };
          p224.alignment = {
            vertical: "middle",
            horizontal: "center"
          };
        });
        const vF15 = (p225, p226) => {
          for (let vLN23 = 2; vLN23 <= 1001; vLN23++) {
            tmp444.getCell("" + p225 + vLN23).dataValidation = {
              type: "list",
              allowBlank: true,
              formulae: [p226]
            };
          }
        };
        vF15("F", "=Lists!$A$2:$A$4");
        vF15("G", "=Lists!$D$2:$D$" + (vA52.length + 1));
        vF15("M", "=Lists!$B$2:$B$3");
        vF15("O", "=Lists!$C$2:$C$" + (vA53.length + 1));
        vF15("T", "=Lists!$E$2:$E$" + (Object.keys(vO62).length + 1));
        vF15("W", "=Lists!$E$2:$E$" + (Object.keys(vO62).length + 1));
        vF15("Z", "=Lists!$E$2:$E$" + (Object.keys(vO62).length + 1));
        const tmpLocalINDIRECTSUBSTITUTESU5 = "=INDIRECT(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(T2,\" \",\"_\"),\"(\",\"_\"),\")\",\"_\"))";
        const tmpLocalINDIRECTSUBSTITUTESU6 = "=INDIRECT(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(W2,\" \",\"_\"),\"(\",\"_\"),\")\",\"_\"))";
        const tmpLocalINDIRECTSUBSTITUTESU7 = "=INDIRECT(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(Z2,\" \",\"_\"),\"(\",\"_\"),\")\",\"_\"))";
        vF15("U", tmpLocalINDIRECTSUBSTITUTESU5);
        vF15("X", tmpLocalINDIRECTSUBSTITUTESU6);
        vF15("AA", tmpLocalINDIRECTSUBSTITUTESU7);
        tmp445.state = "hidden";
        tmp444.views = [{
          rightToLeft: true
        }];
        const tmp450 = await tmp443.xlsx.writeBuffer();
        const tmp451 = new Blob([tmp450], {
          type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
        });
        saveAs(tmp451, "Ù†Ù…ÙˆØ°Ø¬_Ø¥Ø´Ø¹Ø§Ø±_Ø¯Ø§Ø¦Ù†_Ø§Ø­ØªØ±Ø§ÙÙŠ_ÙƒØ§Ù…Ù„.xlsx");
      } catch (e23) {
        alert("ÙØ´Ù„ Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥ÙƒØ³ÙŠÙ„: " + e23.message);
      } finally {
        tmpHex281f75.remove();
      }
    }
    function fn59(p227, p228) {
      if (p227.length === 0) {
        return p228.length;
      }
      if (p228.length === 0) {
        return p227.length;
      }
      const tmp452 = Array(p228.length + 1).fill(null).map(() => Array(p227.length + 1).fill(null));
      for (let vLN020 = 0; vLN020 <= p227.length; vLN020++) {
        tmp452[0][vLN020] = vLN020;
      }
      for (let vLN021 = 0; vLN021 <= p228.length; vLN021++) {
        tmp452[vLN021][0] = vLN021;
      }
      for (let vLN13 = 1; vLN13 <= p228.length; vLN13++) {
        for (let vLN14 = 1; vLN14 <= p227.length; vLN14++) {
          const tmp453 = p227[vLN14 - 1] === p228[vLN13 - 1] ? 0 : 1;
          tmp452[vLN13][vLN14] = Math.min(tmp452[vLN13 - 1][vLN14] + 1, tmp452[vLN13][vLN14 - 1] + 1, tmp452[vLN13 - 1][vLN14 - 1] + tmp453);
        }
      }
      return tmp452[p228.length][p227.length];
    }
    async function fn60(p229) {
      const tmp454 = p229.target.files[0];
      if (!tmp454) {
        return;
      }
      const tmpHex3bc673 = fn64("Ø¬Ø§Ø±ÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù...");
      try {
        const tmp455 = new ExcelJS.Workbook();
        await tmp455.xlsx.load(await tmp454.arrayBuffer());
        const tmp456 = tmp455.getWorksheet(1);
        const tmp457 = tmp456.getRow(1).values.slice(1).map(p230 => String(p230 || "").trim());
        const vA19 = [];
        tmp456.eachRow({
          includeEmpty: false
        }, (p231, p232) => {
          if (p232 > 1) {
            const vO31 = {};
            p231.values.slice(1).forEach((p233, p234) => {
              const tmp458 = tmp457[p234];
              if (tmp458) {
                vO31[tmp458] = p233;
              }
            });
            vA19.push(vO31);
          }
        });
        if (vA19.length === 0) {
          throw new Error("Ù…Ù„Ù Ø§Ù„Ø¥ÙƒØ³ÙŠÙ„ ÙØ§Ø±Øº!");
        }
        const vO32 = {
          "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ù„Ù„Ø¥Ø´Ø¹Ø§Ø± (*)": "internalID",
          "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±": "dateTimeIssued",
          "Ù…Ø±Ø¬Ø¹ Ø´Ø±Ø§Ø¡ (*)": "references",
          "Ø±Ù‚Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ„Ù… (*)": "receiver_id",
          "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…": "receiver_name",
          "Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªÙ„Ù… (*)": "receiver_type",
          "Ø¯ÙˆÙ„Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù…": "receiver_country",
          "Ù…Ø­Ø§ÙØ¸Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù…": "receiver_governate",
          "Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù…": "receiver_city",
          "Ø´Ø§Ø±Ø¹ Ø§Ù„Ù…Ø³ØªÙ„Ù…": "receiver_street",
          "Ù…Ø¨Ù†Ù‰ Ø§Ù„Ù…Ø³ØªÙ„Ù…": "receiver_building",
          "ÙˆØµÙ Ø§Ù„ØµÙ†Ù (*)": "item_description",
          "Ù†ÙˆØ¹ ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (*)": "item_type",
          "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (*)": "item_code",
          "ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ (*)": "unit_type",
          "Ø§Ù„ÙƒÙ…ÙŠØ© (*)": "quantity",
          "Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø© (*)": "unit_price",
          "Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ…": "discount_rate",
          "Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ…": "discount_amount",
          "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 1 (*)": "tax_type_1",
          "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ 1 (*)": "tax_subtype_1",
          "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 1 (*)": "tax_rate_1",
          "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 2": "tax_type_2",
          "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ 2": "tax_subtype_2",
          "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 2": "tax_rate_2",
          "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 3": "tax_type_3",
          "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ 3": "tax_subtype_3",
          "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 3": "tax_rate_3"
        };
        const tmp459 = vA19.map(p235 => {
          const vO33 = {};
          for (const tmp460 in p235) {
            const tmp461 = vO32[tmp460.trim()];
            if (tmp461) {
              let tmp462 = p235[tmp460];
              if (vO63.units[tmp462]) {
                tmp462 = vO63.units[tmp462];
              } else if (vO63.taxTypes[tmp462]) {
                tmp462 = vO63.taxTypes[tmp462];
              } else if (vO63.taxSubtypes[tmp462]) {
                tmp462 = vO63.taxSubtypes[tmp462];
              } else if (vO63.receiverTypes[tmp462]) {
                tmp462 = vO63.receiverTypes[tmp462];
              }
              vO33[tmp461] = tmp462;
            }
          }
          return vO33;
        });
        const tmp463 = new Map();
        tmp459.forEach(p236 => {
          const tmp464 = p236.internalID;
          if (!tmp464) {
            return;
          }
          if (!tmp463.has(tmp464)) {
            tmp463.set(tmp464, []);
          }
          tmp463.get(tmp464).push(p236);
        });
        tmpHex3bc673.update("Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...");
        const {
          validatedMap: _0x464ccb,
          validationErrors: _0x112553
        } = await fn61(tmp463, tmpHex3bc673);
        tmpHex3bc673.success("Ø§ÙƒØªÙ…Ù„ Ø§Ù„ØªØ­Ù‚Ù‚!");
        if (_0x112553.length > 0) {
          fn122(_0x112553, () => {
            if (_0x464ccb.size > 0) {
              fn66(_0x464ccb);
            }
          });
        } else {
          fn66(_0x464ccb);
        }
      } catch (e24) {
        tmpHex3bc673.error("ÙØ´Ù„: " + e24.message);
      } finally {
        p229.target.value = "";
      }
    }
    async function fn61(p237, p238) {
      const vA20 = [];
      const tmp465 = new Map();
      const tmpHex57971a6 = getAccessTokenFromUserData();
      let vLN022 = 0;
      const tmp466 = p237.size;
      if (p238) {
        p238.update("Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª... (0 / " + tmp466 + ")", 0);
      }
      async function fn62(p239) {
        if (!p239 || String(p239).trim() === "") {
          return {
            valid: false,
            message: "Ø­Ù‚Ù„ UUID Ù„Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© Ø¥Ø¬Ø¨Ø§Ø±ÙŠ."
          };
        }
        const tmp467 = String(p239).trim();
        try {
          const tmp468 = "https://api-portal.invoicing.eta.gov.eg/api/v1/documents/search?Query=uuid%3A%22" + tmp467 + "%22&Status=Valid&Direction=sent&Page=1&PageSize=1";
          const tmp469 = await fetch(tmp468, {
            headers: {
              Authorization: "Bearer " + tmpHex57971a6
            }
          });
          if (!tmp469.ok) {
            return {
              valid: false,
              message: "Ø®Ø·Ø£ " + tmp469.status + " Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù… Ø¹Ù†Ø¯ Ø§Ù„Ø¨Ø­Ø«."
            };
          }
          const tmp470 = await tmp469.json();
          if (!tmp470.result || tmp470.result.length === 0) {
            return {
              valid: false,
              message: "Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø© Ø£Ùˆ ØºÙŠØ± ØµØ§Ù„Ø­Ø©."
            };
          }
          const tmp471 = "https://api-portal.invoicing.eta.gov.eg/api/v1/documents/" + tmp467 + "/raw";
          const tmp472 = await fetch(tmp471, {
            headers: {
              Authorization: "Bearer " + tmpHex57971a6
            }
          });
          if (!tmp472.ok) {
            return {
              valid: false,
              message: "ÙØ´Ù„ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø®Ø§Ù… (Status: " + tmp472.status + ")."
            };
          }
          const tmp473 = await tmp472.json();
          if (tmp473.document) {
            const tmp474 = JSON.parse(tmp473.document);
            const tmp475 = tmp474.taxpayerActivityCode;
            if (tmp475) {
              return {
                valid: true,
                activityCode: tmp475
              };
            }
          }
          return {
            valid: false,
            message: "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ÙƒÙˆØ¯ Ø§Ù„Ù†Ø´Ø§Ø· ÙÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©."
          };
        } catch (e25) {
          return {
            valid: false,
            message: "ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø´Ø¨ÙƒØ© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† UUID."
          };
        }
      }
      async function fn63(p240) {
        if (!p240 || p240.length !== 14 || !/^\d+$/.test(p240)) {
          return {
            valid: false,
            message: "ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªÙƒÙˆÙ† Ù…Ù† 14 Ø±Ù‚Ù…Ù‹Ø§."
          };
        }
        try {
          const tmp476 = await fetch("https://api-portal.invoicing.eta.gov.eg/api/v1/person/" + p240, {
            headers: {
              Authorization: "Bearer " + tmpHex57971a6
            }
          });
          if (tmp476.status === 200) {
            return {
              valid: true
            };
          }
          if (tmp476.status === 400) {
            return {
              valid: false,
              message: "Ø§Ù„Ø±Ù‚Ù… ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø£Ùˆ ØºÙŠØ± ØµØ­ÙŠØ­."
            };
          }
          return {
            valid: false,
            message: "Ø®Ø·Ø£ " + tmp476.status + " Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…."
          };
        } catch (e26) {
          return {
            valid: false,
            message: "ÙØ´Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù‚Ù…."
          };
        }
      }
      for (const [tmp477, tmp478] of p237.entries()) {
        const tmp479 = tmp478[0];
        let tmp480 = null;
        const tmp481 = document.getElementById("creditNoteTypeSelect").value;
        if (tmp481 === "with_reference") {
          const tmp482 = await fn62(tmp479.references);
          if (tmp482.valid) {
            tmp480 = tmp482.activityCode;
          } else {
            vA20.push({
              id: tmp477,
              field: "Ù…Ø±Ø¬Ø¹ Ø´Ø±Ø§Ø¡ (UUID)",
              value: tmp479.references,
              message: tmp482.message
            });
          }
        }
        const tmp483 = (tmp479.receiver_type || "").toUpperCase().trim();
        let tmp484 = (tmp479.receiver_id || "").toString().trim();
        let tmp485 = null;
        if (tmp483 === "P") {
          if (!tmp484) {
            tmp484 = "29507011000000";
            tmp479.receiver_id = tmp484;
          }
          if (!tmp479.receiver_name || String(tmp479.receiver_name).trim() === "") {
            tmp479.receiver_name = "Ø¹Ù…ÙŠÙ„ Ù†Ù‚Ø¯ÙŠ";
          }
          const tmp486 = await fn63(tmp484);
          if (!tmp486.valid) {
            vA20.push({
              id: tmp477,
              field: "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ù„Ù„Ù…Ø³ØªÙ„Ù…",
              value: tmp484,
              message: tmp486.message
            });
          }
        } else if (tmp483 === "B") {
          tmp485 = await fn73(tmp479.receiver_id);
          if (!tmp485) {
            vA20.push({
              id: tmp477,
              field: "Ø±Ù‚Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ„Ù…",
              value: tmp479.receiver_id,
              message: "Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ØºÙŠØ± ØµØ­ÙŠØ­ Ø£Ùˆ ØºÙŠØ± Ù…Ø³Ø¬Ù„."
            });
          }
        }
        const tmp487 = tmp478.map(async p241 => {
          const vO34 = {
            ...p241,
            officialCodeName: ""
          };
          if (tmp480) {
            vO34.originalActivityCode = tmp480;
          }
          if (tmp485) {
            vO34.receiver_name = tmp485.namePrimaryLang;
            const tmp488 = tmp485.taxpayerBranchs?.[0]?.address;
            if (tmp488) {
              vO34.receiver_governate = tmp488.governorateNameSecondaryLang || "";
              vO34.receiver_city = tmp488.cityNameSecondaryLang || "";
              vO34.receiver_street = tmp488.streetName || "";
              vO34.receiver_building = tmp488.buildingNo || "";
            }
          } else if (tmp483 === "P") {
            vO34.receiver_id = tmp479.receiver_id;
            vO34.receiver_name = tmp479.receiver_name;
          }
          const tmp489 = (p241.item_type || "").toUpperCase().trim();
          const tmp490 = (p241.item_code || "").toString().trim();
          if (tmp489 && tmp490) {
            let tmp491 = null;
            if (tmp489 === "EGS") {
              tmp491 = await fn92(tmp490);
            } else if (tmp489 === "GS1") {
              tmp491 = await fn93(tmp490);
            }
            const tmp492 = Array.isArray(tmp491) ? tmp491 : tmp491 ? [tmp491] : [];
            if (tmp492.length > 0) {
              const tmp493 = tmp492.find(p242 => p242.codeLookupValue.toUpperCase() === tmp490.toUpperCase());
              if (tmp493) {
                vO34.officialCodeName = tmp493.codeNameSecondaryLang || "!! Ø§Ø³Ù… Ø±Ø³Ù…ÙŠ ØºÙŠØ± Ù…Ø³Ø¬Ù„ !!";
              } else {
                vA20.push({
                  id: tmp477,
                  field: "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (" + tmp489 + ")",
                  value: tmp490,
                  message: "Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­ (Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªØ·Ø§Ø¨Ù‚ ØªØ§Ù…)."
                });
              }
            } else {
              vA20.push({
                id: tmp477,
                field: "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (" + tmp489 + ")",
                value: tmp490,
                message: "ÙØ´Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙƒÙˆØ¯ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…."
              });
            }
          } else {
            vA20.push({
              id: tmp477,
              field: "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù",
              value: "",
              message: "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù ÙˆÙ†ÙˆØ¹Ù‡ Ø­Ù‚ÙˆÙ„ Ø¥Ø¬Ø¨Ø§Ø±ÙŠØ©."
            });
          }
          return vO34;
        });
        const tmp494 = await Promise.all(tmp487);
        tmp465.set(tmp477, tmp494);
        if (p238) {
          vLN022++;
          p238.updateProgress(vLN022, tmp466);
        }
      }
      return {
        validatedMap: tmp465,
        validationErrors: vA20
      };
    }
    function fn64(p243) {
      document.getElementById("cn-nonblocking-progress")?.remove();
      const tmp495 = document.createElement("div");
      tmp495.id = "cn-nonblocking-progress";
      Object.assign(tmp495.style, {
        position: "fixed",
        bottom: "20px",
        right: "20px",
        width: "320px",
        backgroundColor: "#ffffff",
        color: "#333",
        borderRadius: "10px",
        boxShadow: "0 5px 20px rgba(0, 0, 0, 0.15)",
        zIndex: "20002",
        fontFamily: "'Cairo', 'Segoe UI', sans-serif",
        overflow: "hidden",
        opacity: "0",
        transform: "translateX(20px)",
        transition: "all 0.5s cubic-bezier(0.25, 0.8, 0.25, 1)"
      });
      tmp495.innerHTML = "\n        <div style=\"padding: 15px;\">\n            <div style=\"display: flex; align-items: center; gap: 12px; margin-bottom: 10px;\">\n                <div class=\"cn-progress-spinner\" style=\"width: 24px; height: 24px; border: 3px solid #e0e0e0; border-top-color: #007bff; border-radius: 50%; animation: spin 1s linear infinite; flex-shrink: 0;\"></div>\n                <span id=\"cn-progress-message\" style=\"font-size: 15px; font-weight: 600; color: #1d3557;\">" + p243 + "</span>\n            </div>\n            <div style=\"display: flex; justify-content: space-between; align-items: center; font-size: 13px; margin-bottom: 5px; color: #6c757d;\">\n                <span>Ø§Ù„ØªÙ‚Ø¯Ù…</span>\n                <span id=\"cn-progress-counter\" style=\"font-family: monospace; font-weight: bold;\">-</span>\n            </div>\n            <div style=\"background-color: #e9ecef; border-radius: 5px; overflow: hidden;\">\n                <div id=\"cn-progress-bar\" style=\"width: 0%; height: 8px; background-color: #007bff; transition: width 0.3s ease;\"></div>\n            </div>\n        </div>\n    ";
      document.body.appendChild(tmp495);
      setTimeout(() => {
        tmp495.style.opacity = "1";
        tmp495.style.transform = "translateX(0)";
      }, 10);
      let tmp496 = null;
      const vF16 = (p244 = 3000) => {
        tmp496 = setTimeout(() => {
          tmp495.style.opacity = "0";
          tmp495.style.transform = "translateX(20px)";
          setTimeout(() => tmp495.remove(), 500);
        }, p244);
      };
      tmp495.update = (p245, p246 = -1) => {
        clearTimeout(tmp496);
        tmp495.querySelector("#cn-progress-message").textContent = p245;
        if (p246 >= 0) {
          tmp495.querySelector("#cn-progress-bar").style.width = p246 + "%";
        }
      };
      tmp495.updateProgress = (p247, p248) => {
        const tmp497 = Math.round(p247 / p248 * 100);
        tmp495.update("Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª...", tmp497);
        tmp495.querySelector("#cn-progress-counter").textContent = p247 + " / " + p248;
      };
      tmp495.success = (p249, p250 = 3000) => {
        tmp495.querySelector(".cn-progress-spinner").style.display = "none";
        tmp495.querySelector("#cn-progress-bar").style.backgroundColor = "#28a745";
        tmp495.update(p249, 100);
        vF16(p250);
      };
      tmp495.error = (p251, p252 = 8000) => {
        tmp495.querySelector(".cn-progress-spinner").style.display = "none";
        tmp495.querySelector("#cn-progress-bar").style.backgroundColor = "#dc3545";
        tmp495.update(p251, 100);
        vF16(p252);
      };
      return tmp495;
    }
    function fn65(p253) {
      const tmp498 = document.createElement("div");
      tmp498.id = "creditNoteLoadingIndicator";
      tmp498.style.cssText = "\n        position: fixed; top: 0; left: 0; width: 100%; height: 100%; \n        background: rgba(0,0,0,0.75); color: white; \n        display: flex; flex-direction: column; align-items: center; justify-content: center; \n        z-index: 20002; font-family: 'Cairo', 'Segoe UI', sans-serif;\n        backdrop-filter: blur(5px);\n    ";
      tmp498.innerHTML = "\n        <div style=\"text-align: center;\">\n            <div id=\"cn-indicator-spinner\" style=\"width: 50px; height: 50px; border: 5px solid rgba(255, 255, 255, 0.3); border-top-color: #3498db; border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 20px;\"></div>\n            <p id=\"cn-indicator-message\" style=\"font-size: 20px; margin: 0;\">" + p253 + "</p>\n        </div>\n    ";
      tmp498.update = p254 => {
        const tmp499 = tmp498.querySelector("#cn-indicator-message");
        if (tmp499) {
          tmp499.textContent = p254;
        }
      };
      return tmp498;
    }
    async function fn66(p255) {
      document.getElementById("creditNoteEditorModal")?.remove();
      const tmp500 = document.createElement("div");
      tmp500.id = "creditNoteEditorModal";
      tmp500.style.cssText = "position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6); z-index: 10000; display: flex; align-items: center; justify-content: center; direction: rtl; font-family: 'Segoe UI', Tahoma, sans-serif;";
      const tmp501 = document.createElement("div");
      tmp501.style.cssText = "background-color: #fff; width: 95%; height: 90%; border-radius: 12px; display: flex; flex-direction: column; box-shadow: 0 5px 25px rgba(0,0,0,0.2); overflow: hidden;";
      const tmp502 = await fetchTaxpayerInfo();
      const tmp503 = tmp502 && tmp502.activities && tmp502.activities.length > 0 ? "\n        <div class=\"details-card-cn\" style=\"padding: 10px 15px;\">\n            <label for=\"activity-select-editor-cn\" style=\"font-weight: bold; margin-bottom: 5px; display: block;\">Ø§Ø®ØªØ± ÙƒÙˆØ¯ Ø§Ù„Ù†Ø´Ø§Ø·:</label>\n            <select id=\"activity-select-editor-cn\" style=\"width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #ccc;\">\n                " + tmp502.activities.map(p256 => "<option value=\"" + p256.activityTypeCode + "\" " + (p256.activityTypeCode === tmp502.taxpayerActivityCode ? "selected" : "") + ">" + p256.activityTypeCode + " - " + p256.activityTypeNameSecondaryLang + "</option>").join("") + "\n            </select>\n        </div>" : "<div class=\"details-card-cn\" style=\"padding: 10px 15px;\">ÙƒÙˆØ¯ Ø§Ù„Ù†Ø´Ø§Ø·: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£Ù†Ø´Ø·Ø©.</div>";
      let tmpLocal8 = "";
      p255.forEach((p257, p258) => {
        const tmp504 = p257[0];
        tmpLocal8 += "\n           <tbody class=\"credit-note-group\" data-internal-id=\"" + p258 + "\">\n                <tr class=\"credit-note-header-row\">\n                    <td class=\"toggle-details-cn\" style=\"font-weight: bold; font-size: 20px; text-align: center; cursor: pointer;\">+</td>\n                    <td><span contenteditable=\"true\" data-field=\"internalID\">" + p258 + "</span></td>\n                    <td><span contenteditable=\"true\" data-field=\"references\">" + (tmp504.references || "") + "</span></td>\n                    <td><span contenteditable=\"true\" data-field=\"receiver_id\">" + (tmp504.receiver_id || "") + "</span></td>\n                    <td><span contenteditable=\"true\" data-field=\"receiver_name\">" + (tmp504.receiver_name || "") + "</span></td>\n                    <td><button class=\"delete-cn-btn\">&times;</button></td>\n                </tr>\n                <tr class=\"credit-note-details-row\" style=\"display: none;\">\n                    <td colspan=\"6\">\n                        <div class=\"details-wrapper-cn\">\n                            <div class=\"details-grid-cn\">\n                                <div class=\"details-card-cn\">\n                                    <h4 class=\"details-header-cn\">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØµØ¯Ø± (Ø§Ù„Ø¨Ø§Ø¦Ø¹)</h4>\n                                    <table class=\"issuer-details-table-cn details-table-cn\">\n                                        <tbody>\n                                            <tr><th>Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„</th><td data-issuer-field=\"id\">" + tmp502.id + "</td></tr>\n                                            <tr><th>Ø§Ø³Ù… Ø§Ù„Ù…ØµØ¯Ø±</th><td data-issuer-field=\"name\">" + tmp502.name + "</td></tr>\n                                            <tr><th>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</th><td data-issuer-field=\"governate\">" + tmp502.governate + "</td></tr>\n                                            <tr><th>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</th><td data-issuer-field=\"regionCity\">" + tmp502.regionCity + "</td></tr>\n                                            <tr><th>Ø§Ù„Ø´Ø§Ø±Ø¹</th><td data-issuer-field=\"street\">" + tmp502.street + "</td></tr>\n                                            <tr><th>Ø§Ù„Ù…Ø¨Ù†Ù‰</th><td data-issuer-field=\"buildingNumber\">" + tmp502.buildingNumber + "</td></tr>\n                                                    <tr><th>ÙƒÙˆØ¯ Ø§Ù„Ù†Ø´Ø§Ø·</th><td data-issuer-field=\"taxpayerActivityCode\">" + (tmp504.originalActivityCode || "N/A") + "</td></tr>\n\n                                        </tbody>\n                                    </table>\n                                </div>\n                                <div class=\"details-card-cn\">\n                                    <h4 class=\"details-header-cn\">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙ„Ù… (Ø§Ù„Ù…Ø´ØªØ±ÙŠ)</h4>\n                                    <table class=\"receiver-details-table-cn details-table-cn\">\n                                        <tbody>\n                                            <tr><th>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªÙ„Ù…</th><td contenteditable=\"true\" data-receiver-field=\"receiver_type\">" + (tmp504.receiver_type || "B") + "</td></tr>\n                                            <tr><th>Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„</th><td contenteditable=\"true\" data-receiver-field=\"receiver_id\">" + (tmp504.receiver_id || "") + "</td></tr>\n                                            <tr><th>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…</th><td contenteditable=\"true\" data-receiver-field=\"receiver_name\">" + (tmp504.receiver_name || "") + "</td></tr>\n                                            <tr><th>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</th><td contenteditable=\"true\" data-receiver-field=\"receiver_governate\">" + (tmp504.receiver_governate || "") + "</td></tr>\n                                            <tr><th>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</th><td contenteditable=\"true\" data-receiver-field=\"receiver_city\">" + (tmp504.receiver_city || "") + "</td></tr>\n                                            <tr><th>Ø§Ù„Ø´Ø§Ø±Ø¹</th><td contenteditable=\"true\" data-receiver-field=\"receiver_street\">" + (tmp504.receiver_street || "") + "</td></tr>\n                                            <tr><th>Ø§Ù„Ù…Ø¨Ù†Ù‰</th><td contenteditable=\"true\" data-receiver-field=\"receiver_building\">" + (tmp504.receiver_building || "") + "</td></tr>\n                                        </tbody>\n                                    </table>\n                                </div>\n                            </div>\n                            <div class=\"items-card-cn\">\n                                <h4 class=\"details-header-cn\">Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¯Ø§Ø¦Ù†</h4>\n                                <div style=\"overflow-x: auto;\">\n                        <table class=\"items-table-cn\">\n    <thead>\n        <tr>\n            <th>ÙˆØµÙ Ø§Ù„ØµÙ†Ù</th><th>ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù</th><th>Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø±Ø³Ù…ÙŠ</th><th>Ø§Ù„ÙƒÙ…ÙŠØ©</th><th>Ø§Ù„Ø³Ø¹Ø±</th>\n            <!-- âœ…âœ…âœ… Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¥Ø¶Ø§ÙØ© 2: Ø¥Ø¶Ø§ÙØ© Ø±Ø¤ÙˆØ³ Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø®ØµÙ… --- -->\n            <th>Ø®ØµÙ… (%)</th>\n            <th>Ø®ØµÙ… (Ù‚ÙŠÙ…Ø©)</th>\n            <!-- âœ…âœ…âœ… Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¥Ø¶Ø§ÙØ© 2 --- -->\n            <th>Ø¶Ø±ÙŠØ¨Ø© 1</th><th>Ø¶Ø±ÙŠØ¨Ø© 2</th>\n        </tr>\n    </thead>\n    <tbody>\n    " + p257.map(p259 => "\n        <tr>\n            <td contenteditable=\"true\" data-field=\"item_description\">" + p259.item_description + "</td>\n            <td contenteditable=\"true\" data-field=\"item_code\">" + p259.item_code + "</td>\n            <td style=\"background-color: #f0f8ff;\">" + (p259.officialCodeName || "") + "</td>\n            <td contenteditable=\"true\" data-field=\"quantity\">" + p259.quantity + "</td>\n            <td contenteditable=\"true\" data-field=\"unit_price\">" + p259.unit_price + "</td>\n            <!-- âœ…âœ…âœ… Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¥Ø¶Ø§ÙØ© 3: Ø¥Ø¶Ø§ÙØ© Ø®Ù„Ø§ÙŠØ§ Ø§Ù„Ø®ØµÙ… --- -->\n            <td contenteditable=\"true\" data-field=\"discount_rate\">" + (p259.discount_rate || "") + "</td>\n            <td contenteditable=\"true\" data-field=\"discount_amount\">" + (p259.discount_amount || "") + "</td>\n            <!-- âœ…âœ…âœ… Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¥Ø¶Ø§ÙØ© 3 --- -->\n            <td><span contenteditable=\"true\" data-field=\"tax_type_1\">" + (p259.tax_type_1 || "") + "</span>/...</td>\n            <td><span contenteditable=\"true\" data-field=\"tax_type_2\">" + (p259.tax_type_2 || "") + "</span>/...</td>\n        </tr>\n    ").join("") + "\n    </tbody>\n</table>\n\n                                </div>\n                            </div>\n                        </div>\n                    </td>\n                </tr>\n            </tbody>\n        ";
      });
      tmp501.innerHTML = "\n        <div style=\"padding: 15px 25px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; background-color: #fffbe6;\">\n            <h3 style=\"margin: 0; color: #c0392b;\">Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ­ÙØ¸ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¯Ø§Ø¦Ù†Ø©</h3>\n            <div>\n                <button id=\"saveCreditNotesBtn_CN\" style=\"background-color: #28a745; color: white; padding: 10px 25px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold;\">Ø­ÙØ¸ ÙƒÙ…Ø³ÙˆØ¯Ø©</button>\n                <button id=\"closeCreditNoteEditorBtn_CN\" style=\"background-color: #6c757d; color: white; padding: 10px 25px; border: none; border-radius: 8px; cursor: pointer; margin-right: 10px;\">Ø¥ØºÙ„Ø§Ù‚</button>\n            </div>\n        </div>\n        <div style=\"padding: 10px 25px; background-color: #e9ecef;\">" + tmp503 + "</div>\n        <div style=\"overflow-y: auto; flex-grow: 1;\">\n            <table class=\"main-cn-table\">\n                <thead>\n                    <tr style=\"background-color: #c0392b; color: white; position: sticky; top: 0; z-index: 10;\">\n                        <th></th><th>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ</th><th>UUID Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©</th><th>Ø±Ù‚Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ„Ù…</th><th>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…</th><th>Ø­Ø°Ù</th>\n                    </tr>\n                </thead>\n                " + tmpLocal8 + "\n            </table>\n        </div>\n    ";
      tmp500.appendChild(tmp501);
      document.body.appendChild(tmp500);
      const tmpLocalmaincntableWidth100B = "\n        .main-cn-table { width: 100%; border-collapse: collapse; }\n        .credit-note-header-row { background-color: #fff1f1; border-bottom: 2px solid #ffbaba; }\n        .credit-note-header-row td { padding: 12px; vertical-align: middle; text-align: center; }\n        .credit-note-header-row td span { background-color: #fff; padding: 5px; border-radius: 4px; border: 1px dashed #ccc; min-width: 150px; display: inline-block; }\n        .details-wrapper-cn { padding: 20px; background-color: #f9f9f9; border-top: 3px solid #c0392b; }\n        .details-grid-cn { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }\n        .details-card-cn { background: #fff; border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; }\n        .details-header-cn { color: #c0392b; border-bottom: 2px solid #eee; padding-bottom: 8px; margin-top: 0; margin-bottom: 15px; font-size: 18px; }\n        .details-table-cn { width: 100%; } .details-table-cn th, .details-table-cn td { padding: 8px; text-align: right; border-bottom: 1px solid #f5f5f5; } .details-table-cn tr:last-child td { border-bottom: none; } .details-table-cn th { font-weight: 600; width: 120px; }\n        .items-card-cn { grid-column: 1 / -1; }\n        .items-table-cn { width: 100%; border-collapse: collapse; } .items-table-cn th, .items-table-cn td { border: 1px solid #dee2e6; padding: 8px; text-align: center; } .items-table-cn th { background-color: #e9ecef; }\n        .delete-cn-btn { background: #dc3545; color: white; border: none; border-radius: 5px; cursor: pointer; padding: 4px 8px; }\n    ";
      const tmp505 = document.createElement("style");
      tmp505.innerText = tmpLocalmaincntableWidth100B;
      document.head.appendChild(tmp505);
      document.getElementById("closeCreditNoteEditorBtn_CN").onclick = () => tmp500.remove();
      document.getElementById("saveCreditNotesBtn_CN").onclick = () => fn67(p255);
      tmp500.querySelectorAll(".toggle-details-cn").forEach(p260 => {
        p260.onclick = p261 => {
          const tmp506 = p261.target.parentElement.nextElementSibling;
          const tmp507 = tmp506.style.display !== "none";
          tmp506.style.display = tmp507 ? "none" : "table-row";
          p261.target.textContent = tmp507 ? "+" : "-";
        };
      });
      tmp500.querySelectorAll(".delete-cn-btn").forEach(p262 => {
        p262.onclick = p263 => {
          p263.target.closest(".credit-note-group").remove();
        };
      });
    }
    async function fn67(p264) {
      const tmp508 = document.getElementById("saveCreditNotesBtn_CN");
      tmp508.disabled = true;
      tmp508.textContent = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...";
      const tmp509 = await fetchTaxpayerInfo();
      if (!tmp509) {
        alert("ÙØ´Ù„ Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØµØ¯Ø± (Ø§Ù„Ø¨Ø§Ø¦Ø¹). Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©.");
        tmp508.disabled = false;
        tmp508.textContent = "Ø­ÙØ¸ ÙƒÙ…Ø³ÙˆØ¯Ø©";
        return;
      }
      const tmp510 = document.getElementById("activity-select-editor-cn")?.value || tmp509.taxpayerActivityCode;
      tmp509.taxpayerActivityCode = tmp510;
      const vA21 = [];
      for (const [tmp511, tmp512] of p264.entries()) {
        const tmp513 = document.querySelector(".credit-note-group[data-internal-id=\"" + tmp511 + "\"]");
        if (!tmp513) {
          continue;
        }
        const tmpHex1b6af1 = fn68(tmp512, tmp509);
        const vV512 = tmp512;
        vA21.push({
          payload: tmpHex1b6af1,
          rawLines: vV512
        });
      }
      let vLN023 = 0;
      const vA22 = [];
      for (const tmp514 of vA21) {
        const tmp515 = tmp514.payload.document.internalID;
        try {
          const tmpHex1b6af12 = fn68(tmp514.rawLines, tmp509, true);
          const tmp516 = await fn111(tmpHex1b6af12);
          if (!tmp516.success) {
            throw new Error(tmp516.error);
          }
          const tmp517 = tmp516.data.draftId;
          const tmp518 = await fn106(tmp517, tmp514.payload, tmp514.rawLines);
          if (!tmp518.success) {
            await fn105(tmp517);
            throw new Error("ÙØ´Ù„ ÙÙŠ Ø¬Ø¹Ù„ Ø§Ù„Ù…Ø³ÙˆØ¯Ø© Ø¬Ø§Ù‡Ø²Ø©: " + tmp518.error);
          }
          vLN023++;
          tmp508.textContent = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸ (" + vLN023 + " / " + vA21.length + ")...";
        } catch (e27) {
          vA22.push({
            id: tmp515,
            field: "Ø®Ø·Ø£ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…",
            value: "ÙØ´Ù„ Ø§Ù„Ø­ÙØ¸",
            message: e27.message
          });
        }
      }
      tmp508.disabled = false;
      tmp508.textContent = "Ø­ÙØ¸ ÙƒÙ…Ø³ÙˆØ¯Ø©";
      if (vA22.length > 0) {
        fn122(vA22);
      }
      if (vLN023 > 0) {
        fn110("Ø§ÙƒØªÙ…Ù„Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­!", "ØªÙ… Ø­ÙØ¸ " + vLN023 + " Ø¥Ø´Ø¹Ø§Ø± Ø¯Ø§Ø¦Ù† Ø¨Ù†Ø¬Ø§Ø­ ÙƒÙ…Ø³ÙˆØ¯Ø§Øª Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø¥Ø±Ø³Ø§Ù„.");
        document.getElementById("creditNoteEditorModal")?.remove();
      }
    }
    function fn68(p265, p266) {
      const tmp519 = p265[0];
      const tmp520 = document.getElementById("creditNoteVersionSelect")?.value || "1.0";
      const tmp521 = document.getElementById("creditNoteTypeSelect").value;
      const tmp522 = tmp520 === "0.9";
      const tmp523 = tmp522 ? ["CreditNote"] : tmp521 === "with_reference" ? ["CreditNote", "SignatureRequired"] : ["SimpleCreditWithoutRef", "SignatureRequired"];
      const tmp524 = tmp522 ? [] : [{
        signatureType: "I",
        value: "VGVtcG9yYXJ5IFNpZ25hdHVyZSBIb2xkZXI="
      }];
      const vF17 = p267 => {
        const vO35 = {};
        for (const tmp525 in p267) {
          vO35[tmp525] = p267[tmp525] !== null && p267[tmp525] !== undefined ? String(p267[tmp525]) : "";
        }
        return vO35;
      };
      let vLN024 = 0;
      let vLN025 = 0;
      const tmp526 = new Map();
      const tmp527 = p265.map(p268 => {
        const vVF17 = vF17(p268);
        const vParseFloat13 = parseFloat((parseFloat(vVF17.quantity) || 0).toFixed(5));
        const vParseFloat14 = parseFloat((parseFloat(vVF17.unit_price) || 0).toFixed(5));
        const vParseFloat15 = parseFloat((vParseFloat13 * vParseFloat14).toFixed(5));
        vLN024 += vParseFloat15;
        const tmp528 = parseFloat(vVF17.discount_amount) || vParseFloat15 * (parseFloat(vVF17.discount_rate) || 0) / 100;
        vLN025 += tmp528;
        const vParseFloat16 = parseFloat((vParseFloat15 - tmp528).toFixed(5));
        const vA23 = [];
        let vLN026 = 0;
        for (let vLN16 = 1; vLN16 <= 2; vLN16++) {
          const tmp529 = vVF17["tax_type_" + vLN16]?.trim().toUpperCase();
          const tmp530 = vVF17["tax_rate_" + vLN16];
          if (tmp529 && tmp530 && !isNaN(parseFloat(tmp530))) {
            const vParseFloat17 = parseFloat(tmp530);
            const vParseFloat18 = parseFloat((vParseFloat16 * (vParseFloat17 / 100)).toFixed(5));
            const tmp531 = vVF17["tax_subtype_" + vLN16]?.trim() || vO64[tmp529] || "";
            vA23.push({
              taxType: tmp529,
              amount: vParseFloat18,
              subType: tmp531,
              rate: vParseFloat17
            });
            vLN026 += tmp529 === "T4" ? -vParseFloat18 : vParseFloat18;
            tmp526.set(tmp529, (tmp526.get(tmp529) || 0) + vParseFloat18);
          }
        }
        const vParseFloat19 = parseFloat((vParseFloat16 + vLN026).toFixed(5));
        return {
          description: fn120(vVF17.item_description, 100),
          itemType: vVF17.item_type,
          itemCode: vVF17.item_code,
          unitType: vVF17.unit_type,
          quantity: vParseFloat13,
          unitValue: {
            currencySold: "EGP",
            amountEGP: vParseFloat14
          },
          salesTotal: vParseFloat15,
          netTotal: vParseFloat16,
          total: vParseFloat19,
          taxableItems: vA23,
          internalCode: fn120(vVF17.item_internal_code || vVF17.item_code, 50),
          discount: {
            amount: tmp528
          },
          valueDifference: 0,
          totalTaxableFees: 0,
          itemsDiscount: 0
        };
      });
      const tmp532 = Array.from(tmp526, ([tmp533, tmp534]) => ({
        taxType: tmp533,
        amount: parseFloat(tmp534.toFixed(5))
      }));
      const vParseFloat20 = parseFloat(tmp527.reduce((p269, p270) => p269 + p270.total, 0).toFixed(5));
      const vO36 = {
        issuer: {
          type: "B",
          id: String(p266.id),
          name: fn120(p266.name),
          address: {
            branchID: "0",
            country: "EG",
            governate: fn120(p266.governate),
            regionCity: fn120(p266.regionCity),
            street: fn120(p266.street),
            buildingNumber: String(p266.buildingNumber || "")
          }
        },
        receiver: {
          type: String(tmp519.receiver_type || "B"),
          id: String(tmp519.receiver_id),
          name: fn120(tmp519.receiver_name),
          address: {
            country: "EG",
            governate: fn120(tmp519.receiver_governate),
            regionCity: fn120(tmp519.receiver_city),
            street: fn120(tmp519.receiver_street),
            buildingNumber: String(tmp519.receiver_building || "")
          }
        },
        documentType: "C",
        documentTypeVersion: tmp520,
        dateTimeIssued: fn4(tmp519.dateTimeIssued),
        taxpayerActivityCode: String(tmp519.originalActivityCode || p266.taxpayerActivityCode),
        internalID: String(tmp519.internalID),
        invoiceLines: tmp527,
        totalSalesAmount: parseFloat(vLN024.toFixed(5)),
        totalDiscountAmount: parseFloat(vLN025.toFixed(5)),
        netAmount: parseFloat((vLN024 - vLN025).toFixed(5)),
        taxTotals: tmp532,
        totalAmount: vParseFloat20,
        signatures: tmp524,
        payment: {},
        delivery: {},
        totalItemsDiscountAmount: 0,
        extraDiscountAmount: 0
      };
      if (tmp521 === "with_reference" && tmp519.references) {
        vO36.references = [String(tmp519.references)];
      }
      return {
        tags: tmp523,
        document: vO36,
        clientsidevalidationresult: true,
        lineItemCodes: p265.map(p271 => ({
          codeType: p271.item_type,
          itemCode: p271.item_code,
          codeNamePrimaryLang: p271.officialCodeName || p271.item_description,
          codeNameSecondaryLang: p271.officialCodeName || p271.item_description
        }))
      };
    }
    function fn69(p272, p273 = 4000) {
      document.getElementById("eta-toast-notification")?.remove();
      const tmp535 = document.createElement("div");
      tmp535.id = "eta-toast-notification";
      Object.assign(tmp535.style, {
        position: "fixed",
        bottom: "20px",
        left: "20px",
        backgroundColor: "#34495e",
        color: "white",
        padding: "16px 24px",
        borderRadius: "10px",
        boxShadow: "0 5px 20px rgba(0, 0, 0, 0.25)",
        zIndex: "20001",
        display: "flex",
        alignItems: "center",
        gap: "15px",
        fontFamily: "'Cairo', 'Segoe UI', sans-serif",
        fontSize: "16px",
        opacity: "0",
        transform: "translateY(20px)",
        transition: "all 0.5s cubic-bezier(0.25, 0.8, 0.25, 1)",
        maxWidth: "400px"
      });
      tmp535.innerHTML = "\n        <div class=\"toast-spinner\" style=\"width: 22px; height: 22px; border: 3px solid rgba(255, 255, 255, 0.3); border-top-color: #3498db; border-radius: 50%; animation: spin 1s linear infinite; flex-shrink: 0;\"></div>\n        <div id=\"toast-message-content\" style=\"line-height: 1.5;\">" + p272 + "</div>\n    ";
      const tmp536 = document.createElement("style");
      tmp536.innerText = "@keyframes spin { to { transform: rotate(360deg); } }";
      document.head.appendChild(tmp536);
      document.body.appendChild(tmp535);
      setTimeout(() => {
        tmp535.style.opacity = "1";
        tmp535.style.transform = "translateY(0)";
      }, 10);
      let tmp537 = null;
      if (p273 > 0) {
        tmp537 = setTimeout(() => tmp535.remove(), p273);
      }
      tmp535.update = (p274, p275 = p273) => {
        const tmp538 = tmp535.querySelector("#toast-message-content");
        if (tmp538) {
          tmp538.innerHTML = p274;
        }
        clearTimeout(tmp537);
        if (p275 > 0) {
          tmp537 = setTimeout(() => tmp535.remove(), p275);
        }
      };
      tmp535.updateProgress = (p276, p277) => {
        const tmp539 = Math.round(p276 / p277 * 100);
        tmp535.update("Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸... (" + p276 + " / " + p277 + ") - " + tmp539 + "%");
      };
      tmp535.success = (p278, p279 = 3000) => {
        tmp535.querySelector(".toast-spinner").style.display = "none";
        tmp535.style.backgroundColor = "#27ae60";
        tmp535.update("âœ… " + p278, p279);
      };
      tmp535.error = (p280, p281 = 5000) => {
        tmp535.querySelector(".toast-spinner").style.display = "none";
        tmp535.style.backgroundColor = "#c0392b";
        tmp535.update("âŒ " + p280, p281);
      };
      tmp535.removeToast = () => {
        tmp535.style.opacity = "0";
        tmp535.style.transform = "translateY(20px)";
        setTimeout(() => {
          tmp535.remove();
          tmp536.remove();
        }, 500);
      };
      return tmp535;
    }
    async function fn70() {
      const tmp540 = document.getElementById("panel-drafts");
      if (tmp540) {
        tmp540.innerHTML = "\n            <div class=\"panel-header\">\n                <h2>Ø¹Ø±Ø¶ ÙˆØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø³ÙˆØ¯Ø§Øª</h2>\n                <p>Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø¹Ø±Ø¶ ÙƒÙ„ Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø© ÙƒÙ…Ø³ÙˆØ¯Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØµØ© ÙˆØªØ¹Ø¯ÙŠÙ„Ù‡Ø§.</p>\n            </div>\n            <div class=\"panel-body\" style=\"text-align: center;\">\n                <button id=\"showDraftsBtn\" class=\"action-button drafts-btn-main\">\n                    <span class=\"btn-icon\">ğŸ”</span> Ø¹Ø±Ø¶ ÙƒÙ„ Ø§Ù„Ù…Ø³ÙˆØ¯Ø§Øª Ø§Ù„Ø¢Ù†\n                </button>\n            </div>\n        ";
        document.getElementById("showDraftsBtn").addEventListener("click", fn78);
      }
      fn56();
      const tmp541 = document.getElementById("panel-taxpayer-query");
      if (tmp541) {
        tmp541.innerHTML = "\n            <div class=\"panel-header\">\n                <h2>Ù…Ø³ØªÙƒØ´Ù Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù…ÙˆÙ„ÙŠÙ†</h2>\n                <p>ÙˆØ§Ø¬Ù‡Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ© Ù„Ø¹Ø±Ø¶ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù…ÙˆÙ„ÙŠÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ† Ø¨Ø§Ù„Ù…Ù†Ø¸ÙˆÙ…Ø©.</p>\n            </div>\n            <div class=\"query-container\">\n                <input type=\"text\" id=\"taxpayerQueryInput\" placeholder=\"Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù‡Ù†Ø§...\">\n                <button id=\"taxpayerQueryBtn\">Ø¨Ø­Ø«</button>\n            </div>\n            <div id=\"queryResultContainer\">\n                <div class=\"query-placeholder\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\"><path d=\"M18.031 16.6168L22.3137 20.8995L20.8995 22.3137L16.6168 18.031C15.0769 19.263 13.125 20 11 20C6.02944 20 2 15.9706 2 11C2 6.02944 6.02944 2 11 2C15.9706 2 20 6.02944 20 11C20 13.125 19.263 15.0769 18.031 16.6168ZM16.0247 15.8748C17.2475 14.6146 18 12.8956 18 11C18 7.13401 14.866 4 11 4C7.13401 4 4 7.13401 4 11C4 14.866 7.13401 18 11 18C12.8956 18 14.6146 17.2475 15.8748 16.0247L16.0247 15.8748Z\"></path></svg>\n                    Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… ØªØ³Ø¬ÙŠÙ„ Ù„Ù„Ø¨Ø¯Ø¡...\n                </div>\n            </div>\n        ";
        const tmp542 = document.getElementById("taxpayerQueryBtn");
        const tmp543 = document.getElementById("taxpayerQueryInput");
        const tmp544 = document.getElementById("queryResultContainer");
        tmp542.addEventListener("click", async () => {
          const tmp545 = tmp543.value.trim();
          if (!tmp545) {
            alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… ØªØ³Ø¬ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹.");
            return;
          }
          tmp544.innerHTML = "<div class=\"query-placeholder\">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø«...</div>";
          const tmp546 = await fn73(tmp545);
          if (tmp546) {
            let tmp547 = "<div class=\"profile-card\"><div class=\"card-header\"><span class=\"icon\">ğŸ‘¤</span><h3>Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ Ù„Ù„Ù…Ù…ÙˆÙ„</h3></div><div class=\"card-body\">" + renderInfoFieldHtml("ğŸ†”", tmp546.registrationNumber, true) + renderInfoFieldHtml("ğŸ¢", tmp546.namePrimaryLang) + renderInfoFieldHtml("âœ‰ï¸", tmp546.email, true) + renderInfoFieldHtml("ğŸš¦", tmp546.isActive ? "Ù†Ø´Ø·" : "ØºÙŠØ± Ù†Ø´Ø·", false, true) + "</div></div>";
            if (tmp546.taxpayerBranchs && tmp546.taxpayerBranchs.length > 0) {
              tmp546.taxpayerBranchs.forEach((p282, p283) => {
                const tmp548 = p282.address || {};
                tmp547 += "<div class=\"branch-card\"><div class=\"card-header\"><span class=\"icon\">ğŸ“</span><h3>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ±Ø¹ " + (p283 + 1) + " (Ø±Ù‚Ù…: " + p282.branchNumber + ")</h3></div><div class=\"card-body\">" + renderInfoFieldHtml("ğŸ›ï¸", tmp548.governorateNameSecondaryLang) + renderInfoFieldHtml("ğŸ™ï¸", tmp548.cityNameSecondaryLang) + renderInfoFieldHtml("ğŸ›£ï¸", tmp548.streetName) + renderInfoFieldHtml("ğŸ”¢", tmp548.buildingNo) + "</div></div>";
                if (p282.taxpayerActivities && p282.taxpayerActivities.length > 0) {
                  p282.taxpayerActivities.forEach(p284 => {
                    tmp547 += "<div class=\"activity-card\"><div class=\"card-header\"><span class=\"icon\">ğŸ’¼</span><h3>Ù†Ø´Ø§Ø· Ù…Ø³Ø¬Ù„ (ÙƒÙˆØ¯: " + p284.activityTypeCode + ")</h3></div><div class=\"card-body\">" + renderInfoFieldHtml("ğŸ“", p284.activityTypeNameSecondaryLang) + renderInfoFieldHtml("ğŸ“…", "ÙŠØ¨Ø¯Ø£ ÙÙŠ: " + new Date(p284.fromDate).toLocaleDateString("ar-EG")) + renderInfoFieldHtml("ğŸ", p284.toDate ? "ÙŠÙ†ØªÙ‡ÙŠ ÙÙŠ: " + new Date(p284.toDate).toLocaleDateString("ar-EG") : "Ø§Ù„Ø­Ø§Ù„Ø©: Ø³Ø§Ø±ÙŠ") + "</div></div>";
                  });
                }
              });
            }
            tmp544.innerHTML = tmp547;
          } else {
            tmp544.innerHTML = "<div class=\"query-placeholder\">ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø±Ù‚Ù…: " + tmp545 + ". ØªØ£ÙƒØ¯ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø±Ù‚Ù….</div>";
          }
        });
      }
      fn104();
    }
    if (p209) {
      fn70();
      fn71(document.getElementById("panel-create"));
      setTimeout(() => tmp438.querySelector(".sidebar-btn[data-target=\"panel-create\"]")?.click(), 100);
    } else {
      fn17(document.getElementById("panel-subscription"));
      setTimeout(() => tmp438.querySelector(".sidebar-btn[data-target=\"panel-subscription\"]")?.click(), 100);
    }
    document.getElementById("closeInvoiceCreatorBtn").addEventListener("click", () => tmp438.remove());
    fn79(tmp438, tmp438.querySelector(".sidebar"));
    const tmp549 = tmp438.querySelectorAll(".sidebar-btn");
    const tmp550 = tmp438.querySelectorAll(".panel-content");
    const tmp551 = document.getElementById("info-sidebar");
    tmp549.forEach(p285 => {
      p285.addEventListener("click", async () => {
        const tmp552 = p285.getAttribute("data-target");
        const vA24 = ["panel-create", "panel-credit-note"];
        if (vA24.includes(tmp552)) {
          const tmp553 = await verifyEtaSubscriptionOrPrompt();
          if (!tmp553) {
            fn2();
            return;
          }
        }
        tmp549.forEach(p286 => p286.classList.remove("active"));
        tmp550.forEach(p287 => p287.classList.remove("active"));
        p285.classList.add("active");
        const tmp554 = document.getElementById(tmp552);
        tmp554.classList.add("active");
        if (tmp552 === "panel-create" && tmp554.innerHTML.trim() === "") {
          console.log("Building 'Create Invoice' tab content now...");
          fn71(tmp554);
        }
        const vA25 = ["panel-create", "panel-drafts"];
        tmp551.style.display = vA25.includes(tmp552) ? "flex" : "none";
      });
    });
    function fn71(p288) {
      if (!p288) {
        return;
      }
      p288.innerHTML = "\n        <div class=\"panel-header\"><h2>Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù…Ù† Ù…Ù„Ù Excel</h2><p>Ø§ØªØ¨Ø¹ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙØ§ØªÙˆØ±Ø© ÙˆØ§Ø­Ø¯Ø© Ø£Ùˆ Ø£ÙƒØ«Ø± Ø¨Ø³Ø±Ø¹Ø©.</p></div>\n        <div class=\"content-step\"><label class=\"content-label\">Ø§Ù„Ø®Ø·ÙˆØ© 1: Ø§Ø®ØªØ± Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ø³ØªÙ†Ø¯</label><select id=\"invoiceVersionSelect\" class=\"content-select\"><option value=\"1.0\" selected>Ø¥ØµØ¯Ø§Ø± 1.0 (Ù…Ø³ØªÙ†Ø¯ Ù†Ù‡Ø§Ø¦ÙŠ ÙˆÙ…ÙˆÙ‚Ø¹)</option><option value=\"0.9\">Ø¥ØµØ¯Ø§Ø± 0.9 (Ù…Ø³ÙˆØ¯Ø© ØºÙŠØ± Ù…ÙˆÙ‚Ø¹Ø©)</option></select></div>\n        <div class=\"content-step\"><label class=\"content-label\">Ø§Ù„Ø®Ø·ÙˆØ© 2: Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„ÙØ§ØªÙˆØ±Ø©</label><div id=\"invoiceTypeSelector\" class=\"button-group\" style=\"justify-content: center;\"><button class=\"action-button invoice-type-btn active\" data-type=\"FullInvoice\" style=\"background-color: #3b82f6;\">ÙØ§ØªÙˆØ±Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© (ÙƒØ§Ù…Ù„Ø©)</button><button class=\"action-button invoice-type-btn\" data-type=\"SimpleInvoice\" style=\"background-color: #6b7280;\">ÙØ§ØªÙˆØ±Ø© Ø¨Ø³ÙŠØ·Ø©</button></div><p style=\"font-size: 13px; color: #555; text-align: center; margin-top: 8px;\">Ø§Ø®ØªØ± \"ÙƒØ§Ù…Ù„Ø©\" Ù„ØªØ¶Ù…ÙŠÙ† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø±Ø§Ø¡ ÙˆØ§Ù„Ø¨Ù†ÙƒØŒ Ø£Ùˆ \"Ø¨Ø³ÙŠØ·Ø©\" Ù„Ù„ÙÙˆØ§ØªÙŠØ± Ø§Ù„Ø³Ø±ÙŠØ¹Ø©.</p></div>\n        <div class=\"content-step\">\n            <label class=\"content-label\">Ø§Ù„Ø®Ø·ÙˆØ© 3: ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ÙˆØ±ÙØ¹ Ø§Ù„Ù…Ù„Ù</label>\n            <div class=\"button-group\">\n                <button id=\"dynamicDownloadTemplateBtn\" class=\"action-button download-btn\">\n                    <span class=\"btn-icon\">ğŸ“¥</span> ØªØ­Ù…ÙŠÙ„ Ù†Ù…ÙˆØ°Ø¬ Excel Ø§Ù„Ø°ÙƒÙŠ\n                </button>\n                <label for=\"excelUploadInput\" class=\"action-button upload-btn\">\n                    <span class=\"btn-icon\">ğŸ“‚</span> Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©\n                </label>\n                <input type=\"file\" id=\"excelUploadInput\" accept=\".xlsx, .xls\" style=\"display: none;\">\n            </div>\n        </div>\n    ";
      document.getElementById("dynamicDownloadTemplateBtn").addEventListener("click", fn119);
      document.getElementById("excelUploadInput").addEventListener("change", handleExcelFileUpload);
      document.querySelectorAll(".invoice-type-btn").forEach(p289 => {
        p289.addEventListener("click", function () {
          document.querySelectorAll(".invoice-type-btn").forEach(p290 => {
            p290.classList.remove("active");
            p290.style.backgroundColor = "#6b7280";
          });
          this.classList.add("active");
          this.style.backgroundColor = "#3b82f6";
        });
      });
    }
    (async function fn72() {
      const tmp555 = tmp438.querySelector("#taxpayer-info-box .card-body");
      try {
        const tmp556 = await fetchTaxpayerInfo();
        if (tmp556) {
          tmp555.innerHTML = "<p><strong>Ø§Ù„Ø§Ø³Ù…:</strong> " + (tmp556.name || "ØºÙŠØ± Ù…ØªÙˆÙØ±") + "</p><p><strong>Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„:</strong> " + (tmp556.id || "ØºÙŠØ± Ù…ØªÙˆÙØ±") + "</p><p><strong>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</strong> " + (tmp556.street || "") + ", " + (tmp556.regionCity || "") + "</p>";
        } else {
          throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù…ÙˆÙ„.");
        }
      } catch (e28) {
        tmp555.innerHTML = "<p style=\"color: red;\">ÙØ´Ù„ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª: " + e28.message + "</p>";
      }
    })();
    fn104();
    setTimeout(() => {
      const tmp557 = document.querySelector(".sidebar-btn");
      if (tmp557) {
        tmp557.click();
      }
    }, 50);
  }
  async function fn73(p291) {
    const tmpHex57971a7 = getAccessTokenFromUserData();
    if (!tmpHex57971a7) {
      return null;
    }
    const tmp558 = String(p291 || "").trim();
    if (!tmp558) {
      return null;
    }
    const tmp559 = "https://api-portal.invoicing.eta.gov.eg/api/v1/taxpayers/" + tmp558 + "/light";
    try {
      const tmp560 = await fetch(tmp559, {
        headers: {
          Authorization: "Bearer " + tmpHex57971a7,
          Accept: "application/json"
        }
      });
      if (tmp560.ok) {
        const tmp561 = await tmp560.json();
        if (tmp561.error) {
          return null;
        }
        const tmp562 = tmpLocalAr === "ar";
        if (tmp562 && tmp561.nameSecondaryLang) {
          tmp561.namePrimaryLang = tmp561.nameSecondaryLang;
          if (tmp561.taxpayerBranchs && tmp561.taxpayerBranchs[0]?.address) {
            tmp561.taxpayerBranchs[0].address.governorateNamePrimaryLang = tmp561.taxpayerBranchs[0].address.governorateNameSecondaryLang;
            tmp561.taxpayerBranchs[0].address.cityNamePrimaryLang = tmp561.taxpayerBranchs[0].address.cityNameSecondaryLang;
          }
        }
        return tmp561;
      }
      return null;
    } catch (e29) {
      return null;
    }
  }
  function fn74(p292, p293 = 0) {
    const tmp563 = document.getElementById("non-blocking-toast");
    if (tmp563) {
      tmp563.remove();
    }
    const tmp564 = document.createElement("div");
    tmp564.id = "non-blocking-toast";
    Object.assign(tmp564.style, {
      position: "fixed",
      bottom: "20px",
      left: "20px",
      backgroundColor: "#2c3e50",
      color: "white",
      padding: "15px 25px",
      borderRadius: "8px",
      boxShadow: "0 4px 15px rgba(0, 0, 0, 0.2)",
      zIndex: "10006",
      display: "flex",
      alignItems: "center",
      gap: "15px",
      fontFamily: "'Cairo', 'Segoe UI', sans-serif",
      fontSize: "16px",
      opacity: "0",
      transform: "translateY(20px)",
      transition: "opacity 0.4s ease, transform 0.4s ease"
    });
    tmp564.innerHTML = "\n        <div class=\"toast-spinner\" style=\"\n            width: 20px; \n            height: 20px; \n            border: 3px solid rgba(255, 255, 255, 0.3); \n            border-top-color: #3498db; \n            border-radius: 50%; \n            animation: spin 1s linear infinite;\n        \"></div>\n        <span id=\"toast-message\">" + p292 + "</span>\n    ";
    const tmp565 = document.createElement("style");
    tmp565.innerText = "@keyframes spin { to { transform: rotate(360deg); } }";
    document.head.appendChild(tmp565);
    document.body.appendChild(tmp564);
    setTimeout(() => {
      tmp564.style.opacity = "1";
      tmp564.style.transform = "translateY(0)";
    }, 10);
    if (p293 > 0) {
      setTimeout(() => {
        tmp564.style.opacity = "0";
        tmp564.style.transform = "translateY(20px)";
        setTimeout(() => tmp564.remove(), 400);
      }, p293);
    }
    return tmp564;
  }
  async function fn75() {
    const tmpHex57971a8 = getAccessTokenFromUserData();
    if (!tmpHex57971a8) {
      alert("Ø®Ø·Ø£: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªÙˆÙƒÙ† Ø§Ù„Ø¯Ø®ÙˆÙ„. ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹.");
      return null;
    }
    try {
      const tmp566 = await fetch("https://api-portal.invoicing.eta.gov.eg/api/v1/documents/drafts?OrderBy=lastModificationDateTimeUtc", {
        headers: {
          Authorization: "Bearer " + tmpHex57971a8,
          Accept: "application/json"
        }
      });
      if (!tmp566.ok) {
        throw new Error("ÙØ´Ù„ Ø¬Ù„Ø¨ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ÙˆØ¯Ø§Øª. Ø±Ù…Ø² Ø§Ù„Ø­Ø§Ù„Ø©: " + tmp566.status);
      }
      const tmp567 = await tmp566.json();
      return tmp567.result;
    } catch (e30) {
      alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø³ÙˆØ¯Ø§Øª: " + e30.message);
      return null;
    }
  }
  async function fn76(p294) {
    const tmpHex57971a9 = getAccessTokenFromUserData();
    if (!tmpHex57971a9) {
      return null;
    }
    try {
      const tmp568 = await fetch("https://api-portal.invoicing.eta.gov.eg/api/v1/documents/drafts/" + p294, {
        headers: {
          Authorization: "Bearer " + tmpHex57971a9
        }
      });
      if (!tmp568.ok) {
        return null;
      }
      return await tmp568.json();
    } catch (e31) {
      return null;
    }
  }
  function fn107(p295) {
    const tmp569 = p295.document;
    if (!tmp569) {
      return [];
    }
    const vO37 = {
      internalID: tmp569.internalID,
      receiver_id: tmp569.receiver.id,
      receiver_name: tmp569.receiver.name,
      receiver_type: tmp569.receiver.type,
      receiver_country: tmp569.receiver.address?.country,
      receiver_governate: tmp569.receiver.address?.governate,
      receiver_city: tmp569.receiver.address?.regionCity,
      receiver_street: tmp569.receiver.address?.street,
      receiver_building: tmp569.receiver.address?.buildingNumber,
      purchaseOrderReference: tmp569.purchaseOrderReference,
      purchaseOrderDescription: tmp569.purchaseOrderDescription,
      salesOrderReference: tmp569.salesOrderReference,
      salesOrderDescription: tmp569.salesOrderDescription,
      bankName: tmp569.payment?.bankName,
      bankAccountNo: tmp569.payment?.bankAccountNo,
      deliveryApproach: tmp569.delivery?.approach,
      deliveryPackaging: tmp569.delivery?.packaging
    };
    return tmp569.invoiceLines.map(p296 => {
      const vO38 = {
        ...vO37,
        item_description: p296.description,
        item_type: p296.itemType,
        item_code: p296.itemCode,
        item_internal_code: p296.internalCode,
        unit_type: p296.unitType,
        quantity: p296.quantity,
        unit_price: p296.unitValue.amountEGP,
        currency_sold: p296.unitValue.currencySold,
        exchange_rate: p296.unitValue.currencyExchangeRate,
        discount_rate: p296.discount?.rate,
        discount_amount: p296.discount?.amount
      };
      p296.taxableItems.forEach((p297, p298) => {
        if (p298 < 3) {
          vO38["tax_type_" + (p298 + 1)] = p297.taxType;
          vO38["tax_subtype_" + (p298 + 1)] = p297.subType;
          vO38["tax_rate_" + (p298 + 1)] = p297.rate;
        }
      });
      return vO38;
    });
  }
  async function fn78() {
    const tmp570 = await fn75();
    if (!tmp570 || tmp570.length === 0) {
      alert("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£ÙŠ ÙÙˆØ§ØªÙŠØ± ÙÙŠ Ø§Ù„Ù…Ø³ÙˆØ¯Ø§Øª.");
      return;
    }
    const tmp571 = document.createElement("div");
    tmp571.id = "draftsLoadingIndicator";
    tmp571.style.cssText = "position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); color: white; display: flex; align-items: center; justify-content: center; z-index: 10005; font-size: 24px;";
    tmp571.textContent = "Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ ØªÙØ§ØµÙŠÙ„ " + tmp570.length + " Ù…Ø³ÙˆØ¯Ø©...";
    document.body.appendChild(tmp571);
    const tmp572 = tmp570.map(p299 => fn76(p299.id));
    const tmp573 = await Promise.all(tmp572);
    let vA26 = [];
    for (const tmp574 of tmp573) {
      if (tmp574) {
        const vF77 = fn107(tmp574);
        vA26.push(...vF77);
      }
    }
    tmp571.remove();
    if (vA26.length === 0) {
      alert("ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø³ÙˆØ¯Ø§Øª Ø£Ùˆ Ø£Ù†Ù‡Ø§ ÙØ§Ø±ØºØ©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.");
      return;
    }
    fn100(vA26);
  }
  function fn79(p300, p301) {
    let vLN027 = 0;
    let vLN028 = 0;
    let vLN029 = 0;
    let vLN030 = 0;
    let tmp575 = true;
    (p301 || p300).onmousedown = fn80;
    function fn80(p302) {
      p302 = p302 || window.event;
      p302.preventDefault();
      vLN029 = p302.clientX;
      vLN030 = p302.clientY;
      if (tmp575) {
        const tmp576 = p300.getBoundingClientRect();
        p300.style.top = tmp576.top + "px";
        p300.style.left = tmp576.left + "px";
        p300.style.transform = "none";
        tmp575 = false;
      }
      document.onmouseup = fn82;
      document.onmousemove = fn81;
    }
    function fn81(p303) {
      p303 = p303 || window.event;
      p303.preventDefault();
      vLN027 = vLN029 - p303.clientX;
      vLN028 = vLN030 - p303.clientY;
      vLN029 = p303.clientX;
      vLN030 = p303.clientY;
      p300.style.top = p300.offsetTop - vLN028 + "px";
      p300.style.left = p300.offsetLeft - vLN027 + "px";
    }
    function fn82() {
      document.onmouseup = null;
      document.onmousemove = null;
    }
  }
  function getAccessTokenFromUserData() {
    try {
      const tmp577 = JSON.parse(localStorage.getItem("USER_DATA") || sessionStorage.getItem("USER_DATA") || "{}");
      return tmp577?.access_token || null;
    } catch {
      return null;
    }
  }
  async function handleExcelFileUpload(p304) {
    const tmp578 = p304.target.files[0];
    if (!tmp578) {
      return;
    }
    const vF74 = fn74("Ø¬Ø§Ø±ÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù ÙˆØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...");
    const tmp579 = new FileReader();
    tmp579.onload = async function (p305) {
      try {
        const tmp580 = new ExcelJS.Workbook();
        await tmp580.xlsx.load(p305.target.result);
        const tmp581 = tmp580.getWorksheet(1);
        const vA27 = [];
        tmp581.eachRow({
          includeEmpty: false
        }, (p306, p307) => {
          if (p307 > 1) {
            const tmp582 = p306.values.slice(1);
            const tmp583 = tmp582.map(p308 => p308 instanceof Date ? new Date(Date.UTC(p308.getFullYear(), p308.getMonth(), p308.getDate())) : p308);
            vA27.push(tmp583);
          }
        });
        if (vA27.length === 0) {
          throw new Error("Ø§Ù„Ù…Ù„Ù ÙØ§Ø±Øº Ø£Ùˆ Ù„Ø§ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª.");
        }
        const tmp584 = vA27.map(p309 => {
          const vA28 = [...p309];
          if (vA28[5] && vO63.receiverTypes[vA28[5]]) {
            vA28[5] = vO63.receiverTypes[vA28[5]];
          }
          if (vA28[6] && vO63.countries[vA28[6]]) {
            vA28[6] = vO63.countries[vA28[6]];
          }
          if (vA28[18] && vO63.currencies[vA28[18]]) {
            vA28[18] = vO63.currencies[vA28[18]];
          }
          if (vA28[15] && vO63.units[vA28[15]]) {
            vA28[15] = vO63.units[vA28[15]];
          }
          const vA29 = [{
            main: 22,
            sub: 23
          }, {
            main: 25,
            sub: 26
          }, {
            main: 28,
            sub: 29
          }];
          vA29.forEach(p310 => {
            const tmp585 = vA28[p310.main];
            const tmp586 = vA28[p310.sub];
            if (tmp585 && vO63.taxTypes[tmp585]) {
              vA28[p310.main] = vO63.taxTypes[tmp585];
            }
            if (tmp586 && vO63.taxSubtypes[tmp586]) {
              vA28[p310.sub] = vO63.taxSubtypes[tmp586];
            }
          });
          return vA28;
        });
        const tmpHex2d6384 = fn91(tmp584);
        vF74.querySelector("#toast-message").textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...";
        const {
          validatedData: _0x65e72d,
          validationErrors: _0x582360
        } = await fn85(tmpHex2d6384);
        fn94(_0x65e72d, _0x582360);
      } catch (e32) {
        alert("âŒ Ø®Ø·Ø£ ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„Ù: " + e32.message);
      } finally {
        vF74.remove();
        p304.target.value = "";
      }
    };
    tmp579.readAsArrayBuffer(tmp578);
  }
  async function fn85(p311) {
    const vA30 = [];
    const vA31 = [...p311];
    async function fn86(p312) {
      if (!p312 || p312.length !== 14 || !/^\d+$/.test(p312)) {
        return {
          valid: false,
          message: "ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªÙƒÙˆÙ† Ù…Ù† 14 Ø±Ù‚Ù…Ù‹Ø§ ØµØ­ÙŠØ­Ù‹Ø§."
        };
      }
      try {
        const vF83 = getAccessTokenFromUserData();
        if (!vF83) {
          return {
            valid: false,
            message: "Ø®Ø·Ø£ Ù…ØµØ§Ø¯Ù‚Ø©ØŒ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ­Ù‚Ù‚."
          };
        }
        const tmp587 = await fetch("https://api-portal.invoicing.eta.gov.eg/api/v1/person/" + p312, {
          headers: {
            Authorization: "Bearer " + vF83
          }
        });
        if (tmp587.status === 200) {
          const tmp588 = await tmp587.json();
          const tmp589 = ((tmp588.firstName || "") + " " + (tmp588.otherNames || "")).trim();
          return {
            valid: true,
            name: tmp589 || "Unnamed Person"
          };
        } else if (tmp587.status === 400) {
          const tmp590 = await tmp587.json();
          return {
            valid: false,
            message: tmp590.error?.details[0]?.message || "Ø±Ù‚Ù… Ù‚ÙˆÙ…ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­."
          };
        } else {
          return {
            valid: false,
            message: "Ø®Ø·Ø£ " + tmp587.status + " Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…."
          };
        }
      } catch (e33) {
        return {
          valid: false,
          message: "ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø´Ø¨ÙƒØ© Ù„Ù„ØªØ­Ù‚Ù‚."
        };
      }
    }
    async function fn87(p313) {
      const vF832 = getAccessTokenFromUserData();
      if (!vF832) {
        return null;
      }
      const tmp591 = String(p313 || "").trim();
      if (!tmp591) {
        return null;
      }
      const tmp592 = "https://api-portal.invoicing.eta.gov.eg/api/v1/taxpayers/" + tmp591 + "/light";
      try {
        const tmp593 = await fetch(tmp592, {
          headers: {
            Authorization: "Bearer " + vF832,
            Accept: "application/json"
          }
        });
        if (tmp593.ok) {
          const tmp594 = await tmp593.json();
          if (tmp594.error) {
            return null;
          }
          const tmp595 = tmpLocalAr === "ar";
          if (tmp595 && tmp594.nameSecondaryLang) {
            tmp594.namePrimaryLang = tmp594.nameSecondaryLang;
            if (tmp594.taxpayerBranchs && tmp594.taxpayerBranchs[0]?.address) {
              tmp594.taxpayerBranchs[0].address.governorateNamePrimaryLang = tmp594.taxpayerBranchs[0].address.governorateNameSecondaryLang;
              tmp594.taxpayerBranchs[0].address.cityNamePrimaryLang = tmp594.taxpayerBranchs[0].address.cityNameSecondaryLang;
            }
          }
          return tmp594;
        }
        return null;
      } catch (e34) {
        return null;
      }
    }
    async function fn88(p314) {
      const vF833 = getAccessTokenFromUserData();
      if (!vF833) {
        return null;
      }
      const tmp596 = String(p314 || "").trim().toUpperCase();
      if (!tmp596 || !tmp596.startsWith("EG-")) {
        return null;
      }
      const tmp597 = "https://api-portal.invoicing.eta.gov.eg/api/v1/codetypes/codes/my?CodeTypeID=9&ItemCode=" + tmp596 + "&Ps=100";
      try {
        const tmp598 = await fetch(tmp597, {
          headers: {
            Authorization: "Bearer " + vF833
          }
        });
        if (!tmp598.ok) {
          return null;
        }
        const tmp599 = await tmp598.json();
        return tmp599.result || [];
      } catch (e35) {
        return null;
      }
    }
    async function fn89(p315) {
      const vF834 = getAccessTokenFromUserData();
      if (!vF834) {
        return [];
      }
      const tmp600 = "https://api-portal.invoicing.eta.gov.eg/api/v1/codetypes/2/codes?CodeLookupValue=" + p315 + "&ApplyMinChoiceLevel=true&Ps=100";
      for (let vLN17 = 1; vLN17 <= 3; vLN17++) {
        try {
          const tmp601 = await fetch(tmp600, {
            headers: {
              Authorization: "Bearer " + vF834
            }
          });
          if (tmp601.ok) {
            const tmp602 = await tmp601.json();
            if (tmp602.result && tmp602.result.length > 0) {
              const tmp603 = tmpLocalAr === "ar";
              tmp602.result.forEach(p316 => {
                if (tmp603 && p316.codeNameSecondaryLang) {
                  p316.codeNamePrimaryLang = p316.codeNameSecondaryLang;
                }
              });
              return tmp602.result;
            }
          } else {}
        } catch (e36) {}
        if (vLN17 < 3) {
          await new Promise(p317 => setTimeout(p317, 1000));
        }
      }
      return [];
    }
    const tmp604 = new Map();
    vA31.forEach(p318 => {
      const tmp605 = String(p318[12] || "").toUpperCase().trim();
      const tmp606 = String(p318[13] || "").trim();
      if ((tmp605 === "EGS" || tmp605 === "GS1") && tmp606) {
        const tmp607 = tmp605 + "_" + tmp606;
        if (!tmp604.has(tmp607)) {
          tmp604.set(tmp607, {
            type: tmp605,
            code: tmp606,
            result: null
          });
        }
      }
    });
    if (tmp604.size > 0) {
      const vLN102 = 10;
      const tmp608 = Array.from(tmp604.values());
      for (let vLN031 = 0; vLN031 < tmp608.length; vLN031 += vLN102) {
        const tmp609 = tmp608.slice(vLN031, vLN031 + vLN102);
        const tmp610 = tmp609.map(p319 => p319.type === "EGS" ? fn88(p319.code) : fn89(p319.code));
        const tmp611 = await Promise.all(tmp610);
        tmp611.forEach((p320, p321) => {
          const tmp612 = tmp609[p321];
          const tmp613 = tmp612.type + "_" + tmp612.code;
          if (tmp604.has(tmp613)) {
            tmp604.get(tmp613).result = p320;
          }
        });
        await new Promise(p322 => setTimeout(p322, 50));
      }
    }
    const tmp614 = vA31.map(async (p323, p324) => {
      if (p323.length < 40) {
        p323[39] = "";
      }
      const tmp615 = p323[0] || "ØµÙ " + (p324 + 2);
      const tmp616 = String(p323[5] || "").toUpperCase().trim();
      let tmp617 = String(p323[3] || "").trim();
      if (tmp616 === "P") {
        if (!tmp617) {
          p323[3] = "27001071000000";
          if (!p323[4] || String(p323[4]).trim() === "") {
            p323[4] = "Ø¹Ù…ÙŠÙ„ Ù†Ù‚Ø¯ÙŠ";
          }
        } else {
          const tmp618 = await fn86(tmp617);
          if (!tmp618.valid) {
            vA30.push({
              id: tmp615,
              field: "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ù„Ù„Ù…Ø³ØªÙ„Ù…",
              value: tmp617,
              message: tmp618.message
            });
          }
        }
      } else if (tmp616 === "B") {
        if (!tmp617) {
          vA30.push({
            id: tmp615,
            field: "Ø±Ù‚Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ„Ù…",
            value: "ÙØ§Ø±Øº",
            message: "Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ø¥Ø¬Ø¨Ø§Ø±ÙŠ Ù„Ù„Ø´Ø±ÙƒØ§Øª."
          });
        } else {
          const tmp619 = await fn87(tmp617);
          if (tmp619) {
            p323[4] = tmp619.namePrimaryLang;
            const tmp620 = tmp619.taxpayerBranchs?.[0]?.address;
            if (tmp620) {
              if (!p323[6] || String(p323[6]).trim() === "") {
                p323[6] = tmp620.countryCode || "EG";
              }
              if (!p323[7] || String(p323[7]).trim() === "") {
                p323[7] = tmp620.governorateNameSecondaryLang || tmp620.governorate || "";
              }
              if (!p323[8] || String(p323[8]).trim() === "") {
                p323[8] = tmp620.cityNameSecondaryLang || tmp620.regionCity || "";
              }
              if (!p323[9] || String(p323[9]).trim() === "") {
                p323[9] = tmp620.streetName || tmp620.street || "";
              }
              if (!p323[10] || String(p323[10]).trim() === "") {
                p323[10] = tmp620.buildingNo || tmp620.buildingNumber || "";
              }
            }
          } else {
            vA30.push({
              id: tmp615,
              field: "Ø±Ù‚Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ„Ù…",
              value: tmp617,
              message: "Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ØºÙŠØ± ØµØ­ÙŠØ­ Ø£Ùˆ ØºÙŠØ± Ù…Ø³Ø¬Ù„."
            });
          }
        }
      }
      const tmp621 = String(p323[12] || "").toUpperCase().trim();
      const tmp622 = String(p323[13] || "").trim();
      let tmpLocal9 = "";
      if (tmp621 && tmp622) {
        const tmp623 = tmp621 + "_" + tmp622;
        const tmp624 = tmp604.get(tmp623)?.result;
        if (tmp624 && Array.isArray(tmp624)) {
          const tmp625 = tmp624.find(p325 => p325.codeLookupValue.toUpperCase() === tmp622.toUpperCase());
          if (tmp625) {
            const tmp626 = new Date();
            tmp626.setHours(0, 0, 0, 0);
            const tmp627 = tmp625.activeTo ? new Date(tmp625.activeTo) : null;
            if (tmp627) {
              tmp627.setHours(0, 0, 0, 0);
            }
            if (tmp625.active === false) {
              vA30.push({
                id: tmp615,
                field: "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (" + tmp621 + ")",
                value: tmp622,
                message: "Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± Ù†Ø´Ø· Ø­Ø§Ù„ÙŠØ§Ù‹ (active: false)."
              });
            } else if (tmp627 && tmp627 < tmp626) {
              vA30.push({
                id: tmp615,
                field: "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (" + tmp621 + ")",
                value: tmp622,
                message: "Ø§Ù„ÙƒÙˆØ¯ Ù…Ù†ØªÙ‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© Ù…Ù†Ø° ØªØ§Ø±ÙŠØ® " + tmp627.toLocaleDateString("ar-EG") + "."
              });
            } else {
              tmpLocal9 = tmp625.codeNamePrimaryLang;
              p323[39] = tmpLocal9 || "!! Ø§Ø³Ù… Ø±Ø³Ù…ÙŠ ØºÙŠØ± Ù…Ø³Ø¬Ù„ !!";
            }
          } else {
            vA30.push({
              id: tmp615,
              field: "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (" + tmp621 + ")",
              value: tmp622,
              message: "Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­ Ø£Ùˆ ØºÙŠØ± Ù…Ø³Ø¬Ù„ (Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªØ·Ø§Ø¨Ù‚ ØªØ§Ù…)."
            });
          }
        } else {
          vA30.push({
            id: tmp615,
            field: "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (" + tmp621 + ")",
            value: tmp622,
            message: "ÙØ´Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙƒÙˆØ¯ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…."
          });
        }
      }
    });
    await Promise.all(tmp614);
    return {
      validatedData: vA31,
      validationErrors: vA30
    };
  }
  function fn90(p326) {
    const tmp628 = document.createElement("div");
    tmp628.id = "globalLoadingIndicator";
    tmp628.style.cssText = "\n        position: fixed; top: 0; left: 0; width: 100%; height: 100%; \n        background: rgba(0,0,0,0.7); color: white; \n        display: flex; align-items: center; justify-content: center; \n        z-index: 10005; font-size: 22px; font-family: 'Segoe UI', Tahoma, sans-serif;\n        text-align: center; padding: 20px;\n    ";
    tmp628.textContent = p326;
    return tmp628;
  }
  function fn91(p327) {
    let vA32 = [];
    const vLN9 = 9;
    const vLN92 = 9;
    const vLN11 = 11;
    const tmp629 = p327.map((p328, p329) => {
      const tmp630 = p328[vLN92] !== undefined && p328[vLN92] !== null && String(p328[vLN92]).trim() !== "";
      const tmp631 = p328[vLN11] !== undefined && p328[vLN11] !== null && String(p328[vLN11]).trim() !== "";
      if (!tmp630 && !tmp631) {
        return null;
      }
      const tmp632 = p328[0] !== undefined && p328[0] !== null && String(p328[0]).trim() !== "";
      if (tmp632) {
        vA32 = p328.slice(0, vLN9);
        return p328;
      } else {
        if (vA32.length === 0) {
          return null;
        }
        const vA33 = [...vA32];
        for (let vVLN9 = vLN9; vVLN9 < p328.length; vVLN9++) {
          vA33[vVLN9] = p328[vVLN9];
        }
        return vA33;
      }
    }).filter(p330 => p330 !== null);
    return tmp629;
  }
  async function fn92(p331) {
    const vF835 = getAccessTokenFromUserData();
    if (!vF835) {
      return null;
    }
    const tmp633 = String(p331 || "").trim().toUpperCase();
    if (!tmp633 || !tmp633.startsWith("EG-")) {
      return null;
    }
    const tmp634 = "https://api-portal.invoicing.eta.gov.eg/api/v1/codetypes/codes/my?CodeTypeID=9&ItemCode=" + tmp633 + "&Ps=10000";
    try {
      const tmp635 = await fetch(tmp634, {
        headers: {
          Authorization: "Bearer " + vF835
        }
      });
      if (!tmp635.ok) {
        return null;
      }
      const tmp636 = await tmp635.json();
      if (tmp636.result && tmp636.result.length > 0) {
        return tmp636.result;
      }
      return [];
    } catch (e37) {
      return null;
    }
  }
  async function fn93(p332) {
    const vF836 = getAccessTokenFromUserData();
    if (!vF836) {
      return null;
    }
    const tmp637 = "https://api-portal.invoicing.eta.gov.eg/api/v1/codetypes/2/codes?CodeLookupValue=" + p332 + "&ApplyMinChoiceLevel=true&Ps=1";
    try {
      const tmp638 = await fetch(tmp637, {
        headers: {
          Authorization: "Bearer " + vF836
        }
      });
      if (!tmp638.ok) {
        return null;
      }
      const tmp639 = await tmp638.json();
      if (tmp639.result && tmp639.result.length > 0) {
        const tmp640 = tmp639.result[0];
        const tmp641 = tmpLocalAr === "ar";
        if (tmp641 && tmp640.codeNameSecondaryLang) {
          tmp640.codeNamePrimaryLang = tmp640.codeNameSecondaryLang;
        }
        return tmp640;
      }
      return null;
    } catch (e38) {
      return null;
    }
  }
  function fn94(p333, p334 = []) {
    if (p334.length > 0) {
      fn122(p334, () => {
        document.getElementById("rawDataPreviewModal")?.remove();
        fn100(p333);
      });
    }
    document.getElementById("rawDataPreviewModal")?.remove();
    const tmp642 = document.createElement("div");
    tmp642.id = "rawDataPreviewModal";
    tmp642.style.cssText = "position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); z-index: 10001; display: flex; align-items: center; justify-content: center; direction: rtl;";
    const tmp643 = document.createElement("div");
    tmp643.style.cssText = "background-color: #f4f7fc; width: 95%; height: 90%; border-radius: 10px; display: flex; flex-direction: column; font-family: 'Segoe UI', Tahoma, sans-serif; overflow: hidden;";
    const tmp644 = new Map();
    p334.forEach(p335 => {
      const tmp645 = p335.id + "-" + p335.field;
      tmp644.set(tmp645, p335.message);
    });
    const vA34 = ["Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ (*)", "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±", "ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ù„ÙŠÙ…", "Ø±Ù‚Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ„Ù… (*)", "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù… (*)", "Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªÙ„Ù… (*)", "Ø¯ÙˆÙ„Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù… (*)", "Ù…Ø­Ø§ÙØ¸Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù… (*)", "Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù… (*)", "Ø´Ø§Ø±Ø¹ Ø§Ù„Ù…Ø³ØªÙ„Ù… (*)", "Ù…Ø¨Ù†Ù‰ Ø§Ù„Ù…Ø³ØªÙ„Ù… (*)", "ÙˆØµÙ Ø§Ù„ØµÙ†Ù (*)", "Ù†ÙˆØ¹ ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (*)", "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (*)", "Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ", "ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ (*)", "Ø§Ù„ÙƒÙ…ÙŠØ© (*)", "Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø© (*)", "Ø¹Ù…Ù„Ø© Ø§Ù„Ø¨ÙŠØ¹", "Ø³Ø¹Ø± Ø§Ù„ØµØ±Ù", "Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ…", "Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ…", "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 1 (*)", "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ 1 (*)", "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 1 (*)", "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 2", "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ 2", "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 2", "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 3", "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ 3", "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 3", "Ù…Ø±Ø¬Ø¹ Ø´Ø±Ø§Ø¡", "ÙˆØµÙ Ø´Ø±Ø§Ø¡", "Ù…Ø±Ø¬Ø¹ Ù…Ø¨ÙŠØ¹Ø§Øª", "ÙˆØµÙ Ù…Ø¨ÙŠØ¹Ø§Øª", "Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ", "Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†Ùƒ", "Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªÙˆØµÙŠÙ„", "Ø§Ù„ØªØºÙ„ÙŠÙ"];
    let tmpLocaltableStylewidth100Bo = "<table style=\"width: 100%; border-collapse: collapse; text-align: center;\"><thead><tr style=\"background-color: #2161a1; color: white;\">";
    vA34.forEach(p336 => tmpLocaltableStylewidth100Bo += "<th style=\"padding: 10px; border: 1px solid #ddd; white-space: nowrap;\">" + p336.replace(" (*)", "") + "</th>");
    tmpLocaltableStylewidth100Bo += "</tr></thead><tbody>";
    p333.forEach((p337, p338) => {
      tmpLocaltableStylewidth100Bo += "<tr>";
      const tmp646 = p337[0] || "ØµÙ " + (p338 + 2);
      for (let vLN032 = 0; vLN032 < vA34.length; vLN032++) {
        const tmp647 = vA34[vLN032].replace(" (*)", "");
        const tmp648 = vLN032 === 11 ? p337[11] || p337[39] || "" : p337[vLN032] !== undefined && p337[vLN032] !== null ? p337[vLN032] : "";
        const tmp649 = tmp646 + "-" + tmp647;
        const tmp650 = tmp644.get(tmp649);
        const tmp651 = tmp650 ? "background-color: #fff1f0; color: #cf1322;" : "";
        const tmp652 = tmp650 ? "Ø®Ø·Ø£: " + tmp650 : "";
        tmpLocaltableStylewidth100Bo += "<td style=\"padding: 8px; border: 1px solid #eee; " + tmp651 + "\" title=\"" + tmp652 + "\">" + tmp648 + "</td>";
      }
      tmpLocaltableStylewidth100Bo += "</tr>";
    });
    tmpLocaltableStylewidth100Bo += "</tbody></table>";
    tmp643.innerHTML = "\n        <div style=\"padding: 15px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; background-color: #fff; flex-shrink: 0;\">\n            <h3 style=\"margin: 0; color: #2161a1;\">1. Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ© ÙˆØ§Ù„ØªØ­Ù‚Ù‚ Ù…Ù†Ù‡Ø§</h3>\n            <div>\n                <button id=\"continueToEditorBtn\" style=\"background-color: #28a745; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold;\">\n                    " + (p334.length > 0 ? "Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„ (Ù…Ø¹ ÙˆØ¬ÙˆØ¯ Ø£Ø®Ø·Ø§Ø¡)" : "Ù…ØªØ§Ø¨Ø¹Ø© Ù„Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…") + "\n                </button>\n                <button id=\"closePreviewBtn\" style=\"background-color: #6c757d; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin-right: 10px;\">Ø¥ØºÙ„Ø§Ù‚</button>\n            </div>\n        </div>\n        " + (p334.length > 0 ? "<div style=\"padding: 10px; background-color: #fffbe6; border-bottom: 1px solid #ffe58f; text-align: center; color: #d46b08; font-weight: bold;\">Ù…Ø±Ø± Ø§Ù„ÙØ£Ø±Ø© ÙÙˆÙ‚ Ø§Ù„Ø®Ù„Ø§ÙŠØ§ Ø§Ù„Ø­Ù…Ø±Ø§Ø¡ Ù„Ù…Ø¹Ø±ÙØ© Ø³Ø¨Ø¨ Ø§Ù„Ø®Ø·Ø£.</div>" : "") + "\n        <div style=\"overflow: auto; flex-grow: 1; background: #fff;\">" + tmpLocaltableStylewidth100Bo + "</div>\n    ";
    tmp642.appendChild(tmp643);
    document.body.appendChild(tmp642);
    document.getElementById("closePreviewBtn").onclick = () => tmp642.remove();
    document.getElementById("continueToEditorBtn").onclick = async () => {
      const tmp653 = document.getElementById("continueToEditorBtn");
      tmp653.disabled = true;
      tmp653.textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¶ÙŠØ±...";
      try {
        const tmp654 = await fn75();
        const tmp655 = new Map(tmp654?.filter(p339 => p339.document?.internalID).map(p340 => [String(p340.document.internalID), p340.id]) || []);
        const tmp656 = p333.map(p341 => {
          const vO39 = {};
          const vA35 = ["internalID", "dateTimeIssued", "serviceDeliveryDate", "receiver_id", "receiver_name", "receiver_type", "receiver_country", "receiver_governate", "receiver_city", "receiver_street", "receiver_building", "item_description", "item_type", "item_code", "item_internal_code", "unit_type", "quantity", "unit_price", "currency_sold", "exchange_rate", "discount_rate", "discount_amount", "tax_type_1", "tax_subtype_1", "tax_rate_1", "tax_type_2", "tax_subtype_2", "tax_rate_2", "tax_type_3", "tax_subtype_3", "tax_rate_3", "purchaseOrderReference", "purchaseOrderDescription", "salesOrderReference", "salesOrderDescription", "bankName", "bankAccountNo", "deliveryApproach", "deliveryPackaging"];
          vA35.forEach((p342, p343) => {
            vO39[p342] = p341[p343] !== undefined ? p341[p343] : null;
          });
          vO39.item_code_name = p341[39] || "";
          const tmp657 = String(vO39.internalID).trim();
          if (tmp657 && tmp655.has(tmp657)) {
            vO39.draftId = tmp655.get(tmp657);
          }
          return vO39;
        });
        tmp642.remove();
        fn100(tmp656);
      } catch (e39) {
        alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ­Ø¶ÙŠØ± Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„: " + e39.message);
        tmp653.disabled = false;
        tmp653.textContent = "Ù…ØªØ§Ø¨Ø¹Ø©";
      }
    };
  }
  async function fn95() {
    const tmp658 = await fetchTaxpayerInfo();
    if (!tmp658) {
      alert("ÙØ´Ù„ Ø­Ø§Ø³Ù…: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù…ÙˆÙ„. Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©.");
      const tmp659 = document.getElementById("saveFromModalBtn");
      if (tmp659) {
        tmp659.disabled = false;
        tmp659.textContent = "Ø­ÙØ¸ Ø§Ù„ÙÙˆØ§ØªÙŠØ±";
      }
      return;
    }
    const tmp660 = document.getElementById("modalErrorContainer");
    if (tmp660) {
      tmp660.style.display = "none";
      tmp660.innerHTML = "";
    }
    const tmp661 = new Map();
    document.querySelectorAll(".invoice-group").forEach(p344 => {
      const tmp662 = p344.querySelector("[data-field=\"internalID\"]").textContent.trim();
      const tmp663 = p344.dataset.draftId;
      const tmp664 = p344.querySelector(".invoice-header-row");
      const tmp665 = tmp664.querySelector("[data-field=\"dateTimeIssued\"]").textContent.trim();
      const tmp666 = tmp664.querySelector("[data-field=\"serviceDeliveryDate\"]").textContent.trim();
      const tmp667 = tmp664.querySelector("[data-field=\"receiver_name\"]").textContent.trim();
      const tmp668 = tmp664.querySelector("[data-field=\"receiver_id\"]").textContent.trim();
      const vO40 = {
        id: tmp658.id,
        name: document.getElementById("editor-seller-name").value,
        governate: document.getElementById("editor-seller-governate").value,
        regionCity: document.getElementById("editor-seller-regionCity").value,
        street: document.getElementById("editor-seller-street").value,
        buildingNumber: document.getElementById("editor-seller-building").value,
        taxpayerActivityCode: document.getElementById("activity-select-editor")?.value || tmp658.taxpayerActivityCode
      };
      const vO41 = {};
      p344.querySelectorAll(".receiver-details-table [data-receiver-field]").forEach(p345 => {
        vO41[p345.dataset.receiverField] = p345.textContent.trim();
      });
      const vO42 = {};
      p344.querySelectorAll(".extra-details-table [data-invoice-field]").forEach(p346 => {
        vO42[p346.dataset.invoiceField] = p346.textContent.trim();
      });
      const vA36 = [];
      p344.querySelectorAll(".items-table tbody tr").forEach(p347 => {
        const vO43 = {
          internalID: tmp662,
          receiver_name: tmp667,
          receiver_id: tmp668,
          dateTimeIssued: tmp665,
          serviceDeliveryDate: tmp666,
          ...vO41,
          ...vO42
        };
        p347.querySelectorAll("[data-field]").forEach(p348 => {
          const tmp669 = p348.dataset.field;
          if (tmp669 !== "dateTimeIssued" && tmp669 !== "serviceDeliveryDate") {
            if (p348.querySelectorAll("span[data-field]").length > 0) {
              p348.querySelectorAll("span[data-field]").forEach(p349 => {
                vO43[p349.dataset.field] = p349.textContent.trim();
              });
            } else {
              vO43[tmp669] = p348.textContent.trim();
            }
          }
        });
        vA36.push(vO43);
      });
      if (tmp662) {
        tmp661.set(tmp662, {
          lines: vA36,
          issuer: vO40,
          draftId: tmp663
        });
      }
    });
    const vA37 = [];
    for (const [tmp670, tmp671] of tmp661.entries()) {
      if (!tmp671.lines || tmp671.lines.length === 0) {
        vA37.push({
          internalID: tmp670,
          message: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ù†ÙˆØ¯ Ù„Ù‡Ø°Ù‡ Ø§Ù„ÙØ§ØªÙˆØ±Ø©."
        });
      }
    }
    if (vA37.length > 0) {
      fn122(vA37);
      return;
    }
    await fn109(tmp661);
  }
  function fn96(p350, p351, p352, p353) {
    document.getElementById("customConfirmDialog")?.remove();
    const tmp672 = document.createElement("div");
    tmp672.id = "customConfirmDialog";
    tmp672.style.cssText = "\n        position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n        background-color: rgba(0, 0, 0, 0.6); z-index: 20000;\n        display: flex; align-items: center; justify-content: center;\n        direction: rtl; font-family: 'Cairo', 'Segoe UI', sans-serif;\n        backdrop-filter: blur(4px);\n    ";
    tmp672.innerHTML = "\n        <div style=\"background: #fff; width: 550px; max-width: 90%; border-radius: 12px; box-shadow: 0 5px 25px rgba(0,0,0,0.2); animation: zoomIn 0.3s ease-out;\">\n            <div style=\"padding: 20px 25px; background-color: #fffbe6; color: #d46b08; border-top-left-radius: 12px; border-top-right-radius: 12px; display: flex; align-items: center; gap: 15px; border-bottom: 1px solid #ffe58f;\">\n                <span style=\"font-size: 32px;\">âš ï¸</span>\n                <h3 style=\"margin: 0; font-size: 20px;\">" + p350 + "</h3>\n            </div>\n            <div style=\"padding: 25px; font-size: 16px; line-height: 1.8; color: #333;\">\n                " + p351 + "\n            </div>\n            <div style=\"padding: 20px 25px; display: flex; justify-content: flex-end; gap: 15px; background-color: #f8f9fa; border-bottom-left-radius: 12px; border-bottom-right-radius: 12px;\">\n                <button id=\"dialogCancelBtn\" style=\"background: #6c757d; color: white; padding: 10px 25px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 15px;\">Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø­ÙØ¸</button>\n                <button id=\"dialogConfirmBtn\" style=\"background: #28a745; color: white; padding: 10px 25px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 15px;\">Ù†Ø¹Ù…ØŒ Ù…ÙˆØ§ÙÙ‚ ÙˆÙ…ØªØ§Ø¨Ø¹Ø©</button>\n            </div>\n        </div>\n        <style> @keyframes zoomIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } } </style>\n    ";
    document.body.appendChild(tmp672);
    const tmp673 = document.getElementById("dialogConfirmBtn");
    const tmp674 = document.getElementById("dialogCancelBtn");
    tmp673.onclick = () => {
      tmp672.remove();
      if (typeof p352 === "function") {
        p352();
      }
    };
    tmp674.onclick = () => {
      tmp672.remove();
      if (typeof p353 === "function") {
        p353();
      }
    };
  }
  async function fn97(p354, p355 = false) {
    const tmpUrlHttplocalhost8080sig = "http://localhost:8080/sign";
    const vF742 = fn74("ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±ØŒ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹...", 0);
    try {
      const tmp675 = await fetch(tmpUrlHttplocalhost8080sig, {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          data: p354,
          is_hash: p355
        })
      });
      vF742.remove();
      if (!tmp675.ok) {
        const tmp676 = await tmp675.json().catch(() => ({
          error: "Ø±Ø¯ ØºÙŠØ± ØµØ§Ù„Ø­ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…."
        }));
        throw new Error(tmp676.error || "ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø®Ø§Ø¯Ù… Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ (Ø§Ù„Ø­Ø§Ù„Ø©: " + tmp675.status + ").");
      }
      const tmp677 = await tmp675.json();
      if (tmp677.success && tmp677.signature) {
        fn74("âœ… ØªÙ… Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø¨Ù†Ø¬Ø§Ø­!", 3000);
        return tmp677.signature;
      } else {
        throw new Error(tmp677.error || "Ø­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ ÙÙŠ Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹.");
      }
    } catch (e40) {
      if (vF742) {
        vF742.remove();
      }
      alert("âŒ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø­Ù„ÙŠ.\n\nØ§Ù„Ø³Ø¨Ø¨: " + e40.message + "\n\nÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØªØ´ØºÙŠÙ„ Ø¨Ø±Ù†Ø§Ù…Ø¬ \"signer_app.py\" ÙˆØªÙˆØµÙŠÙ„ ÙÙ„Ø§Ø´Ø© Ø§Ù„ØªÙˆÙ‚ÙŠØ¹.");
      return null;
    }
  }
  function fn98(p356) {
    const tmp678 = JSON.parse(localStorage.getItem("receiptDrafts") || "[]");
    const tmp679 = tmp678[p356];
    if (!tmp679) {
      return;
    }
    if (confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ù…Ø³ÙˆØ¯Ø© Ø±Ù‚Ù… \"" + tmp679.receiptNumber + "\" Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ")) {
      tmp678.splice(p356, 1);
      localStorage.setItem("receiptDrafts", JSON.stringify(tmp678));
      fn40();
      fn74("ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø³ÙˆØ¯Ø© Ø¨Ù†Ø¬Ø§Ø­.", 3000);
    }
  }
  async function fn105(p357) {
    const vF837 = getAccessTokenFromUserData();
    if (!vF837) {
      alert("Ø®Ø·Ø£: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªÙˆÙƒÙ† Ø§Ù„Ø¯Ø®ÙˆÙ„.");
      return false;
    }
    if (!confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ Ø­Ø°Ù Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø±Ù‚Ù… " + p357 + " Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ù…Ø³ÙˆØ¯Ø§ØªØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.")) {
      return false;
    }
    try {
      const tmp680 = await fetch("https://api-portal.invoicing.eta.gov.eg/api/v1/documents/drafts/" + p357, {
        method: "DELETE",
        headers: {
          Authorization: "Bearer " + vF837
        }
      });
      if (!tmp680.ok) {
        const tmp681 = await tmp680.json();
        throw new Error(tmp681.error?.message || "ÙØ´Ù„ Ø­Ø°Ù Ø§Ù„Ù…Ø³ÙˆØ¯Ø©. Ø±Ù…Ø² Ø§Ù„Ø­Ø§Ù„Ø©: " + tmp680.status);
      }
      return true;
    } catch (e41) {
      alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ù…Ø³ÙˆØ¯Ø©: " + e41.message);
      return false;
    }
  }
  async function fn100(p358) {
    const tmp682 = document.getElementById("dataEditorModal");
    if (tmp682) {
      tmp682.remove();
    }
    let tmp683 = null;
    try {
      const tmp684 = JSON.parse(localStorage.getItem("USER_DATA") || "{}");
      tmp683 = tmp684?.profile?.NatId;
    } catch (e42) {}
    p358.forEach(p359 => {
      const tmp685 = String(p359.receiver_type || "").toUpperCase().trim();
      if (tmp685 === "P") {
        if ((!p359.receiver_id || String(p359.receiver_id).trim() === "") && tmp683) {
          p359.receiver_id = tmp683;
        }
        if (!p359.receiver_name || String(p359.receiver_name).trim() === "") {
          p359.receiver_name = "Ø¹Ù…ÙŠÙ„ Ù†Ù‚Ø¯ÙŠ";
        }
      }
    });
    const tmp686 = document.createElement("div");
    tmp686.id = "dataEditorModal";
    tmp686.style.cssText = "position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6); z-index: 10000; display: flex; align-items: center; justify-content: center; direction: rtl; font-family: 'Segoe UI', Tahoma, sans-serif;";
    const tmp687 = document.createElement("div");
    tmp687.style.cssText = "background-color: #fff; width: 95%; height: 90%; border-radius: 10px; display: flex; flex-direction: column; box-shadow: 0 5px 25px rgba(0,0,0,0.2); overflow: hidden;";
    const tmp688 = new Map();
    p358.forEach((p360, p361) => {
      const tmp689 = p360.internalID;
      if (!tmp689) {
        return;
      }
      if (!tmp688.has(tmp689)) {
        tmp688.set(tmp689, {
          invoiceData: p360,
          lines: []
        });
      }
      tmp688.get(tmp689).lines.push({
        ...p360,
        originalIndex: p361
      });
    });
    let vO44 = {};
    const tmp690 = await fetchTaxpayerInfo();
    if (tmp690) {
      vO44 = tmp690;
    } else {
      try {
        const tmp691 = JSON.parse(localStorage.getItem("USER_DATA") || "{}");
        const tmp692 = tmp691.profile || {};
        vO44 = {
          id: tmp692.TaxRin || tmp692.taxRin || "",
          name: localStorage.getItem("TaxpayerNameAR") || tmp692.legalName || "",
          taxpayerActivityCode: tmp692.activityCode || "4690",
          governate: tmp692.address?.governorate || "",
          regionCity: tmp692.address?.regionCity || "",
          street: tmp692.address?.street || "",
          buildingNumber: tmp692.address?.buildingNumber || ""
        };
      } catch (e43) {}
    }
    const tmp693 = tmp690.taxpayerBranchs || [];
    let tmpLocal10 = "";
    if (tmp693.length > 0) {
      tmpLocal10 = "\n        <div class=\"details-card\" style=\"padding: 10px 15px;\">\n            <label for=\"address-select-editor\" style=\"font-weight: bold; margin-bottom: 5px; display: block;\">Ø§Ø®ØªØ± Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…ØµØ¯Ø± (Ø§Ù„Ø¨Ø§Ø¦Ø¹):</label>\n            <select id=\"address-select-editor\" style=\"width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #ccc;\">\n                " + tmp693.map((p362, p363) => {
        const tmp694 = p362.address || {};
        const tmp695 = [tmp694.streetName, tmp694.regionCity, tmp694.governorateNameSecondaryLang].filter(Boolean).join(", ");
        return "<option value=\"" + p363 + "\" data-address='" + JSON.stringify(tmp694) + "'>\n                                " + (tmp695 || "ÙØ±Ø¹ Ø±Ù‚Ù… " + (p362.branchNumber || p363 + 1)) + "\n                            </option>";
      }).join("") + "\n            </select>\n        </div>";
    }
    let tmpLocal11 = "";
    if (tmp690 && tmp690.activities && tmp690.activities.length > 0) {
      const tmp696 = tmp690.activities.find(p364 => p364.toDate === null) || tmp690.activities[0];
      tmpLocal11 = "\n            <div class=\"details-card\" style=\"padding: 10px 15px;\">\n                <label for=\"activity-select-editor\" style=\"font-weight: bold; margin-bottom: 5px; display: block;\">Ø§Ø®ØªØ± ÙƒÙˆØ¯ Ø§Ù„Ù†Ø´Ø§Ø·:</label>\n                <select id=\"activity-select-editor\" style=\"width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #ccc;\">\n                    " + tmp690.activities.map(p365 => "\n                        <option value=\"" + p365.activityTypeCode + "\" " + (p365.activityTypeCode === tmp696.activityTypeCode ? "selected" : "") + ">\n                            " + p365.activityTypeCode + " - " + p365.activityTypeNameSecondaryLang + "\n                        </option>\n                    ").join("") + "\n                </select>\n            </div>\n        ";
    } else {
      tmpLocal11 = "<div class=\"details-card\" style=\"padding: 10px 15px;\">ÙƒÙˆØ¯ Ø§Ù„Ù†Ø´Ø§Ø·: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£Ù†Ø´Ø·Ø©.</div>";
    }
    let tmpLocal12 = "";
    tmp688.forEach((p366, p367) => {
      const tmp697 = p366.invoiceData;
      const tmp698 = new Date().toLocaleDateString("ar-EG");
      tmpLocal12 += "\n           <tbody class=\"invoice-group\" data-internal-id=\"" + p367 + "\" data-draft-id=\"" + (tmp697.draftId || "") + "\">\n                <tr class=\"invoice-header-row\">\n                    <td class=\"toggle-details\" style=\"font-weight: bold; font-size: 20px; text-align: center;\">+</td>\n                    <td><span contenteditable=\"true\" data-field=\"internalID\">" + p367 + "</span></td>\n<td>\n    <span contenteditable=\"true\" data-field=\"dateTimeIssued\">\n        " + (tmp697.dateTimeIssued ? new Date(tmp697.dateTimeIssued).toLocaleDateString("en-CA") : new Date().toLocaleDateString("en-CA")) + "\n    </span>\n</td>\n<td>\n    <span contenteditable=\"true\" data-field=\"serviceDeliveryDate\">\n        " + (tmp697.serviceDeliveryDate ? new Date(tmp697.serviceDeliveryDate).toLocaleDateString("en-CA") : "") + "\n    </span>\n</td>\n                    <td><span contenteditable=\"true\" data-field=\"receiver_id\">" + (tmp697.receiver_id || "") + "</span></td>\n                    <td><span contenteditable=\"true\" data-field=\"receiver_name\">" + (tmp697.receiver_name || "") + "</span></td>\n                    <td class=\"numeric\" id=\"totalBeforeTax_" + p367 + "\">0.00</td>\n                    <td class=\"numeric\" id=\"taxTotals_" + p367 + "\"></td>\n                    <td class=\"numeric\" id=\"grandTotal_" + p367 + "\" style=\"font-weight: bold;\">0.00</td>\n                    <td><button class=\"print-invoice-btn\" data-invoice-id=\"" + p367 + "\" title=\"Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø©\">ğŸ–¨ï¸</button></td>\n                    <td><button class=\"delete-invoice-btn\" title=\"Ø­Ø°Ù Ø§Ù„ÙØ§ØªÙˆØ±Ø©\">&times;</button></td>\n                </tr>\n                <tr class=\"invoice-details-row\" style=\"display: none;\">\n                    <td colspan=\"10\">\n                        <div class=\"details-wrapper\">\n                            <div class=\"details-grid\">\n                                <div class=\"details-card\">\n                                    <h4 class=\"details-header\">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØµØ¯Ø± (Ø§Ù„Ø¨Ø§Ø¦Ø¹)</h4>\n                                    <table class=\"issuer-details-table details-table\">\n                                        <tbody>\n                                            <tr><th>Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„</th><td contenteditable=\"true\" data-issuer-field=\"id\">" + vO44.id + "</td></tr>\n                                            <tr><th>Ø§Ø³Ù… Ø§Ù„Ù…ØµØ¯Ø±</th><td contenteditable=\"true\" data-issuer-field=\"name\">" + vO44.name + "</td></tr>\n                                            <tr><th>ÙƒÙˆØ¯ Ø§Ù„Ù†Ø´Ø§Ø·</th><td contenteditable=\"true\" data-issuer-field=\"taxpayerActivityCode\" class=\"notranslate\" translate=\"no\">" + vO44.taxpayerActivityCode + "</td></tr>\n                                            <tr><th>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</th><td contenteditable=\"true\" data-issuer-field=\"governate\">" + vO44.governate + "</td></tr>\n                                            <tr><th>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©/Ø§Ù„Ù‚Ø³Ù…</th><td contenteditable=\"true\" data-issuer-field=\"regionCity\">" + vO44.regionCity + "</td></tr>\n                                            <tr><th>Ø§Ù„Ø´Ø§Ø±Ø¹</th><td contenteditable=\"true\" data-issuer-field=\"street\">" + vO44.street + "</td></tr>\n                                            <tr><th>Ø±Ù‚Ù… Ø§Ù„Ù…Ø¨Ù†Ù‰</th><td contenteditable=\"true\" data-issuer-field=\"buildingNumber\">" + vO44.buildingNumber + "</td></tr>\n                                            <tr><th>ÙƒÙˆØ¯ Ø§Ù„Ù†Ø´Ø§Ø·</th><td contenteditable=\"true\" data-issuer-field=\"taxpayerActivityCode\" class=\"notranslate\" translate=\"no\">" + vO44.taxpayerActivityCode + "</td></tr>\n\n                                        </tbody>\n                                    </table>\n                                </div>\n                                <div class=\"details-card\">\n                                    <h4 class=\"details-header\">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙ„Ù… (Ø§Ù„Ù…Ø´ØªØ±ÙŠ)</h4>\n                                    <table class=\"receiver-details-table details-table\">\n                                        <tbody>\n                                            <tr><th>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªÙ„Ù…</th><td contenteditable=\"true\" data-receiver-field=\"receiver_type\" class=\"notranslate\" translate=\"no\">" + (tmp697.receiver_type ?? "B") + "</td></tr>\n                                            <tr>\n                                                <th>Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„</th>\n                                                <td style=\"display: flex; align-items: center; gap: 5px;\">\n                                                    <span contenteditable=\"true\" data-receiver-field=\"receiver_id\" style=\"flex-grow: 1;\">" + (tmp697.receiver_id ?? "") + "</span>\n                                                    <button class=\"verify-receiver-btn\" title=\"ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙˆØ§Ù…Ù„Ø£ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹\">ğŸ”</button>\n                                                </td>\n                                            </tr>\n                                            <tr><th>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…</th><td contenteditable=\"true\" data-receiver-field=\"receiver_name\">" + (tmp697.receiver_name ?? "") + "</td></tr>\n<tr><th>Ø§Ù„Ø¯ÙˆÙ„Ø©</th><td contenteditable=\"true\" data-receiver-field=\"receiver_country\" class=\"notranslate\" translate=\"no\">" + (tmp697.receiver_country ?? "") + "</td></tr>\n                                            <tr><th>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</th><td contenteditable=\"true\" data-receiver-field=\"receiver_governate\">" + (tmp697.receiver_governate ?? "") + "</td></tr>\n                                            <tr><th>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©/Ø§Ù„Ù‚Ø³Ù…</th><td contenteditable=\"true\" data-receiver-field=\"receiver_city\">" + (tmp697.receiver_city ?? "") + "</td></tr>\n                                            <tr><th>Ø§Ù„Ø´Ø§Ø±Ø¹</th><td contenteditable=\"true\" data-receiver-field=\"receiver_street\">" + (tmp697.receiver_street ?? "") + "</td></tr>\n                                            <tr><th>Ø±Ù‚Ù… Ø§Ù„Ù…Ø¨Ù†Ù‰</th><td contenteditable=\"true\" data-receiver-field=\"receiver_building\">" + (tmp697.receiver_building ?? "") + "</td></tr>\n                                        </tbody>\n                                    </table>\n                                </div>\n                                <div class=\"details-card\">\n                                    <h4 class=\"details-header\">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©</h4>\n                                    <table class=\"extra-details-table details-table\">\n                                        <tbody>\n                                            <tr><th>Ù…Ø±Ø¬Ø¹ Ø·Ù„Ø¨ Ø§Ù„Ø´Ø±Ø§Ø¡</th><td contenteditable=\"true\" data-invoice-field=\"purchaseOrderReference\">" + (tmp697.purchaseOrderReference || "") + "</td></tr>\n                                            <tr><th>ÙˆØµÙ Ø·Ù„Ø¨ Ø§Ù„Ø´Ø±Ø§Ø¡</th><td contenteditable=\"true\" data-invoice-field=\"purchaseOrderDescription\">" + (tmp697.purchaseOrderDescription || "") + "</td></tr>\n                                            <tr><th>Ù…Ø±Ø¬Ø¹ Ø·Ù„Ø¨ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</th><td contenteditable=\"true\" data-invoice-field=\"salesOrderReference\">" + (tmp697.salesOrderReference || "") + "</td></tr>\n                                            <tr><th>ÙˆØµÙ Ø·Ù„Ø¨ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</th><td contenteditable=\"true\" data-invoice-field=\"salesOrderDescription\">" + (tmp697.salesOrderDescription || "") + "</td></tr>\n                                            <tr><th>Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ</th><td contenteditable=\"true\" data-invoice-field=\"bankName\">" + (tmp697.bankName || "") + "</td></tr>\n                                            <tr><th>Ø±Ù‚Ù… Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†Ùƒ</th><td contenteditable=\"true\" data-invoice-field=\"bankAccountNo\">" + (tmp697.bankAccountNo || "") + "</td></tr>\n                                            <tr><th>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªÙˆØµÙŠÙ„</th><td contenteditable=\"true\" data-invoice-field=\"deliveryApproach\">" + (tmp697.deliveryApproach || "") + "</td></tr>\n                                            <tr><th>Ø§Ù„ØªØºÙ„ÙŠÙ</th><td contenteditable=\"true\" data-invoice-field=\"deliveryPackaging\">" + (tmp697.deliveryPackaging || "") + "</td></tr>\n                                        </tbody>\n                                    </table>\n                                </div>\n                            </div>\n                            <div class=\"items-card\">\n                                <h4 class=\"details-header\">Ø¨Ù†ÙˆØ¯ Ø§Ù„ÙØ§ØªÙˆØ±Ø©</h4>\n                                <div style=\"overflow-x: auto;\">\n                                    <table class=\"items-table\">\n                                        <thead>\n                                     \n\n                                            <tr>\n                                                <th>Ù†ÙˆØ¹ Ø§Ù„ÙƒÙˆØ¯</th><th>ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù</th><th>ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚ÙŠØ§Ø³</th>\n                                                            <th>Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ</th> \n\n                                                            \n\n                                                <th>Ø§Ø³Ù… Ø§Ù„ÙƒÙˆØ¯ (Ø±Ø³Ù…ÙŠ)</th>\n                                                <th>ÙˆØµÙ Ø§Ù„ØµÙ†Ù (Ø¨Ø§Ù„ÙØ§ØªÙˆØ±Ø©)</th>\n                                                <th>Ø§Ù„ÙƒÙ…ÙŠØ©</th><th>Ø§Ù„Ø³Ø¹Ø±</th><th>Ø¹Ù…Ù„Ø©</th><th>Ø³Ø¹Ø± Ø§Ù„ØµØ±Ù</th>\n                                                <th>Ø®ØµÙ… (%)</th><th>Ø®ØµÙ… (Ù‚ÙŠÙ…Ø©)</th>\n                                                <th>Ø¶Ø±ÙŠØ¨Ø© 1</th><th>Ø¶Ø±ÙŠØ¨Ø© 2</th><th>Ø¶Ø±ÙŠØ¨Ø© 3</th><th>Ø­Ø°Ù</th>\n                                            </tr>\n                                        </thead>\n                                        <tbody>\n                                    " + p366.lines.map(p368 => {
        const tmp699 = p368.item_description || p368.item_code_name || "";
        const tmp700 = p368.item_internal_code || "";
        return "\n                <tr data-line-index=\"" + p368.originalIndex + "\">\n                    <td contenteditable=\"true\" data-field=\"item_type\" class=\"notranslate\" translate=\"no\">" + (p368.item_type ?? "") + "</td>\n                    <td contenteditable=\"true\" data-field=\"item_code\" class=\"notranslate\" translate=\"no\">" + (p368.item_code ?? "") + "</td>\n                    <td contenteditable=\"true\" data-field=\"unit_type\" class=\"notranslate\" translate=\"no\">" + (p368.unit_type ?? "") + "</td>\n                    \n                    <td contenteditable=\"true\" data-field=\"item_internal_code\">" + tmp700 + "</td>\n\n                    <td data-field=\"item_code_name\" style=\"background-color: #f0f8ff;\">" + (p368.item_code_name ?? "") + "</td>\n                    <td contenteditable=\"true\" data-field=\"item_description\">" + tmp699 + "</td>\n                    \n                    <td contenteditable=\"true\" data-field=\"quantity\" class=\"numeric\">" + (p368.quantity ?? "") + "</td>\n                    <td contenteditable=\"true\" data-field=\"unit_price\" class=\"numeric\">" + (p368.unit_price ?? "") + "</td>\n                    <td contenteditable=\"true\" data-field=\"currency_sold\" class=\"notranslate\" translate=\"no\">" + (p368.currency_sold || "EGP") + "</td>\n                    <td contenteditable=\"true\" data-field=\"exchange_rate\" class=\"numeric\">" + (p368.exchange_rate || 1) + "</td>\n                    <td contenteditable=\"true\" data-field=\"discount_rate\" class=\"numeric\">" + (p368.discount_rate || "") + "</td>\n                    <td contenteditable=\"true\" data-field=\"discount_amount\" class=\"numeric\">" + (p368.discount_amount || "") + "</td>\n                    \n                    <td class=\"notranslate\" translate=\"no\">\n                        <span contenteditable=\"true\" data-field=\"tax_type_1\">" + (p368.tax_type_1 ?? "") + "</span> / \n                        <span contenteditable=\"true\" data-field=\"tax_subtype_1\">" + (p368.tax_subtype_1 ?? "") + "</span> / \n                        <span contenteditable=\"true\" data-field=\"tax_rate_1\" class=\"numeric\">" + (p368.tax_rate_1 ?? "") + "</span>\n                    </td>\n                    <td class=\"notranslate\" translate=\"no\">\n                        <span contenteditable=\"true\" data-field=\"tax_type_2\">" + (p368.tax_type_2 ?? "") + "</span> / \n                        <span contenteditable=\"true\" data-field=\"tax_subtype_2\">" + (p368.tax_subtype_2 ?? "") + "</span> / \n                        <span contenteditable=\"true\" data-field=\"tax_rate_2\" class=\"numeric\">" + (p368.tax_rate_2 ?? "") + "</span>\n                    </td>\n                    <td class=\"notranslate\" translate=\"no\">\n                        <span contenteditable=\"true\" data-field=\"tax_type_3\">" + (p368.tax_type_3 ?? "") + "</span> / \n                        <span contenteditable=\"true\" data-field=\"tax_subtype_3\">" + (p368.tax_subtype_3 ?? "") + "</span> / \n                        <span contenteditable=\"true\" data-field=\"tax_rate_3\" class=\"numeric\">" + (p368.tax_rate_3 ?? "") + "</span>\n                    </td>\n                    <td><button class=\"delete-line-btn\">&times;</button></td>\n                </tr>\n            ";
      }).join("") + "\n                                        </tbody>\n                                    </table>\n                                </div>\n                            </div>\n                        </div>\n                    </td>\n                </tr>\n            </tbody>\n        ";
    });
    tmp687.innerHTML = "\n        <div style=\"padding: 15px 25px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; background-color: #f8f9fa;\">\n            <h3 style=\"margin: 0; color: #2161a1;\">Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙÙˆØ§ØªÙŠØ±</h3>\n            <div>\n                <button id=\"saveFromModalBtn\" style=\"background-color: #28a745; color: white; padding: 10px 25px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 16px;\">Ø­ÙØ¸ Ø§Ù„ÙÙˆØ§ØªÙŠØ±</button>\n                            <button id=\"saveAsTemplateBtn\" style=\"background-color: #007bff; color: white; padding: 10px 25px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 16px;\">Ø­ÙØ¸ ÙƒÙ†Ù…ÙˆØ°Ø¬</button>\n                              \n\n                <button id=\"closeModalBtn\" style=\"background-color: #6c757d; color: white; padding: 10px 25px; border: none; border-radius: 8px; cursor: pointer; margin-right: 10px;\">Ø¥ØºÙ„Ø§Ù‚</button>\n            </div>\n        </div>\n     \n        <div style=\"padding: 10px 25px; background-color: #e9ecef; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; align-items: flex-end;\">\n    \n    <!-- âœ…âœ…âœ… Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¥Ø¶Ø§ÙØ© 2: ÙˆØ¶Ø¹ ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù‡Ù†Ø§ âœ…âœ…âœ… -->\n    " + tmpLocal11 + "\n    " + tmpLocal10 + "\n    \n    <div class=\"details-card\" style=\"padding: 10px 15px;\">\n        <label for=\"editor-seller-name\" style=\"font-weight: bold; margin-bottom: 5px; display: block;\">Ø§Ø³Ù… Ø§Ù„Ù…ØµØ¯Ø±:</label>\n        <input type=\"text\" id=\"editor-seller-name\" style=\"width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #ccc;\" value=\"" + tmp690.name + "\">\n    </div>\n    <div class=\"details-card\" style=\"padding: 10px 15px;\">\n        <label for=\"editor-seller-country\" style=\"font-weight: bold; margin-bottom: 5px; display: block;\">Ø§Ù„Ø¯ÙˆÙ„Ø©:</label>\n        <input type=\"text\" id=\"editor-seller-country\" style=\"width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #ccc;\" value=\"EG\" readonly>\n    </div>\n    <div class=\"details-card\" style=\"padding: 10px 15px;\">\n        <label for=\"editor-seller-governate\" style=\"font-weight: bold; margin-bottom: 5px; display: block;\">Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©:</label>\n        <input type=\"text\" id=\"editor-seller-governate\" style=\"width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #ccc;\" value=\"" + tmp690.governate + "\">\n    </div>\n    <div class=\"details-card\" style=\"padding: 10px 15px;\">\n        <label for=\"editor-seller-regionCity\" style=\"font-weight: bold; margin-bottom: 5px; display: block;\">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</label>\n        <input type=\"text\" id=\"editor-seller-regionCity\" style=\"width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #ccc;\" value=\"" + tmp690.regionCity + "\">\n    </div>\n    <div class=\"details-card\" style=\"padding: 10px 15px;\">\n        <label for=\"editor-seller-street\" style=\"font-weight: bold; margin-bottom: 5px; display: block;\">Ø§Ù„Ø´Ø§Ø±Ø¹:</label>\n        <input type=\"text\" id=\"editor-seller-street\" style=\"width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #ccc;\" value=\"" + tmp690.street + "\">\n    </div>\n    <div class=\"details-card\" style=\"padding: 10px 15px;\">\n        <label for=\"editor-seller-building\" style=\"font-weight: bold; margin-bottom: 5px; display: block;\">Ø±Ù‚Ù… Ø§Ù„Ù…Ø¨Ù†Ù‰:</label>\n        <input type=\"text\" id=\"editor-seller-building\" style=\"width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #ccc;\" value=\"" + (tmp690.buildingNumber || "") + "\">\n    </div>\n    <!-- âœ…âœ…âœ… Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¥Ø¶Ø§ÙØ© 2 --- -->\n\n</div>\n\n        <div style=\"overflow-y: auto; flex-grow: 1;\">\n            <table class=\"main-invoice-table\">\n                <thead>\n                   <tr style=\"background-color: #020b18ff; color: white; position: sticky; top: 0; z-index: 10;\">\n                        <th style=\"padding: 12px; width: 40px;\"></th>\n                        <th style=\"padding: 12px;\">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ</th>\n<th style=\"padding: 12px;\">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±</th>\n<th style=\"padding: 12px;\">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ù„ÙŠÙ…</th>\n                        \n                        <th style=\"padding: 12px;\">Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„</th>\n                        <th style=\"padding: 12px;\">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…</th>\n                        <th style=\"padding: 12px;\">Ø§Ù„Ù‚ÙŠÙ…Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©</th>\n                        <th style=\"padding: 12px;\">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨</th>\n                        <th style=\"padding: 12px;\">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©</th>\n                        <th style=\"padding: 12px; width: 60px;\">Ø·Ø¨Ø§Ø¹Ø©</th>\n                        <th style=\"padding: 12px; width: 60px;\">Ø­Ø°Ù</th>\n                   </tr>\n                </thead>\n                " + tmpLocal12 + "\n            </table>\n        </div>\n        <div id=\"modalErrorContainer\" style=\"padding: 10px; background-color: #f8d7da; color: #721c24; display: none; max-height: 120px; overflow-y: auto; flex-shrink: 0;\"></div>\n        <div id=\"totalsFooter\" style=\"padding: 12px 25px; background-color: #343a40; color: white; display: flex; justify-content: space-around; align-items: center; flex-shrink: 0; border-top: 3px solid #0d6efd; font-size: 14px;\">\n            <div>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù‚Ø¨Ù„ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©: <span id=\"totalBeforeTax\" style=\"font-weight: bold; color: #ffc107;\">0.00</span></div>\n            <div id=\"taxTotalsContainer\" style=\"display: flex; gap: 15px; flex-wrap: wrap; justify-content: center;\"></div>\n            <div style=\"font-size: 16px;\"><strong>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: <span id=\"grandTotal\" style=\"font-weight: bold; color: #198754;\">0.00</span></strong></div>\n        </div>\n    ";
    tmp686.appendChild(tmp687);
    document.body.appendChild(tmp686);
    const tmpLocalmaininvoicetableWidt = "\n        .main-invoice-table { width: 100%; border-collapse: collapse; }\n        .main-invoice-table thead tr { background-color: #020b18ff; color: white; position: sticky; top: 0; z-index: 10; }\n        .main-invoice-table th { padding: 12px; text-align: center; }\n        .invoice-header-row { background-color: #f8f9fa; border-bottom: 2px solid #dee2e6; cursor: pointer; transition: background-color 0.2s; }\n        .invoice-header-row:hover { background-color: #e9ecef; }\n        .invoice-header-row td { padding: 10px 12px; vertical-align: middle; text-align: center; border-left: 1px solid #eee; }\n        .invoice-header-row td:first-child { border-left: none; }\n        .invoice-header-row td span[contenteditable=\"true\"] { background-color: #fff; padding: 5px; border-radius: 4px; border: 1px dashed #ccc; min-width: 100px; display: inline-block; }\n        .numeric { font-family: 'Segoe UI', Tahoma, sans-serif; font-weight: 500; }\n        .details-wrapper { padding: 20px; background-color: #f9f9f9; border-top: 3px solid #0d6efd; }\n        .details-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; margin-bottom: 25px; }\n        .details-card, .items-card { background: #fff; border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }\n        .details-header { color: #0d6efd; border-bottom: 2px solid #eee; padding-bottom: 8px; margin-top: 0; margin-bottom: 15px; font-size: 18px; }\n        .details-table { width: 100%; border-collapse: collapse; font-size: 15px; }\n        .details-table th, .details-table td { border: 1px solid #f0f0f0; padding: 9px; text-align: right; }\n        .details-table th { background-color: #f8f9fa; width: 150px; font-weight: 600; }\n        .details-table td[contenteditable=\"true\"] { background-color: #fff9e6; outline: none; }\n        .items-table { width: 100%; border-collapse: collapse; }\n        .items-table th, .items-table td { border: 1px solid #dee2e6; padding: 8px; text-align: center; font-size: 14px; vertical-align: middle; }\n        .items-table th { background-color: #e9ecef; font-weight: 600; }\n        .items-table tbody tr:nth-child(even) { background-color: #f9f9f9; }\n        .items-table td[contenteditable=\"true\"], .items-table span[contenteditable=\"true\"] { background-color: #fff9e6; outline: none; }\n        .delete-invoice-btn, .delete-line-btn, .print-invoice-btn { background: #dc3545; color: white; border: none; border-radius: 5px; cursor: pointer; padding: 4px 8px; font-size: 14px; }\n        .print-invoice-btn { background: #17a2b8; }\n        .delete-line-btn { font-size: 18px; padding: 2px 8px; }\n    ";
    const tmp701 = document.createElement("style");
    tmp701.id = "dataEditorModalStyles";
    tmp701.innerText = tmpLocalmaininvoicetableWidt;
    document.head.appendChild(tmp701);
    document.getElementById("closeModalBtn").onclick = () => {
      tmp686.remove();
      tmp701.remove();
    };
    const tmp702 = document.getElementById("address-select-editor");
    if (tmp702) {
      const vF18 = () => {
        const tmp703 = tmp702.options[tmp702.selectedIndex];
        const tmp704 = JSON.parse(tmp703.dataset.address || "{}");
        document.getElementById("editor-seller-governate").value = tmp704.governorateNameSecondaryLang || "";
        document.getElementById("editor-seller-regionCity").value = tmp704.cityNameSecondaryLang || "";
        document.getElementById("editor-seller-street").value = tmp704.streetName || "";
        document.getElementById("editor-seller-building").value = tmp704.buildingNo || "";
        document.querySelectorAll(".issuer-details-table").forEach(p369 => {
          p369.querySelector("[data-issuer-field=\"governate\"]").textContent = tmp704.governorateNameSecondaryLang || "";
          p369.querySelector("[data-issuer-field=\"regionCity\"]").textContent = tmp704.cityNameSecondaryLang || "";
          p369.querySelector("[data-issuer-field=\"street\"]").textContent = tmp704.streetName || "";
          p369.querySelector("[data-issuer-field=\"buildingNumber\"]").textContent = tmp704.buildingNo || "";
        });
      };
      tmp702.addEventListener("change", vF18);
      vF18();
    }
    document.getElementById("saveFromModalBtn").onclick = () => fn95();
    document.querySelectorAll(".invoice-header-row").forEach(p370 => {
      p370.onclick = p371 => {
        if (p371.target.tagName === "BUTTON" || p371.target.isContentEditable || p371.target.parentElement.isContentEditable) {
          return;
        }
        const tmp705 = p370.nextElementSibling;
        const tmp706 = p370.querySelector(".toggle-details");
        const tmp707 = tmp705.style.display !== "none";
        tmp705.style.display = tmp707 ? "none" : "table-row";
        tmp706.textContent = tmp707 ? "+" : "-";
      };
    });
    document.querySelectorAll(".delete-invoice-btn").forEach(p372 => {
      p372.onclick = async p373 => {
        p373.stopPropagation();
        const tmp708 = p373.target.closest(".invoice-group");
        const tmp709 = tmp708.dataset.draftId;
        const tmp710 = tmp708.dataset.internalId;
        if (!tmp709) {
          if (confirm("Ù‡Ø°Ù‡ Ø§Ù„ÙØ§ØªÙˆØ±Ø© (" + tmp710 + ") Ù„Ù… ÙŠØªÙ… Ø­ÙØ¸Ù‡Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù… Ø¨Ø¹Ø¯. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø²Ø§Ù„ØªÙ‡Ø§ Ù…Ù† Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø§Ù„ÙŠØŸ")) {
            tmp708.remove();
            fn108();
          }
          return;
        }
        const tmp711 = await fn105(tmp709);
        if (tmp711) {
          tmp708.remove();
          fn108();
          alert("ØªÙ… Ø­Ø°Ù Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø±Ù‚Ù… " + tmp710 + " Ø¨Ù†Ø¬Ø§Ø­ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù….");
        }
      };
    });
    document.getElementById("saveAsTemplateBtn").onclick = () => {
      const tmp712 = document.querySelector(".invoice-group");
      if (!tmp712) {
        alert("Ù„Ø§ ØªÙˆØ¬Ø¯ ÙÙˆØ§ØªÙŠØ± Ù„Ø¹Ø±Ø¶Ù‡Ø§ Ø£Ùˆ Ø­ÙØ¸Ù‡Ø§ ÙƒÙ†Ù…ÙˆØ°Ø¬.");
        return;
      }
      const tmpHex426bbb = fn102(tmp712);
      fn103(async (p374, p375) => {
        const vO45 = {
          ...tmpHex426bbb,
          templateName: p374,
          templateScope: p375
        };
        const tmp713 = await fn101(vO45);
        if (tmp713.success) {
          alert("âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ \"" + p374 + "\" Ø¨Ù†Ø¬Ø§Ø­!");
        } else {
          alert("âŒ ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬. Ø§Ù„Ø®Ø·Ø£: " + tmp713.error);
        }
      });
    };
    document.querySelectorAll(".print-invoice-btn").forEach(p376 => {
      p376.onclick = p377 => {
        p377.stopPropagation();
        const tmp714 = p377.target.dataset.invoiceId;
        const tmp715 = p377.target.closest(".invoice-group");
        fn123(tmp714, tmp715);
      };
    });
    document.querySelectorAll(".delete-line-btn").forEach(p378 => {
      p378.onclick = p379 => {
        p379.stopPropagation();
        const tmp716 = p379.target.closest("tr");
        const tmp717 = tmp716.parentElement;
        tmp716.remove();
        if (tmp717.children.length === 0) {
          tmp717.closest(".invoice-group").remove();
        }
        fn108();
      };
    });
    tmp686.addEventListener("input", p380 => {
      if (p380.target.isContentEditable) {
        fn108();
      }
    });
    fn108();
    tmp686.querySelectorAll(".verify-receiver-btn").forEach(p381 => {
      p381.onclick = async p382 => {
        p382.stopPropagation();
        const tmp718 = p382.target;
        const tmp719 = tmp718.closest("tr");
        const tmp720 = tmp719.querySelector("[data-receiver-field=\"receiver_id\"]");
        const tmp721 = tmp720.textContent.trim();
        const tmp722 = tmp718.textContent;
        tmp718.textContent = "â³";
        tmp718.disabled = true;
        const tmp723 = await fn73(tmp721);
        if (tmp723) {
          const tmp724 = tmp718.closest(".details-grid").querySelector(".receiver-details-table");
          const tmp725 = tmp724.querySelector("[data-receiver-field=\"receiver_name\"]");
          const tmp726 = tmp724.querySelector("[data-receiver-field=\"receiver_governate\"]");
          const tmp727 = tmp724.querySelector("[data-receiver-field=\"receiver_city\"]");
          const tmp728 = tmp724.querySelector("[data-receiver-field=\"receiver_street\"]");
          const tmp729 = tmp724.querySelector("[data-receiver-field=\"receiver_building\"]");
          if (tmp725) {
            tmp725.textContent = tmp723.namePrimaryLang || "";
          }
          const tmp730 = tmp723.taxpayerBranchs?.[0]?.address;
          if (tmp730) {
            if (tmp726) {
              tmp726.textContent = tmp730.governorateNameSecondaryLang || tmp730.governorate || "";
            }
            if (tmp727) {
              tmp727.textContent = tmp730.cityNameSecondaryLang || tmp730.regionCity || "";
            }
            if (tmp728) {
              tmp728.textContent = tmp730.streetName || tmp730.street || "";
            }
            if (tmp729) {
              tmp729.textContent = tmp730.buildingNo || tmp730.buildingNumber || "";
            }
          }
          const tmp731 = tmp718.closest(".invoice-group").querySelector(".invoice-header-row");
          const tmp732 = tmp731.querySelector("[data-field=\"receiver_name\"]");
          if (tmp732) {
            tmp732.textContent = tmp723.namePrimaryLang || "";
          }
          alert("ØªÙ… Ø§Ù„ØªØ­Ù‚Ù‚ ÙˆÙ…Ù„Ø¡ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ù†Ø¬Ø§Ø­!");
        } else {
          alert("ÙØ´Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù†Ù‡ ØµØ­ÙŠØ­.");
        }
        tmp718.textContent = tmp722;
        tmp718.disabled = false;
      };
    });
  }
  async function fn101(p383) {
    const vF838 = getAccessTokenFromUserData();
    if (!vF838) {
      return {
        success: false,
        error: "Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªÙˆÙƒÙ† Ø§Ù„Ø¯Ø®ÙˆÙ„."
      };
    }
    try {
      const tmp733 = await fetch("https://api-portal.invoicing.eta.gov.eg/api/v1/documents/templates", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          Authorization: "Bearer " + vF838
        },
        body: JSON.stringify(p383)
      });
      if (!tmp733.ok) {
        const tmp734 = await tmp733.json();
        const tmp735 = tmp734.error?.details?.[0]?.message || tmp734.error?.message || JSON.stringify(tmp734);
        throw new Error(tmp735);
      }
      return {
        success: true,
        error: null
      };
    } catch (e44) {
      return {
        success: false,
        error: e44.message
      };
    }
  }
  function fn102(p384) {
    const vO46 = {};
    p384.querySelectorAll("[data-field], [data-issuer-field], [data-receiver-field], [data-invoice-field]").forEach(p385 => {
      const tmp736 = p385.dataset.field || p385.dataset.issuerField || p385.dataset.receiverField || p385.dataset.invoiceField;
      if (tmp736) {
        vO46[tmp736] = p385.textContent.trim();
      }
    });
    let vLN033 = 0;
    let vLN034 = 0;
    const tmp737 = new Map();
    const vA38 = [];
    const vA39 = [];
    p384.querySelectorAll(".items-table tbody tr").forEach(p386 => {
      const vO47 = {};
      p386.querySelectorAll("[data-field]").forEach(p387 => {
        if (p387.querySelectorAll("span[data-field]").length > 0) {
          p387.querySelectorAll("span[data-field]").forEach(p388 => {
            vO47[p388.dataset.field] = p388.textContent.trim();
          });
        } else {
          vO47[p387.dataset.field] = p387.textContent.trim();
        }
      });
      vA39.push(vO47);
      const tmp738 = parseFloat(vO47.quantity) || 0;
      const tmp739 = parseFloat(vO47.unit_price) || 0;
      const vParseFloat21 = parseFloat((tmp738 * tmp739).toFixed(5));
      vLN033 += vParseFloat21;
      const tmp740 = parseFloat(vO47.discount_amount) || vParseFloat21 * (parseFloat(vO47.discount_rate) || 0) / 100;
      vLN034 += tmp740;
      const vParseFloat22 = parseFloat((vParseFloat21 - tmp740).toFixed(5));
      const vA40 = [];
      let vLN035 = 0;
      for (let vLN18 = 1; vLN18 <= 3; vLN18++) {
        const tmp741 = vO47["tax_type_" + vLN18]?.trim().toUpperCase();
        const tmp742 = vO47["tax_rate_" + vLN18];
        if (tmp741 && tmp742 != null && tmp742.trim() !== "" && !isNaN(parseFloat(tmp742))) {
          const vParseFloat23 = parseFloat(tmp742);
          const vParseFloat24 = parseFloat((vParseFloat22 * (vParseFloat23 / 100)).toFixed(5));
          const tmp743 = vO47["tax_subtype_" + vLN18]?.trim() || vO64[tmp741] || "";
          vA40.push({
            taxType: tmp741,
            amount: vParseFloat24,
            subType: tmp743,
            rate: vParseFloat23
          });
          vLN035 += tmp741 === "T4" ? -vParseFloat24 : vParseFloat24;
          tmp737.set(tmp741, (tmp737.get(tmp741) || 0) + vParseFloat24);
        }
      }
      vA38.push({
        description: vO47.item_description,
        itemType: vO47.item_type,
        itemCode: vO47.item_code,
        internalCode: vO47.item_internal_code || vO47.item_code,
        unitType: vO47.unit_type,
        quantity: tmp738,
        unitValue: {
          currencySold: "EGP",
          amountEGP: tmp739
        },
        salesTotal: vParseFloat21,
        discount: {
          amount: tmp740
        },
        netTotal: vParseFloat22,
        taxableItems: vA40,
        total: parseFloat((vParseFloat22 + vLN035).toFixed(5)),
        valueDifference: 0,
        totalTaxableFees: 0,
        itemsDiscount: 0
      });
    });
    const tmp744 = Array.from(tmp737, ([tmp745, tmp746]) => ({
      taxType: tmp745,
      amount: parseFloat(tmp746.toFixed(5))
    }));
    const tmp747 = vA38.reduce((p389, p390) => p389 + p390.total, 0);
    const vO48 = {
      tags: ["FullInvoice", "SignatureRequired"],
      document: {
        documentType: "I",
        documentTypeVersion: "1.0",
        dateTimeIssued: firstLine.dateTimeIssued && !isNaN(new Date(firstLine.dateTimeIssued)) ? new Date(firstLine.dateTimeIssued).toISOString().split(".")[0] + "Z" : new Date().toISOString().split(".")[0] + "Z",
        serviceDeliveryDate: firstLine.serviceDeliveryDate && !isNaN(new Date(firstLine.serviceDeliveryDate)) ? new Date(firstLine.serviceDeliveryDate).toISOString().split("T")[0] : undefined,
        taxpayerActivityCode: document.getElementById("activity-select-editor")?.value || "4690",
        internalID: vO46.internalID,
        issuer: {
          type: "B",
          id: vO46.id,
          name: vO46.name,
          address: {
            branchID: "0",
            country: "EG",
            governate: vO46.governate,
            regionCity: vO46.regionCity,
            street: vO46.street,
            buildingNumber: vO46.buildingNumber
          }
        },
        receiver: {
          type: vO46.receiver_type,
          id: vO46.receiver_id,
          name: vO46.receiver_name,
          address: {
            country: vO46.receiver_country,
            governate: vO46.receiver_governate,
            regionCity: vO46.receiver_city,
            street: vO46.receiver_street,
            buildingNumber: vO46.receiver_building
          }
        },
        invoiceLines: vA38,
        totalSalesAmount: parseFloat(vLN033.toFixed(5)),
        totalDiscountAmount: parseFloat(vLN034.toFixed(5)),
        netAmount: parseFloat((vLN033 - vLN034).toFixed(5)),
        taxTotals: tmp744,
        totalAmount: parseFloat(tmp747.toFixed(5)),
        signatures: [{
          signatureType: "I",
          value: "VGVtcG9yYXJ5IFNpZ25hdHVyZSBIb2xkZXI="
        }]
      },
      lineItemCodes: vA39.map(p391 => ({
        codeType: p391.item_type,
        itemCode: p391.item_code,
        codeNamePrimaryLang: p391.item_code_name || p391.item_description,
        codeNameSecondaryLang: p391.item_code_name || p391.item_description
      }))
    };
    return vO48;
  }
  function fn103(p392) {
    document.getElementById("saveTemplatePopup")?.remove();
    const tmp748 = document.createElement("div");
    tmp748.id = "saveTemplatePopup";
    tmp748.style.cssText = "\n        position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n        background-color: rgba(0,0,0,0.5); z-index: 10002;\n        display: flex; align-items: center; justify-content: center; direction: rtl;\n    ";
    tmp748.innerHTML = "\n        <div style=\"background: #fff; padding: 25px; border-radius: 10px; width: 400px; box-shadow: 0 4px 15px rgba(0,0,0,0.2);\">\n            <h4 style=\"margin-top: 0; color: #007bff;\">Ø­ÙØ¸ Ø§Ù„ÙØ§ØªÙˆØ±Ø© ÙƒÙ†Ù…ÙˆØ°Ø¬</h4>\n            <div style=\"margin-bottom: 15px;\">\n                <label for=\"templateNameInput\" style=\"display: block; margin-bottom: 5px; font-weight: bold;\">Ø§Ø³Ù… Ø§Ù„Ù†Ù…ÙˆØ°Ø¬:</label>\n                <input type=\"text\" id=\"templateNameInput\" placeholder=\"Ù…Ø«Ø§Ù„: Ù†Ù…ÙˆØ°Ø¬ ÙÙˆØ§ØªÙŠØ± Ø´Ø±ÙƒØ© X\" style=\"width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 5px;\">\n            </div>\n            <div style=\"margin-bottom: 20px;\">\n                <label for=\"templateScopeSelect\" style=\"display: block; margin-bottom: 5px; font-weight: bold;\">Ø­ÙØ¸ Ù„Ù€:</label>\n                <select id=\"templateScopeSelect\" style=\"width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 5px;\">\n                    <option value=\"User\">Ø£Ù†Ø§ ÙÙ‚Ø· (User)</option>\n                    <option value=\"Taxpayer\">Ø¬Ù…ÙŠØ¹ Ù…Ù…Ø«Ù„ÙŠ Ø§Ù„Ù…Ù…ÙˆÙ„ (Taxpayer)</option>\n                </select>\n            </div>\n            <div style=\"display: flex; justify-content: flex-end; gap: 10px;\">\n                <button id=\"cancelTemplateSave\" style=\"background: #6c757d; color: white; padding: 8px 15px; border: none; border-radius: 5px; cursor: pointer;\">Ø¥Ù„ØºØ§Ø¡</button>\n                <button id=\"confirmTemplateSave\" style=\"background: #007bff; color: white; padding: 8px 15px; border: none; border-radius: 5px; cursor: pointer;\">Ø­ÙØ¸</button>\n            </div>\n        </div>\n    ";
    document.body.appendChild(tmp748);
    document.getElementById("cancelTemplateSave").onclick = () => tmp748.remove();
    document.getElementById("confirmTemplateSave").onclick = () => {
      const tmp749 = document.getElementById("templateNameInput").value.trim();
      const tmp750 = document.getElementById("templateScopeSelect").value;
      if (!tmp749) {
        alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ù„Ù„Ù†Ù…ÙˆØ°Ø¬.");
        return;
      }
      p392(tmp749, tmp750);
      tmp748.remove();
    };
  }
  function fn104() {
    if (document.getElementById("codes-explorer-grid")) {
      return;
    }
    const tmp751 = document.getElementById("panel-codes-explorer");
    if (!tmp751) {
      return;
    }
    tmp751.innerHTML = "\n        <div class=\"panel-header\">\n            <h2>Ù…Ø³ØªÙƒØ´Ù Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø£ØµÙ†Ø§Ù (EGS)</h2>\n            <p>Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ù…Ø³Ø¬Ù„Ø© ÙˆØµØ¯Ø±Ù‡Ø§ Ø¥Ù„Ù‰ Ù…Ù„Ù Excel Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù….</p>\n        </div>\n        <div id=\"codes-explorer-grid\" class=\"codes-explorer-grid\">\n            <div class=\"search-panel\">\n                <div class=\"search-options\">\n                    <select id=\"code-search-type\">\n                        <option value=\"rin\">Ø§Ù„Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ù…ÙˆÙ„</option>\n                    </select>\n                </div>\n                <input type=\"text\" id=\"code-search-input\" placeholder=\"Ø§Ø¨Ø¯Ø£ Ø§Ù„ÙƒØªØ§Ø¨Ø© Ù„Ù„Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù...\">\n                <div id=\"export-container\" style=\"margin-top: 15px; display: none;\">\n                    <button id=\"export-excel-btn\" style=\"width: 100%; padding: 12px; background-color: #198754; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 16px;\">\n                        ğŸ“¥ ØªØ­Ù…ÙŠÙ„ ÙƒÙ„ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ (Excel)\n                    </button>\n                    <div id=\"export-progress\" style=\"text-align: center; color: #0d6efd; margin-top: 10px; font-weight: bold; display: none;\"></div>\n                </div>\n                <ul id=\"search-results-list\" style=\"margin-top: 15px;\"><li class=\"list-placeholder\">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬...</li></ul>\n            </div>\n            <div class=\"details-panel\">\n                <div id=\"code-details-container\">\n                    <div class=\"list-placeholder\">Ø§Ø®ØªØ± ÙƒÙˆØ¯Ø§Ù‹ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„Ù‡ Ù‡Ù†Ø§...</div>\n                </div>\n            </div>\n        </div>\n    ";
    const vF19 = () => JSON.parse(localStorage.getItem("USER_DATA") || "{}").access_token;
    const vF20 = async p393 => {
      const vVF19 = vF19();
      if (!vVF19) {
        alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©. ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©.");
        return null;
      }
      try {
        const tmp752 = await fetch(p393, {
          headers: {
            Authorization: "Bearer " + vVF19
          }
        });
        if (!tmp752.ok) {
          throw new Error("API Error: " + tmp752.status);
        }
        return await tmp752.json();
      } catch (e45) {
        return null;
      }
    };
    const tmp753 = document.getElementById("code-search-type");
    const tmp754 = document.getElementById("code-search-input");
    const tmp755 = document.getElementById("search-results-list");
    const tmp756 = document.getElementById("code-details-container");
    const tmp757 = document.getElementById("export-container");
    const tmp758 = document.getElementById("export-excel-btn");
    const tmp759 = document.getElementById("export-progress");
    let tmp760;
    let tmp761 = null;
    tmp753.addEventListener("change", () => {
      tmp754.value = "";
      tmp755.innerHTML = "<li class=\"list-placeholder\">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬...</li>";
      tmp756.innerHTML = "<div class=\"list-placeholder\">Ø§Ø®ØªØ± ÙƒÙˆØ¯Ø§Ù‹ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„Ù‡ Ù‡Ù†Ø§...</div>";
      tmp757.style.display = "none";
      tmp761 = null;
      tmp754.placeholder = tmp753.value === "name" ? "Ø§Ø¨Ø¯Ø£ Ø§Ù„ÙƒØªØ§Ø¨Ø© Ù„Ù„Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù..." : "Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù„Ù„Ø¨Ø­Ø«...";
    });
    tmp754.addEventListener("input", () => {
      clearTimeout(tmp760);
      tmp757.style.display = "none";
      tmp761 = null;
      let tmp762 = tmp754.value.trim();
      if (tmp762.length < 3) {
        tmp755.innerHTML = "<li class=\"list-placeholder\">Ø§ÙƒØªØ¨ 3 Ø­Ø±ÙˆÙ/Ø£Ø±Ù‚Ø§Ù… Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„...</li>";
        return;
      }
      tmp755.innerHTML = "<li class=\"list-placeholder\">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¨Ø­Ø«...</li>";
      tmp760 = setTimeout(async () => {
        const tmp763 = tmp753.value;
        let vV762 = tmp762;
        if (tmp763 === "rin") {
          vV762 = "EG-" + tmp762;
          tmp761 = tmp762;
        }
        const tmp764 = "https://api-portal.invoicing.eta.gov.eg/api/v1/codetypes/9/codes?CodeLookupValue=" + encodeURIComponent(vV762) + "&ApplyMinChoiceLevel=true&Ps=50&Pn=1";
        const tmp765 = await vF20(tmp764);
        const tmp766 = tmp765?.result || [];
        if (tmp766.length === 0) {
          tmp755.innerHTML = "<li class=\"list-placeholder\">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬.</li>";
          return;
        }
        if (tmp763 === "rin") {
          tmp757.style.display = "block";
        }
        tmp755.innerHTML = tmp766.map((p394, p395) => "\n                <li class=\"search-result-item\" data-index=\"" + p395 + "\">\n                    <strong>" + p394.codeNameSecondaryLang + "</strong>\n                    <span>" + p394.codeLookupValue + "</span>\n                </li>\n            ").join("");
        tmp755.querySelectorAll(".search-result-item").forEach(p396 => {
          p396.addEventListener("click", p397 => {
            tmp755.querySelectorAll(".search-result-item").forEach(p398 => p398.classList.remove("selected"));
            p397.currentTarget.classList.add("selected");
            const vParseInt3 = parseInt(p397.currentTarget.dataset.index, 10);
            const tmp767 = tmp766[vParseInt3];
            vF21(tmp767);
          });
        });
      }, 500);
    });
    const vF21 = p399 => {
      if (!p399) {
        tmp756.innerHTML = "<div class=\"list-placeholder\" style=\"color:red;\">ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙØ§ØµÙŠÙ„.</div>";
        return;
      }
      tmp756.innerHTML = "\n            <div class=\"detail-card\"><h4>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„ÙƒÙˆØ¯</h4><p><span class=\"label\">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠ:</span> <span class=\"value\">" + (p399.codeNameSecondaryLang || "N/A") + "</span></p><p><span class=\"label\">Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠ:</span> <span class=\"value\">" + (p399.codeNamePrimaryLang || "N/A") + "</span></p><p><span class=\"label\">Ø§Ù„ÙƒÙˆØ¯ (Code):</span> <span class=\"value code\">" + (p399.codeLookupValue || "N/A") + "</span></p><p><span class=\"label\">Ø§Ù„ÙˆØµÙ:</span> <span class=\"value\">" + (p399.codeDescriptionSecondaryLang || "Ù„Ø§ ÙŠÙˆØ¬Ø¯") + "</span></p></div>\n            <div class=\"detail-card\" style=\"border-color: #28a745;\"><h4>Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø§Ù„Ùƒ</h4><p><span class=\"label\">Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ù„Ùƒ:</span> <span class=\"value\">" + (p399.ownerTaxpayer?.nameAr || "N/A") + "</span></p><p><span class=\"label\">Ø±Ù‚Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø§Ù„Ùƒ:</span> <span class=\"value code\">" + (p399.ownerTaxpayer?.rin || "N/A") + "</span></p></div>\n            <div class=\"detail-card\" style=\"border-color: #fd7e14;\"><h4>Ø§Ù„ØªØµÙ†ÙŠÙ (GPC)</h4><p><span class=\"label\">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 1:</span> <span class=\"value\">" + (p399.codeCategorization?.level1?.nameAr || "N/A") + "</span></p><p><span class=\"label\">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 2:</span> <span class=\"value\">" + (p399.codeCategorization?.level2?.nameAr || "N/A") + "</span></p><p><span class=\"label\">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 3:</span> <span class=\"value\">" + (p399.codeCategorization?.level3?.nameAr || "N/A") + "</span></p><p><span class=\"label\">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ 4:</span> <span class=\"value\">" + (p399.codeCategorization?.level4?.nameAr || "N/A") + "</span></p></div>\n        ";
    };
    tmp758.addEventListener("click", async () => {
      if (!tmp761) {
        alert("ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø¨Ø­Ø« Ø¨Ø±Ù‚Ù… ØªØ³Ø¬ÙŠÙ„ Ø£ÙˆÙ„Ø§Ù‹.");
        return;
      }
      tmp758.disabled = true;
      tmp759.style.display = "block";
      tmp759.textContent = "Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...";
      let vA41 = [];
      let vLN19 = 1;
      let vLN110 = 1;
      try {
        do {
          const tmp768 = "EG-" + tmp761;
          const tmp769 = "https://api-portal.invoicing.eta.gov.eg/api/v1/codetypes/9/codes?CodeLookupValue=" + tmp768 + "&ApplyMinChoiceLevel=true&Ps=100&Pn=" + vLN19;
          const tmp770 = await vF20(tmp769);
          if (tmp770 && tmp770.result) {
            vA41.push(...tmp770.result);
            vLN110 = tmp770.metadata.totalPages;
            tmp759.textContent = "Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ ØµÙØ­Ø© " + vLN19 + " Ù…Ù† " + vLN110 + "... (" + vA41.length + " ÙƒÙˆØ¯)";
            vLN19++;
          } else {
            break;
          }
        } while (vLN19 <= vLN110);
        tmp759.textContent = "ØªÙ… Ø¬Ù„Ø¨ " + vA41.length + " ÙƒÙˆØ¯. Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Excel...";
        const tmp771 = new ExcelJS.Workbook();
        tmp771.creator = "ETA Exporter by Mohamed Sabry";
        tmp771.lastModifiedBy = "ETA Exporter";
        tmp771.created = new Date();
        tmp771.rtl = true;
        const tmp772 = tmp771.addWorksheet("Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø£ØµÙ†Ø§Ù");
        tmp772.columns = [{
          header: "CodeType",
          key: "CodeType",
          width: 12
        }, {
          header: "ItemCode",
          key: "ItemCode",
          width: 20
        }, {
          header: "CodeName",
          key: "CodeName",
          width: 45
        }, {
          header: "CodeNameAr",
          key: "CodeNameAr",
          width: 45
        }, {
          header: "Description",
          key: "Description",
          width: 50
        }, {
          header: "DescriptionAr",
          key: "DescriptionAr",
          width: 50
        }, {
          header: "ActiveFrom",
          key: "ActiveFrom",
          width: 18,
          style: {
            numFmt: "dd/mm/yyyy"
          }
        }, {
          header: "ActiveTo",
          key: "ActiveTo",
          width: 18,
          style: {
            numFmt: "dd/mm/yyyy"
          }
        }, {
          header: "GPCItemLink",
          key: "GPCItemLink",
          width: 25
        }, {
          header: "EGSRelatedCode",
          key: "EGSRelatedCode",
          width: 25
        }];
        tmp772.getRow(1).eachCell(p400 => {
          p400.font = {
            name: "Cairo",
            bold: true,
            size: 12,
            color: {
              argb: "FFFFFFFF"
            }
          };
          p400.fill = {
            type: "pattern",
            pattern: "solid",
            fgColor: {
              argb: "FF0056B3"
            }
          };
          p400.alignment = {
            vertical: "middle",
            horizontal: "center"
          };
        });
        vA41.forEach(p401 => {
          const tmp773 = p401.codeLookupValue.split("-").pop() || "";
          tmp772.addRow({
            CodeType: "EGS",
            ItemCode: tmp773,
            CodeName: p401.codeNamePrimaryLang,
            CodeNameAr: p401.codeNameSecondaryLang,
            Description: p401.codeDescriptionPrimaryLang,
            DescriptionAr: p401.codeDescriptionSecondaryLang,
            ActiveFrom: p401.activeFrom ? new Date(p401.activeFrom) : null,
            ActiveTo: p401.activeTo ? new Date(p401.activeTo) : null,
            GPCItemLink: p401.parentCodeLookupValue,
            EGSRelatedCode: p401.linkedCode
          });
        });
        tmp772.views = [{
          state: "frozen",
          ySplit: 1,
          rightToLeft: true
        }];
        tmp772.autoFilter = {
          from: "A1",
          to: {
            row: 1,
            column: tmp772.columns.length
          }
        };
        tmp759.textContent = "Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©: Ø¬Ø§Ø±ÙŠ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù…Ù„Ù...";
        const tmp774 = await tmp771.xlsx.writeBuffer();
        const tmp775 = new Blob([tmp774], {
          type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
        });
        saveAs(tmp775, "Ø£ÙƒÙˆØ§Ø¯_" + tmp761 + ".xlsx");
      } catch (e46) {
        alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØµØ¯ÙŠØ± Ø§Ù„Ø£ÙƒÙˆØ§Ø¯. Ø§Ù†Ø¸Ø± Ø§Ù„ÙƒÙˆÙ†Ø³ÙˆÙ„ Ù„Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„ØªÙØ§ØµÙŠÙ„.");
      } finally {
        tmp758.disabled = false;
        tmp759.style.display = "none";
      }
    });
  }
  async function fn105(p402) {
    const vF839 = getAccessTokenFromUserData();
    if (!vF839) {
      alert("Ø®Ø·Ø£: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªÙˆÙƒÙ† Ø§Ù„Ø¯Ø®ÙˆÙ„.");
      return false;
    }
    if (!confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø³ÙˆØ¯Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…ØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.")) {
      return false;
    }
    try {
      const tmp776 = await fetch("https://api-portal.invoicing.eta.gov.eg/api/v1/documents/drafts/" + p402, {
        method: "DELETE",
        headers: {
          Authorization: "Bearer " + vF839
        }
      });
      if (!tmp776.ok) {
        let tmp777 = "ÙØ´Ù„ Ø­Ø°Ù Ø§Ù„Ù…Ø³ÙˆØ¯Ø©. Ø±Ù…Ø² Ø§Ù„Ø­Ø§Ù„Ø©: " + tmp776.status;
        try {
          const tmp778 = await tmp776.json();
          tmp777 = tmp778.error?.message || JSON.stringify(tmp778);
        } catch (e47) {
          tmp777 = await tmp776.text();
        }
        throw new Error(tmp777);
      }
      return true;
    } catch (e48) {
      alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­Ø°Ù Ø§Ù„Ù…Ø³ÙˆØ¯Ø©: " + e48.message);
      return false;
    }
  }
  async function fn106(p403, p404, p405) {
    const vF8310 = getAccessTokenFromUserData();
    if (!vF8310) {
      const tmpLocal13 = "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªÙˆÙƒÙ† Ø§Ù„Ø¯Ø®ÙˆÙ„.";
      return {
        success: false,
        error: tmpLocal13
      };
    }
    const tmp779 = document.getElementById("creditNoteTypeSelect").value;
    if (tmp779 === "without_reference" && "references" in p404.document) {
      delete p404.document.references;
    }
    if (p404.document && p404.document.references && p404.document.references.length === 1 && p404.document.references[0] === "") {
      delete p404.document.references;
    }
    const vO49 = {
      ...p404,
      clientsidevalidationresult: true,
      lineItemCodes: p405.map(p406 => ({
        codeType: p406.item_type,
        itemCode: p406.item_code,
        codeNamePrimaryLang: p406.item_code_name || p406.item_description,
        codeNameSecondaryLang: p406.item_code_name || p406.item_description
      }))
    };
    try {
      const tmp780 = await fetch("https://api-portal.invoicing.eta.gov.eg/api/v1/documents/drafts/" + p403, {
        method: "PUT",
        headers: {
          "Content-Type": "application/json",
          Authorization: "Bearer " + vF8310
        },
        body: JSON.stringify(vO49)
      });
      if (!tmp780.ok) {
        const tmp781 = await tmp780.json();
        const tmp782 = tmp781.error?.details?.[0]?.message || tmp781.error?.message || JSON.stringify(tmp781);
        throw new Error(tmp782);
      }
      const tmp783 = await tmp780.json();
      return {
        success: true,
        data: tmp783
      };
    } catch (e49) {
      return {
        success: false,
        error: e49.message
      };
    }
  }
  function fn107(p407) {
    const tmp784 = p407.document;
    if (!tmp784) {
      return [];
    }
    const tmp785 = p407.id;
    const vO50 = {
      draftId: tmp785,
      internalID: tmp784.internalID,
      receiver_id: tmp784.receiver.id,
      receiver_name: tmp784.receiver.name,
      receiver_type: tmp784.receiver.type,
      receiver_country: tmp784.receiver.address?.country,
      receiver_governate: tmp784.receiver.address?.governate,
      receiver_city: tmp784.receiver.address?.regionCity,
      receiver_street: tmp784.receiver.address?.street,
      receiver_building: tmp784.receiver.address?.buildingNumber,
      purchaseOrderReference: tmp784.purchaseOrderReference,
      purchaseOrderDescription: tmp784.purchaseOrderDescription,
      salesOrderReference: tmp784.salesOrderReference,
      salesOrderDescription: tmp784.salesOrderDescription,
      bankName: tmp784.payment?.bankName,
      bankAccountNo: tmp784.payment?.bankAccountNo,
      deliveryApproach: tmp784.delivery?.approach,
      deliveryPackaging: tmp784.delivery?.packaging
    };
    return tmp784.invoiceLines.map(p408 => {
      const vO51 = {
        ...vO50,
        item_description: p408.description,
        item_type: p408.itemType,
        item_code: p408.itemCode,
        item_internal_code: p408.internalCode,
        unit_type: p408.unitType,
        quantity: p408.quantity,
        unit_price: p408.unitValue.amountEGP,
        currency_sold: p408.unitValue.currencySold,
        exchange_rate: p408.unitValue.currencyExchangeRate,
        discount_rate: p408.discount?.rate,
        discount_amount: p408.discount?.amount
      };
      p408.taxableItems.forEach((p409, p410) => {
        if (p410 < 3) {
          vO51["tax_type_" + (p410 + 1)] = p409.taxType;
          vO51["tax_subtype_" + (p410 + 1)] = p409.subType;
          vO51["tax_rate_" + (p410 + 1)] = p409.rate;
        }
      });
      return vO51;
    });
  }
  function fn108() {
    let vLN036 = 0;
    const tmp786 = new Map();
    document.querySelectorAll(".invoice-group").forEach(p411 => {
      const tmp787 = p411.dataset.internalId;
      let vLN037 = 0;
      const tmp788 = new Map();
      p411.querySelectorAll(".items-table tbody tr").forEach(p412 => {
        const tmp789 = parseFloat(p412.querySelector("[data-field=\"quantity\"]").textContent) || 0;
        const tmp790 = parseFloat(p412.querySelector("[data-field=\"unit_price\"]").textContent) || 0;
        const tmp791 = parseFloat(p412.querySelector("[data-field=\"exchange_rate\"]").textContent) || 1;
        const tmp792 = parseFloat(p412.querySelector("[data-field=\"discount_rate\"]").textContent) || 0;
        const tmp793 = parseFloat(p412.querySelector("[data-field=\"discount_amount\"]").textContent) || 0;
        const tmp794 = tmp789 * tmp790 * tmp791;
        const tmp795 = tmp793 || tmp794 * (tmp792 / 100);
        const tmp796 = tmp794 - tmp795;
        vLN037 += tmp796;
        let vLN038 = 0;
        for (let vLN111 = 1; vLN111 <= 3; vLN111++) {
          const tmp797 = p412.querySelector("[data-field=\"tax_type_" + vLN111 + "\"]").textContent.trim().toUpperCase();
          const tmp798 = parseFloat(p412.querySelector("[data-field=\"tax_rate_" + vLN111 + "\"]").textContent) || 0;
          if ((tmp797 === "T2" || tmp797 === "T3") && tmp798 > 0) {
            const vParseFloat25 = parseFloat((tmp796 * (tmp798 / 100)).toFixed(5));
            vLN038 += vParseFloat25;
            tmp788.set(tmp797, (tmp788.get(tmp797) || 0) + vParseFloat25);
          }
        }
        const vParseFloat26 = parseFloat((tmp796 + vLN038).toFixed(5));
        for (let vLN112 = 1; vLN112 <= 3; vLN112++) {
          const tmp799 = p412.querySelector("[data-field=\"tax_type_" + vLN112 + "\"]").textContent.trim().toUpperCase();
          const tmp800 = parseFloat(p412.querySelector("[data-field=\"tax_rate_" + vLN112 + "\"]").textContent) || 0;
          if (tmp799 === "T2" || tmp799 === "T3") {
            continue;
          }
          if (tmp799 && tmp800 > 0) {
            let tmp801 = tmp799 === "T1" ? parseFloat((vParseFloat26 * (tmp800 / 100)).toFixed(5)) : parseFloat((tmp796 * (tmp800 / 100)).toFixed(5));
            tmp788.set(tmp799, (tmp788.get(tmp799) || 0) + tmp801);
          }
        }
      });
      let vVLN037 = vLN037;
      let tmpLocal14 = "";
      tmp788.forEach((p413, p414) => {
        vVLN037 += (p414 === "T4" ? -1 : 1) * p413;
        const tmp802 = vO29[p414] || p414;
        const tmp803 = p414 === "T4" ? "color: #dc3545;" : "color: #28a745;";
        tmpLocal14 += "<div style=\"" + tmp803 + " font-size: 12px;\">" + tmp802 + ": " + p413.toFixed(2) + "</div>";
      });
      document.getElementById("totalBeforeTax_" + tmp787).textContent = vLN037.toFixed(2);
      document.getElementById("taxTotals_" + tmp787).innerHTML = tmpLocal14 || "Ù„Ø§ ØªÙˆØ¬Ø¯";
      document.getElementById("grandTotal_" + tmp787).textContent = vVLN037.toFixed(2);
      vLN036 += vLN037;
      tmp788.forEach((p415, p416) => {
        tmp786.set(p416, (tmp786.get(p416) || 0) + p415);
      });
    });
    let vVLN036 = vLN036;
    let tmpLocal15 = "";
    tmp786.forEach((p417, p418) => {
      vVLN036 += (p418 === "T4" ? -1 : 1) * p417;
      const tmp804 = vO29[p418] || p418;
      const tmp805 = p418 === "T4" ? "style=\"color: #ff6b6b;\"" : "";
      tmpLocal15 += "<span " + tmp805 + ">" + tmp804 + ": " + p417.toFixed(2) + "</span>";
    });
    document.getElementById("totalBeforeTax").textContent = vLN036.toFixed(2);
    document.getElementById("taxTotalsContainer").innerHTML = tmpLocal15;
    document.getElementById("grandTotal").textContent = vVLN036.toFixed(2);
  }
  async function fn109(p419) {
    const tmp806 = document.getElementById("saveFromModalBtn");
    tmp806.disabled = true;
    tmp806.textContent = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...";
    const vA42 = [];
    const vA43 = [];
    const vA44 = [];
    for (const [tmp807, tmp808] of p419.entries()) {
      const tmp809 = tmp808.draftId;
      const tmp810 = tmp808.lines[0];
      let tmp811 = false;
      if (!tmp810.receiver_name || String(tmp810.receiver_name).trim() === "") {
        vA42.push({
          id: tmp807,
          field: "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…",
          value: "ÙØ§Ø±Øº",
          message: "Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ø¥Ø¬Ø¨Ø§Ø±ÙŠ."
        });
        tmp811 = true;
      }
      if (!tmp810.receiver_id || String(tmp810.receiver_id).trim() === "") {
        vA42.push({
          id: tmp807,
          field: "Ø±Ù‚Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ„Ù…",
          value: "ÙØ§Ø±Øº",
          message: "Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ø¥Ø¬Ø¨Ø§Ø±ÙŠ."
        });
        tmp811 = true;
      }
      if (tmp808.lines.length === 0) {
        vA42.push({
          id: tmp807,
          field: "Ø¨Ù†ÙˆØ¯ Ø§Ù„ÙØ§ØªÙˆØ±Ø©",
          value: "Ù„Ø§ ÙŠÙˆØ¬Ø¯",
          message: "ÙŠØ¬Ø¨ Ø£Ù† ØªØ­ØªÙˆÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¹Ù„Ù‰ Ø¨Ù†Ø¯ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„."
        });
        tmp811 = true;
      }
      tmp808.lines.forEach((p420, p421) => {
        const tmp812 = tmp807 + " (Ø§Ù„Ø¨Ù†Ø¯ " + (p421 + 1) + ")";
        if (!p420.item_description || String(p420.item_description).trim() === "") {
          vA42.push({
            id: tmp812,
            field: "ÙˆØµÙ Ø§Ù„ØµÙ†Ù",
            value: "ÙØ§Ø±Øº",
            message: "Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ø¥Ø¬Ø¨Ø§Ø±ÙŠ."
          });
          tmp811 = true;
        }
        if (!p420.item_code || String(p420.item_code).trim() === "") {
          vA42.push({
            id: tmp812,
            field: "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù",
            value: "ÙØ§Ø±Øº",
            message: "Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ø¥Ø¬Ø¨Ø§Ø±ÙŠ."
          });
          tmp811 = true;
        }
        if (!p420.unit_type || String(p420.unit_type).trim() === "") {
          vA42.push({
            id: tmp812,
            field: "ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚ÙŠØ§Ø³",
            value: "ÙØ§Ø±ØºØ©",
            message: "Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ø¥Ø¬Ø¨Ø§Ø±ÙŠ."
          });
          tmp811 = true;
        }
        if (isNaN(parseFloat(p420.quantity)) || parseFloat(p420.quantity) <= 0) {
          vA42.push({
            id: tmp812,
            field: "Ø§Ù„ÙƒÙ…ÙŠØ©",
            value: p420.quantity,
            message: "ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø±Ù‚Ù…Ù‹Ø§ Ù…ÙˆØ¬Ø¨Ù‹Ø§ ÙˆØ£ÙƒØ¨Ø± Ù…Ù† ØµÙØ±."
          });
          tmp811 = true;
        }
        if (isNaN(parseFloat(p420.unit_price))) {
          vA42.push({
            id: tmp812,
            field: "Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø©",
            value: p420.unit_price,
            message: "ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù‚ÙŠÙ…Ø© Ø±Ù‚Ù…ÙŠØ©."
          });
          tmp811 = true;
        }
        for (let vLN113 = 1; vLN113 <= 3; vLN113++) {
          const tmp813 = p420["tax_type_" + vLN113]?.trim();
          const tmp814 = p420["tax_rate_" + vLN113]?.trim();
          if (tmp813 && !tmp814 || !tmp813 && tmp814) {
            vA42.push({
              id: tmp812,
              field: "Ø¶Ø±ÙŠØ¨Ø© " + vLN113,
              value: "Ø§Ù„Ù†ÙˆØ¹: " + tmp813 + ", Ø§Ù„Ù†Ø³Ø¨Ø©: " + tmp814,
              message: "Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© ØºÙŠØ± Ù…ÙƒØªÙ…Ù„Ø©. ÙŠØ¬Ø¨ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù†ÙˆØ¹ ÙˆØ§Ù„Ù†Ø³Ø¨Ø© Ù…Ø¹Ù‹Ø§."
            });
            tmp811 = true;
          }
        }
      });
      if (!tmp811) {
        const tmpHex1702e1 = fn121(tmp808.lines, tmp808.issuer);
        const tmp815 = tmp808.lines;
        if (tmp809) {
          vA44.push({
            draftId: tmp809,
            payload: tmpHex1702e1,
            rawLines: tmp815,
            internalID: tmp807
          });
        } else {
          vA43.push({
            payload: tmpHex1702e1,
            rawLines: tmp815,
            internalID: tmp807
          });
        }
      }
    }
    if (vA42.length > 0) {
      fn122(vA42);
      tmp806.disabled = false;
      tmp806.textContent = "Ø­ÙØ¸ Ø§Ù„ÙÙˆØ§ØªÙŠØ±";
      return;
    }
    const tmp816 = p419.size;
    let vLN039 = 0;
    tmp806.textContent = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸ (0 / " + tmp816 + ")...";
    for (const tmp817 of vA44) {
      try {
        const tmp818 = await fn106(tmp817.draftId, tmp817.payload, tmp817.rawLines);
        if (!tmp818.success) {
          throw new Error(tmp818.error);
        }
        vLN039++;
        tmp806.textContent = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸ (" + vLN039 + " / " + tmp816 + ")...";
      } catch (e50) {
        vA42.push({
          id: tmp817.internalID,
          field: "Ø®Ø·Ø£ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…",
          value: "ÙØ´Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ«",
          message: e50.message
        });
      }
    }
    for (const tmp819 of vA43) {
      try {
        const tmp820 = await fn111(tmp819.payload);
        if (!tmp820.success) {
          throw new Error(tmp820.error);
        }
        const tmp821 = tmp820.data.draftId;
        const tmp822 = await fn106(tmp821, tmp819.payload, tmp819.rawLines);
        if (!tmp822.success) {
          await fn105(tmp821);
          throw new Error("ÙØ´Ù„ ÙÙŠ Ø¬Ø¹Ù„ Ø§Ù„Ù…Ø³ÙˆØ¯Ø© Ø¬Ø§Ù‡Ø²Ø©: " + tmp822.error);
        }
        vLN039++;
        tmp806.textContent = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸ (" + vLN039 + " / " + tmp816 + ")...";
      } catch (e51) {
        vA42.push({
          id: tmp819.internalID,
          field: "Ø®Ø·Ø£ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…",
          value: "ÙØ´Ù„ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡",
          message: e51.message
        });
      }
    }
    tmp806.disabled = false;
    tmp806.textContent = "Ø­ÙØ¸ Ø§Ù„ÙÙˆØ§ØªÙŠØ±";
    if (vA42.length > 0) {
      fn122(vA42);
    } else {
      fn110("Ø§ÙƒØªÙ…Ù„Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­!", "ØªÙ… Ø­ÙØ¸ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙÙˆØ§ØªÙŠØ± Ø¨Ù†Ø¬Ø§Ø­ ÙƒÙ…Ø³ÙˆØ¯Ø§Øª Ø¬Ø§Ù‡Ø²Ø© (Ø¹Ø¯Ø¯: " + tmp816 + ").", () => {
        document.getElementById("dataEditorModal")?.remove();
        document.getElementById("dataEditorModalStyles")?.remove();
      });
    }
  }
  function fn110(p422, p423, p424) {
    document.getElementById("customSuccessModal")?.remove();
    const tmp823 = document.createElement("div");
    tmp823.id = "customSuccessModal";
    tmp823.style.cssText = "\n        position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n        background-color: rgba(0, 0, 0, 0.6); z-index: 20000;\n        display: flex; align-items: center; justify-content: center;\n        direction: rtl; font-family: 'Cairo', 'Segoe UI', sans-serif;\n        backdrop-filter: blur(4px);\n    ";
    const tmpLocalsvgWidth80Height80Vi = "\n        <svg width=\"80\" height=\"80\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n            <circle cx=\"12\" cy=\"12\" r=\"10\" fill=\"#28a745\"/>\n            <path d=\"M8.5 12.5L11 15L15.5 10\" stroke=\"white\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n        </svg>\n    ";
    tmp823.innerHTML = "\n        <div style=\"background: #fff; width: 480px; max-width: 90%; border-radius: 16px; box-shadow: 0 10px 30px rgba(0,0,0,0.2 ); text-align: center; padding: 30px 25px; animation: zoomIn 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);\">\n            <div style=\"margin-bottom: 20px;\">" + tmpLocalsvgWidth80Height80Vi + "</div>\n            <h2 style=\"margin: 0 0 15px 0; font-size: 24px; color: #1d3557;\">" + p422 + "</h2>\n            <p style=\"margin: 0 0 30px 0; font-size: 17px; line-height: 1.7; color: #495057;\">" + p423 + "</p>\n            <button id=\"successModalOkBtn\" style=\"background: linear-gradient(145deg, #28a745, #218838); color: white; padding: 12px 50px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 16px; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);\">\n                Ù…ÙˆØ§ÙÙ‚\n            </button>\n        </div>\n        <style> \n            @keyframes zoomIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }\n            #successModalOkBtn:hover { transform: translateY(-3px); box-shadow: 0 6px 20px rgba(40, 167, 69, 0.4); }\n        </style>\n    ";
    document.body.appendChild(tmp823);
    const tmp824 = document.getElementById("successModalOkBtn");
    tmp824.onclick = () => {
      tmp823.remove();
      if (typeof p424 === "function") {
        p424();
      }
    };
  }
  async function fn111(p425) {
    const vF8311 = getAccessTokenFromUserData();
    if (!vF8311) {
      return {
        success: false,
        error: "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©: Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ ØªÙˆÙƒÙ† Ø§Ù„Ø¯Ø®ÙˆÙ„."
      };
    }
    const vO52 = {
      "receiver id is required": "Ø­Ù‚Ù„ 'Ø±Ù‚Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ„Ù…' Ø¥Ø¬Ø¨Ø§Ø±ÙŠ.",
      "receiver name is required": "Ø­Ù‚Ù„ 'Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…' Ø¥Ø¬Ø¨Ø§Ø±ÙŠ.",
      "invalid receiver registration number": "Ø±Ù‚Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ„Ù… (Ø§Ù„Ù…Ø´ØªØ±ÙŠ) ØºÙŠØ± ØµØ­ÙŠØ­ Ø£Ùˆ ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø¨Ø§Ù„Ù…Ù†Ø¸ÙˆÙ…Ø©.",
      "issuer and receiver cannot be the same": "Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø¨Ø§Ø¦Ø¹ ÙˆØ§Ù„Ù…Ø´ØªØ±ÙŠ Ù†ÙØ³ Ø§Ù„Ø´Ø®Øµ (Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ù…ØªØ·Ø§Ø¨Ù‚).",
      "must be one of [b, p, f]": "Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªÙ„Ù… ØºÙŠØ± ØµØ­ÙŠØ­. ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 'B' Ù„Ø´Ø±ÙƒØ©ØŒ 'P' Ù„Ø´Ø®Øµ Ø·Ø¨ÙŠØ¹ÙŠØŒ Ø£Ùˆ 'F' Ù„Ø£Ø¬Ù†Ø¨ÙŠ.",
      "the submitted document has been processed before": "Ù‡Ø°Ù‡ Ø§Ù„ÙØ§ØªÙˆØ±Ø© (Ø¨Ù†ÙØ³ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ) ØªÙ… Ø¥Ø±Ø³Ø§Ù„Ù‡Ø§ Ù…Ø³Ø¨Ù‚Ù‹Ø§.",
      "invalid document structure": "Ù‡ÙŠÙƒÙ„ Ø§Ù„ÙØ§ØªÙˆØ±Ø© ØºÙŠØ± ØµØ­ÙŠØ­. ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠØ© Ù…Ù…ØªÙ„Ø¦Ø©.",
      "document is not valid": "Ø§Ù„Ù…Ø³ØªÙ†Ø¯ ØºÙŠØ± ØµØ§Ù„Ø­. ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.",
      "internal id is required": "Ø­Ù‚Ù„ 'Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ù„Ù„ÙØ§ØªÙˆØ±Ø©' Ø¥Ø¬Ø¨Ø§Ø±ÙŠ.",
      "datetimeissued is required": "ØªØ§Ø±ÙŠØ® Ø¥ØµØ¯Ø§Ø± Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ù…Ø·Ù„ÙˆØ¨.",
      "invoicelines is required": "ÙŠØ¬Ø¨ Ø£Ù† ØªØ­ØªÙˆÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¹Ù„Ù‰ Ø¨Ù†Ø¯ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.",
      arrayitemnotvalid: "ÙŠÙˆØ¬Ø¯ Ø®Ø·Ø£ ÙÙŠ Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ø­Ø¯ Ø§Ù„Ø¨Ù†ÙˆØ¯. ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© (ÙƒÙˆØ¯ Ø§Ù„ØµÙ†ÙØŒ ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ØŒ Ø£Ùˆ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨).",
      "item code not found": "Ø£Ø­Ø¯ Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø£ØµÙ†Ø§Ù (EGS/GS1) ØºÙŠØ± ØµØ­ÙŠØ­ Ø£Ùˆ Ù„Ù… ÙŠØªÙ… ØªØ³Ø¬ÙŠÙ„Ù‡.",
      "invalid item code": "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø£Ø­Ø¯ Ø§Ù„Ø¨Ù†ÙˆØ¯ ØºÙŠØ± ØµØ§Ù„Ø­.",
      "invalid unit type": "ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙƒÙˆØ¯ ÙˆØ­Ø¯Ø© Ù‚ÙŠØ§Ø³ ØºÙŠØ± ØµØ§Ù„Ø­ ÙÙŠ Ø£Ø­Ø¯ Ø§Ù„Ø¨Ù†ÙˆØ¯.",
      "description is required": "Ø­Ù‚Ù„ 'ÙˆØµÙ Ø§Ù„ØµÙ†Ù' Ø¥Ø¬Ø¨Ø§Ø±ÙŠ ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ù†ÙˆØ¯.",
      "quantity is required": "Ø­Ù‚Ù„ 'Ø§Ù„ÙƒÙ…ÙŠØ©' Ø¥Ø¬Ø¨Ø§Ø±ÙŠ ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ù†ÙˆØ¯ ÙˆÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø±Ù‚Ù…Ù‹Ø§.",
      "unitvalue is required": "Ø­Ù‚Ù„ 'Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø©' Ø¥Ø¬Ø¨Ø§Ø±ÙŠ ÙÙŠ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ù†ÙˆØ¯.",
      "invalid tax type": "ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†ÙˆØ¹ Ø¶Ø±ÙŠØ¨Ø© ØºÙŠØ± ØµØ§Ù„Ø­ ÙÙŠ Ø£Ø­Ø¯ Ø§Ù„Ø¨Ù†ÙˆØ¯.",
      "invalid tax subtype": "ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†ÙˆØ¹ Ø¶Ø±ÙŠØ¨Ø© ÙØ±Ø¹ÙŠ ØºÙŠØ± ØµØ§Ù„Ø­ ÙÙŠ Ø£Ø­Ø¯ Ø§Ù„Ø¨Ù†ÙˆØ¯.",
      "taxableitems is required": "Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨ Ù…Ø·Ù„ÙˆØ¨Ø© Ù„ÙƒÙ„ Ø¨Ù†Ø¯ Ø®Ø§Ø¶Ø¹ Ù„Ù„Ø¶Ø±ÙŠØ¨Ø©.",
      "tax type is required": "Ø­Ù‚Ù„ 'Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©' Ø¥Ø¬Ø¨Ø§Ø±ÙŠ Ù„Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø®Ø§Ø¶Ø¹Ø© Ù„Ù„Ø¶Ø±ÙŠØ¨Ø©.",
      "total amount does not equal": "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª. Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù„Ø§ ÙŠØªØ·Ø§Ø¨Ù‚ Ù…Ø¹ Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø¨Ù†ÙˆØ¯ ÙˆØ§Ù„Ø¶Ø±Ø§Ø¦Ø¨.",
      "netamount must be equal to": "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª. ØµØ§ÙÙŠ Ø§Ù„Ù‚ÙŠÙ…Ø© Ù„Ø§ ÙŠØªØ·Ø§Ø¨Ù‚ Ù…Ø¹ (Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª - Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®ØµÙ…).",
      "totalsalesamount must be equal to": "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª. Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ù„Ø§ ÙŠØªØ·Ø§Ø¨Ù‚ Ù…Ø¹ Ù…Ø¬Ù…ÙˆØ¹ Ù‚ÙŠÙ… Ø§Ù„Ø¨Ù†ÙˆØ¯.",
      unauthorized: "Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©. Ù‚Ø¯ ØªÙƒÙˆÙ† Ø¬Ù„Ø³Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù‚Ø¯ Ø§Ù†ØªÙ‡Øª. Ø­Ø§ÙˆÙ„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ ÙˆØ§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",
      "bad request": "Ø·Ù„Ø¨ ØºÙŠØ± ØµØ§Ù„Ø­. Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ù‡Ù†Ø§Ùƒ Ø®Ø·Ø£ ÙÙŠ ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±Ø³Ù„Ø©.",
      "the request is invalid": "Ø§Ù„Ø·Ù„Ø¨ ØºÙŠØ± ØµØ§Ù„Ø­. ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±Ø³Ù„Ø©.",
      "an error has occurred": "Ø­Ø¯Ø« Ø®Ø·Ø£ Ø¹Ø§Ù… ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù…. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„Ø§Ø­Ù‚Ù‹Ø§."
    };
    function fn112(p426) {
      if (!p426 || !p426.error) {
        const tmp825 = String(p426).toLowerCase();
        for (const tmp826 in vO52) {
          if (tmp825.includes(tmp826)) {
            return vO52[tmp826];
          }
        }
        return p426;
      }
      const tmp827 = p426.error.details || [];
      if (tmp827.length === 0) {
        const tmp828 = String(p426.error.message || "").toLowerCase();
        for (const tmp829 in vO52) {
          if (tmp828.includes(tmp829)) {
            return vO52[tmp829];
          }
        }
        return p426.error.message || "Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù….";
      }
      const tmp830 = tmp827.map(p427 => {
        const tmp831 = p427.message;
        const tmp832 = p427.target || "";
        let tmp833 = "Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªØ±Ø¬Ù…: " + tmp831;
        for (const tmp834 in vO52) {
          if (String(tmp831).toLowerCase().includes(tmp834)) {
            tmp833 = vO52[tmp834];
            break;
          }
        }
        const tmp835 = tmp832.match(/invoiceLines\[(\d+)\]/);
        if (tmp835 && tmp835[1]) {
          const tmp836 = parseInt(tmp835[1], 10) + 1;
          return "ÙÙŠ (Ø§Ù„Ø¨Ù†Ø¯ Ø±Ù‚Ù… " + tmp836 + "): " + tmp833;
        }
        return tmp833;
      });
      return tmp830.join("\n");
    }
    try {
      const tmp837 = await fetch("https://api-portal.invoicing.eta.gov.eg/api/v1/documents/drafts", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          Authorization: "Bearer " + vF8311
        },
        body: JSON.stringify(p425)
      });
      if (!tmp837.ok) {
        const tmp838 = await tmp837.json();
        const vF112 = fn112(tmp838);
        throw new Error(vF112);
      }
      const tmp839 = await tmp837.json();
      return {
        success: true,
        data: tmp839
      };
    } catch (e52) {
      return {
        success: false,
        error: e52.message
      };
    }
  }
  async function fn113(p428) {
    const vA45 = [];
    const tmp840 = new Map();
    const vO53 = {
      description: "ÙˆØµÙ Ø§Ù„ØµÙ†Ù",
      itemType: "Ù†ÙˆØ¹ ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù",
      itemCode: "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù",
      quantity: "Ø§Ù„ÙƒÙ…ÙŠØ©",
      unitPrice: "Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø©"
    };
    async function fn114(p429) {
      if (!p429 || p429.length !== 14 || !/^\d+$/.test(p429)) {
        return {
          valid: false,
          message: "ÙŠØ¬Ø¨ Ø£Ù† ÙŠØªÙƒÙˆÙ† Ù…Ù† 14 Ø±Ù‚Ù…Ù‹Ø§."
        };
      }
      try {
        const vF8312 = getAccessTokenFromUserData();
        if (!vF8312) {
          return {
            valid: false,
            message: "Ø®Ø·Ø£ Ù…ØµØ§Ø¯Ù‚Ø©."
          };
        }
        const tmp841 = await fetch("https://api-portal.invoicing.eta.gov.eg/api/v1/person/" + p429, {
          headers: {
            Authorization: "Bearer " + vF8312
          }
        });
        if (tmp841.status === 200) {
          return {
            valid: true
          };
        }
        if (tmp841.status === 400) {
          return {
            valid: false,
            message: "Ø§Ù„Ø±Ù‚Ù… ØºÙŠØ± Ù…Ø³Ø¬Ù„ Ø£Ùˆ ØºÙŠØ± ØµØ­ÙŠØ­."
          };
        }
        return {
          valid: false,
          message: "Ø®Ø·Ø£ " + tmp841.status + " Ù…Ù† Ø§Ù„Ø®Ø§Ø¯Ù…."
        };
      } catch (e53) {
        return {
          valid: false,
          message: "ÙØ´Ù„ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø±Ù‚Ù…."
        };
      }
    }
    const tmp842 = Array.from(p428.entries()).map(async ([tmp843, tmp844]) => {
      const vA46 = [];
      let vLN040 = 0;
      for (const [tmp845, tmp846] of tmp844.entries()) {
        const vO54 = {
          ...tmp846,
          officialCodeName: ""
        };
        vLN040 += (parseFloat(tmp846.quantity) || 0) * (parseFloat(tmp846.unitPrice) || 0);
        for (const tmp847 in vO53) {
          if (!vO54[tmp847] || String(vO54[tmp847]).trim() === "") {
            vA45.push({
              id: tmp843 + " (Ø§Ù„Ø¨Ù†Ø¯ " + (tmp845 + 1) + ")",
              field: vO53[tmp847],
              value: "ÙØ§Ø±Øº",
              message: "Ù‡Ø°Ø§ Ø§Ù„Ø­Ù‚Ù„ Ø¥Ø¬Ø¨Ø§Ø±ÙŠ."
            });
          }
        }
        const tmp848 = (vO54.itemType || "").toUpperCase().trim();
        const tmp849 = (vO54.itemCode || "").toString().trim();
        if (tmp848 && tmp849) {
          let tmp850 = null;
          if (tmp848 === "EGS") {
            tmp850 = await fn92(tmp849);
          } else if (tmp848 === "GS1") {
            tmp850 = await fn93(tmp849);
          }
          if (tmp850) {
            vO54.officialCodeName = tmp850.codeNameSecondaryLang || "!! Ø§Ø³Ù… ØºÙŠØ± Ù…Ø³Ø¬Ù„ !!";
          } else {
            vA45.push({
              id: tmp843 + " (Ø§Ù„Ø¨Ù†Ø¯ " + (tmp845 + 1) + ")",
              field: "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (" + tmp848 + ")",
              value: tmp849,
              message: "Ø§Ù„ÙƒÙˆØ¯ ØºÙŠØ± ØµØ­ÙŠØ­ Ø£Ùˆ ØºÙŠØ± Ù…Ø³Ø¬Ù„."
            });
          }
        }
        vA46.push(vO54);
      }
      const tmp851 = tmp844[0] || {};
      const tmp852 = (tmp851.buyerId || "").toString().trim();
      if (vLN040 > 150000) {
        if (!tmp852) {
          vA45.push({
            id: tmp843,
            field: "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ù„Ù„Ø¹Ù…ÙŠÙ„",
            value: "ÙØ§Ø±Øº",
            message: "Ø¥Ø¬Ø¨Ø§Ø±ÙŠ Ù„Ø£Ù† Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ ÙŠØªØ¬Ø§ÙˆØ² 150,000 Ø¬Ù†ÙŠÙ‡."
          });
        } else {
          const tmp853 = await fn114(tmp852);
          if (!tmp853.valid) {
            vA45.push({
              id: tmp843,
              field: "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ù„Ù„Ø¹Ù…ÙŠÙ„",
              value: tmp852,
              message: tmp853.message
            });
          }
        }
      } else if (tmp852) {
        const tmp854 = await fn114(tmp852);
        if (!tmp854.valid) {
          vA45.push({
            id: tmp843,
            field: "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ù„Ù„Ø¹Ù…ÙŠÙ„",
            value: tmp852,
            message: tmp854.message
          });
        }
      }
      tmp840.set(tmp843, vA46);
    });
    await Promise.all(tmp842);
    return {
      validatedMap: tmp840,
      validationErrors: vA45
    };
  }
  const vO55 = {
    "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ù„Ù„ÙØ§ØªÙˆØ±Ø©": "Ø§ÙƒØªØ¨ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø¹Ù„ÙŠ Ø­Ø³Ø¨ Ø§Ù„Ø³Ø±ÙŠØ§Ù„ ",
    "Ø±Ù‚Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ„Ù…": " ÙÙŠ Ø­Ø§Ù„Ù‡ Ø§Ø®ØªÙŠØ§Ø± Ø´Ø±ÙƒØ© ÙŠØªÙ… ÙƒØªØ§Ø¨Ù‡ Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¶Ø±ÙŠØ¨ÙŠ Ø§Ù„Ù…ÙƒÙˆÙ† Ù…Ù† 9 Ø§Ø±Ù‚Ø§Ù… - ÙÙŠ Ø­Ø§Ù„Ù‡ Ø§Ø®ØªÙŠØ§Ø± Ø´Ø®ØµÙŠ ÙŠØªÙ… ÙƒØªØ§Ø¨Ù‡ 123456789 Ø§Ùˆ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ø§Ù† ÙˆØ¬Ø¯ ÙˆØ¨Ø¹Ø¯ Ø§Ù„Ø±ÙØ¹ ØªÙ‚ÙˆÙ… Ø¨Ø­Ø°ÙÙ‡  ÙˆØ§Ù„Ø§Ø¬Ù†Ø¨ÙŠ Ù†ÙØ³ Ø§Ù„Ù†Ø¸Ø§Ù… ",
    "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…": "ØºÙŠØ± Ù…Ø·Ù„ÙˆØ¨ ÙÙŠ Ø­Ø§Ù„Ù‡ ÙƒØªØ§Ø¨Ù‡ Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„",
    "Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªÙ„Ù…": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©: B Ù„Ø´Ø±ÙƒØ©ØŒ P Ù„Ø´Ø®ØµÙŠØŒ F Ù„Ø£Ø¬Ù†Ø¨ÙŠ.",
    "Ø¯ÙˆÙ„Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù…": "ØºÙŠØ± Ù…Ø·Ù„ÙˆØ¨ ÙÙŠ Ø­Ø§Ù„Ù‡ ÙƒØªØ§Ø¨Ù‡ Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„",
    "Ù…Ø­Ø§ÙØ¸Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù…": "ØºÙŠØ± Ù…Ø·Ù„ÙˆØ¨ ÙÙŠ Ø­Ø§Ù„Ù‡ ÙƒØªØ§Ø¨Ù‡ Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„",
    "Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù…": "ØºÙŠØ± Ù…Ø·Ù„ÙˆØ¨ ÙÙŠ Ø­Ø§Ù„Ù‡ ÙƒØªØ§Ø¨Ù‡ Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„",
    "Ø´Ø§Ø±Ø¹ Ø§Ù„Ù…Ø³ØªÙ„Ù…": "ØºÙŠØ± Ù…Ø·Ù„ÙˆØ¨ ÙÙŠ Ø­Ø§Ù„Ù‡ ÙƒØªØ§Ø¨Ù‡ Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„",
    "Ù…Ø¨Ù†Ù‰ Ø§Ù„Ù…Ø³ØªÙ„Ù…": "ØºÙŠØ± Ù…Ø·Ù„ÙˆØ¨ ÙÙŠ Ø­Ø§Ù„Ù‡ ÙƒØªØ§Ø¨Ù‡ Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„",
    "ÙˆØµÙ Ø§Ù„ØµÙ†Ù": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ø³Ù… Ø£Ùˆ ÙˆØµÙ ÙˆØ§Ø¶Ø­ Ù„Ù„Ø³Ù„Ø¹Ø© Ø£Ùˆ Ø§Ù„Ø®Ø¯Ù…Ø© Ø§Ù„Ù…Ø¨Ø§Ø¹Ø©.",
    "Ù†ÙˆØ¹ ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù": "ÙÙŠ Ø­Ø§Ù„Ù‡ Ø§Ø®ØªÙŠØ§Ø± GS1  ÙŠØªÙ… ÙƒØªØ§Ø¨Ù‡ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠ Ù…Ø«Ø§Ù„ : - 10007598 Ø§Ù… ÙÙŠ Ø­Ø§Ù„Ù‡ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙƒÙˆØ¯ EGS  ÙŠØªÙ… ÙƒØªØ§Ø¨Ù‡ Ø§Ù„ÙƒÙˆØ¯ EG-Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„-Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ù…Ø«Ø§Ù„ EG-123456789-100",
    "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù": "ÙÙŠ Ø­Ø§Ù„Ù‡ Ø§Ù„Ø§ÙŠØµØ§Ù„Ø§Øª Ù…Ø·Ù„ÙˆØ¨ Ø§Ø¬Ø¨Ø§Ø±ÙŠ ÙƒØªØ§Ø¨Ù‡ Ø§Ù„ÙƒÙˆØ¯ Ù…Ø«Ø§Ù„ 1 Ø§Ù… ÙÙŠ Ø­Ø§Ù„Ù‡ Ø§Ù„ÙÙˆØ§ØªÙŠØ± ØºÙŠØ± Ù…Ø·Ù„ÙˆØ¨ ",
    "ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚ÙŠØ§Ø³": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ø®ØªØ± ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© (Ù…Ø«Ø§Ù„: Ù‚Ø·Ø¹Ø©).",
    Ø§Ù„ÙƒÙ…ÙŠØ©: "Ù…Ø·Ù„ÙˆØ¨: Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¨Ø§Ø¹ Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„ØµÙ†Ù.",
    "Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø©": "Ù…Ø·Ù„ÙˆØ¨: Ø³Ø¹Ø± Ø§Ù„Ù‚Ø·Ø¹Ø© Ø§Ù„ÙˆØ§Ø­Ø¯Ø© Ù…Ù† Ø§Ù„ØµÙ†Ù.",
    "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 1": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© (Ù…Ø«Ø§Ù„: Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©).",
    "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ 1": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ Ù„Ù„Ø¶Ø±ÙŠØ¨Ø© Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØªØ±Ø§Ø¨Ø·Ø©.",
    "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 1": "Ù…Ø·Ù„ÙˆØ¨: Ø£Ø¯Ø®Ù„ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© Ù„Ù„Ø¶Ø±ÙŠØ¨Ø© (Ù…Ø«Ø§Ù„: 14).",
    "UUID Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©": "Ù…Ø·Ù„ÙˆØ¨ Ù„Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª ÙÙ‚Ø·: Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ¹Ø±ÙŠÙÙŠ Ø§Ù„ÙØ±ÙŠØ¯ Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø¨ÙŠØ¹ Ø§Ù„Ø£ØµÙ„ÙŠØ©."
  };
  async function fn115() {
    const tmp855 = Array.from(document.querySelectorAll("#receiptEditorModal .receipt-checkbox:checked")).map(p430 => p430.closest("tbody"));
    if (tmp855.length === 0) {
      alert("ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ Ù…Ø³ØªÙ†Ø¯ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.");
      return null;
    }
    const tmp856 = await fetchTaxpayerInfo();
    const vO56 = {
      id: tmp856.id,
      name: document.getElementById("editor-seller-name").value,
      governate: document.getElementById("editor-seller-governate").value,
      regionCity: document.getElementById("editor-seller-regionCity").value,
      street: document.getElementById("editor-seller-street").value,
      buildingNumber: document.getElementById("editor-seller-building").value
    };
    const tmp857 = document.getElementById("pos-select-editor").value;
    const tmp858 = document.getElementById("activity-select-editor");
    const tmp859 = tmp858 ? tmp858.value : "4690";
    const vA47 = [];
    let tmp860 = (JSON.parse(localStorage.getItem("receiptHistory") || "[]")[0] || {}).uuid || "";
    for (const tmp861 of tmp855) {
      const tmp862 = tmp861.dataset.receiptNumber;
      const tmp863 = tmp861.dataset.docType;
      const tmp864 = receiptsMap.get(tmp862);
      const tmp865 = tmp863 === "return" ? fn127(tmp864, vO56, tmp857, tmp859) : fn49(tmp864, vO56, tmp857, tmp859);
      tmp865.header.previousUUID = tmp860;
      const tmp866 = JSON.stringify({
        receipts: [tmp865]
      });
      const tmp867 = await vF.computeUuidFromRawText(tmp866);
      tmp865.header.uuid = tmp867;
      vA47.push(tmp865);
      tmp860 = tmp867;
    }
    return {
      receipts: vA47
    };
  }
  async function fn116(p431) {
    const tmp868 = document.getElementById("receiptUploaderTabbedUI");
    if (tmp868) {
      tmp868.style.display = "none";
    }
    const tmp869 = p431.target.files[0];
    if (!tmp869) {
      return;
    }
    const vF743 = fn74("Ø¬Ø§Ø±ÙŠ Ù‚Ø±Ø§Ø¡Ø© ÙˆØªØ±Ø¬Ù…Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥ÙŠØµØ§Ù„...");
    try {
      const tmp870 = new ExcelJS.Workbook();
      await tmp870.xlsx.load(await tmp869.arrayBuffer());
      const tmp871 = tmp870.getWorksheet(1);
      const tmp872 = tmp871.getRow(1).values.slice(1).map(p432 => String(p432 || "").trim());
      const vA48 = [];
      tmp871.eachRow({
        includeEmpty: false
      }, (p433, p434) => {
        if (p434 > 1) {
          const vO57 = {};
          p433.values.slice(1).forEach((p435, p436) => {
            const tmp873 = tmp872[p436];
            if (tmp873) {
              vO57[tmp873] = p435 ?? "";
            }
          });
          vA48.push(vO57);
        }
      });
      if (vA48.length === 0) {
        throw new Error("Ù…Ù„Ù Ø§Ù„Ø¥ÙƒØ³Ù„ ÙØ§Ø±Øº!");
      }
      const vO58 = {
        "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø± (YYYY-MM-DD)": "dateTimeIssued",
        "Ø±Ù‚Ù… Ø§Ù„Ø¥ÙŠØµØ§Ù„ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ (*)": "receiptNumber",
        "Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)": "buyerName",
        "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ù„Ù„Ø¹Ù…ÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)": "buyerId",
        "Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ù„Ù„ØµÙ†Ù": "internalCode",
        "ÙˆØµÙ Ø§Ù„ØµÙ†Ù (*)": "description",
        "Ù†ÙˆØ¹ ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (*)": "itemType",
        "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (*)": "itemCode",
        "ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ (*)": "unitType",
        "Ø§Ù„ÙƒÙ…ÙŠØ© (*)": "quantity",
        "Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø© (*)": "unitPrice",
        "Ø¹Ù…Ù„Ø© Ø§Ù„Ø¨ÙŠØ¹": "currencySold",
        "Ø³Ø¹Ø± Ø§Ù„ØµØ±Ù": "exchangeRate",
        "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 1 (*)": "taxType_1",
        "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ Ù„Ù„Ø¶Ø±ÙŠØ¨Ø© 1 (*)": "taxSubType_1",
        "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 1 (*)": "taxRate_1",
        "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 2 (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)": "taxType_2",
        "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ Ù„Ù„Ø¶Ø±ÙŠØ¨Ø© 2 (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)": "taxSubType_2",
        "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 2 (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)": "taxRate_2"
      };
      const tmp874 = vA48.map(p437 => {
        const vO59 = {};
        for (const tmp875 in p437) {
          const tmp876 = vO58[tmp875.trim()];
          if (tmp876) {
            let tmp877 = p437[tmp875];
            if (tmp876 === "unitType" && vO63.units[tmp877]) {
              tmp877 = vO63.units[tmp877];
            } else if (tmp876 === "currencySold" && vO.currencies[tmp877]) {
              tmp877 = vO.currencies[tmp877];
            } else if (tmp876.startsWith("taxType_") && vO63.taxTypes[tmp877]) {
              tmp877 = vO63.taxTypes[tmp877];
            } else if (tmp876.startsWith("taxSubType_") && vO63.taxSubtypes[tmp877]) {
              tmp877 = vO63.taxSubtypes[tmp877];
            }
            vO59[tmp876] = tmp877;
          }
        }
        return vO59;
      });
      const tmp878 = new Map();
      let tmp879 = null;
      let vO60 = {};
      tmp874.forEach(p438 => {
        if (!p438.description && !p438.itemCode) {
          return;
        }
        const tmp880 = String(p438.receiptNumber || "").trim();
        if (tmp880) {
          tmp879 = tmp880;
          vO60 = {
            dateTimeIssued: p438.dateTimeIssued,
            buyerName: p438.buyerName,
            buyerId: p438.buyerId
          };
          if (!tmp878.has(tmp879)) {
            tmp878.set(tmp879, []);
          }
        }
        if (!tmp879) {
          return;
        }
        const vO61 = {
          ...vO60,
          ...p438
        };
        tmp878.get(tmp879).push(vO61);
      });
      vF743.querySelector("#toast-message").textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø£ÙƒÙˆØ§Ø¯...";
      const {
        validatedMap: _0x348b52,
        validationErrors: _0x4e0bd7
      } = await fn113(tmp878);
      vF743.remove();
      if (_0x4e0bd7.length > 0) {
        fn122(_0x4e0bd7, () => {
          fn47(_0x348b52, "sale");
        });
      } else {
        fn47(_0x348b52, "sale");
      }
    } catch (e54) {
      alert("âŒ Ø®Ø·Ø£ ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…Ù„Ù Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª: " + e54.message);
    } finally {
      if (vF743) {
        vF743.remove();
      }
      p431.target.value = "";
    }
  }
  function fn122(p439) {
    document.getElementById("invoiceErrorModal")?.remove();
    const tmp881 = document.createElement("div");
    tmp881.id = "invoiceErrorModal";
    tmp881.style.cssText = "\n        position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n        background-color: rgba(0,0,0,0.6); z-index: 10002;\n        display: flex; align-items: center; justify-content: center;\n        direction: rtl; font-family: 'Segoe UI', Tahoma, sans-serif;\n    ";
    tmp881.innerHTML = "\n        <div style=\"background: #fff; width: 800px; max-width: 90%; max-height: 80%; border-radius: 10px; display: flex; flex-direction: column; box-shadow: 0 5px 20px rgba(0,0,0,0.3); animation: fadeIn 0.3s ease-out;\">\n            \n            <!-- Ø±Ø£Ø³ Ø§Ù„Ù†Ø§ÙØ°Ø© -->\n            <div style=\"padding: 15px 20px; background-color: #d9534f; color: white; border-top-left-radius: 10px; border-top-right-radius: 10px; display: flex; align-items: center; gap: 10px;\">\n                <span style=\"font-size: 24px;\">ğŸš¨</span>\n                <h3 style=\"margin: 0; font-size: 20px;\">ØªÙ… Ø§ÙƒØªØ´Ø§Ù Ø£Ø®Ø·Ø§Ø¡ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (" + p439.length + ")</h3>\n            </div>\n\n            <!-- Ø¬Ø³Ù… Ø§Ù„Ù†Ø§ÙØ°Ø© ÙˆØ¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ -->\n            <div style=\"overflow-y: auto; padding: 20px;\">\n                <p style=\"margin-top: 0; color: #333;\">\n                    ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„ØªØ§Ù„ÙŠØ© ÙˆØªØµØ­ÙŠØ­Ù‡Ø§ ÙÙŠ Ù…Ù„Ù Ø§Ù„Ø¥ÙƒØ³ÙŠÙ„ Ø«Ù… Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø±ÙØ¹.\n                </p>\n                <table style=\"width: 100%; border-collapse: collapse; font-size: 14px;\">\n                    <thead style=\"background-color: #f8f9fa; position: sticky; top: 0;\">\n                        <tr>\n                            <th style=\"padding: 10px; border: 1px solid #ddd; text-align: right;\">Ø§Ù„Ù…ÙØ¹Ø±Ù‘Ù (Ø§Ù„ÙØ§ØªÙˆØ±Ø©/Ø§Ù„Ø¨Ù†Ø¯)</th>\n                            <th style=\"padding: 10px; border: 1px solid #ddd; text-align: right;\">Ø§Ù„Ø­Ù‚Ù„</th>\n                            <th style=\"padding: 10px; border: 1px solid #ddd; text-align: right;\">Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®Ø§Ø·Ø¦Ø©</th>\n                            <th style=\"padding: 10px; border: 1px solid #ddd; text-align: right;\">Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        " + p439.map(p440 => "\n                            <tr style=\"background-color: #fff1f0;\">\n                                <td style=\"padding: 8px; border: 1px solid #ffccc7;\">" + (p440.id || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯") + "</td>\n                                <td style=\"padding: 8px; border: 1px solid #ffccc7;\"><strong>" + (p440.field || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯") + "</strong></td>\n                                <td style=\"padding: 8px; border: 1px solid #ffccc7; font-family: monospace; direction: ltr; text-align: left;\">" + (p440.value || "") + "</td>\n                                <td style=\"padding: 8px; border: 1px solid #ffccc7;\">" + (p440.message || "Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ") + "</td>\n                            </tr>\n                        ").join("") + "\n                    </tbody>\n                </table>\n            </div>\n\n            <!-- ØªØ°ÙŠÙŠÙ„ Ø§Ù„Ù†Ø§ÙØ°Ø© ÙˆØ§Ù„Ø£Ø²Ø±Ø§Ø± -->\n            <div style=\"padding: 15px 20px; text-align: left; border-top: 1px solid #eee; background-color: #f8f9fa; display: flex; justify-content: flex-end; align-items: center;\">\n                <button id=\"closeErrorModalBtn\" style=\"background: #6c757d; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.2s;\">\n                    Ø¥ØºÙ„Ø§Ù‚\n                </button>\n            </div>\n        </div>\n    ";
    document.body.appendChild(tmp881);
    const tmp882 = document.createElement("style");
    tmp882.id = "errorModalStyles";
    tmp882.innerText = "@keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } } #closeErrorModalBtn:hover { background-color: #5a6268; }";
    document.head.appendChild(tmp882);
    document.getElementById("closeErrorModalBtn").onclick = () => {
      tmp881.remove();
      tmp882.remove();
    };
  }
  function fn118() {
    const tmp883 = document.getElementById("etaExporterTabContent");
    if (!tmp883) {
      return;
    }
    tmp883.innerHTML = "\n        <div style=\"direction: rtl; text-align: right; padding: 15px; font-family: 'Segoe UI', Tahoma, sans-serif;\">\n            <h4 style=\"margin: 0 0 10px 0; color: #2161a1; border-bottom: 2px solid #ddd; padding-bottom: 10px;\">Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ÙÙˆØ§ØªÙŠØ± (Ù…Ø¹ Ø¯Ø¹Ù… Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ø¨Ù†ÙˆØ¯)</h4>\n            <p style=\"font-size: 14px; color: #555; line-height: 1.6;\">\n                Ù„Ø¥Ø¶Ø§ÙØ© Ø¹Ø¯Ø© Ø¨Ù†ÙˆØ¯ Ù„Ù†ÙØ³ Ø§Ù„ÙØ§ØªÙˆØ±Ø©ØŒ ÙƒØ±Ø± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ§ØªÙˆØ±Ø© (Ù…Ø«Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ ÙˆØ§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…) ÙÙŠ Ø¹Ø¯Ø© Ø³Ø·ÙˆØ± Ù…Ø¹ ØªØºÙŠÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¨Ù†Ø¯ ÙÙ‚Ø·.\n            </p>\n\n            <!-- âœ… --- Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„: Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Checkbox Ø¨Ù‚Ø§Ø¦Ù…Ø© Ù…Ù†Ø³Ø¯Ù„Ø© --- âœ… -->\n            <div style=\"background: #eef7ff; border: 1px solid #bde0ff; border-radius: 8px; padding: 15px; margin: 20px 0;\">\n                <label for=\"invoiceVersionSelect\" style=\"display: block; font-weight: bold; color: #0056b3; margin-bottom: 10px;\">1. Ø­Ø¯Ø¯ Ù†ÙˆØ¹ Ø§Ù„ÙØ§ØªÙˆØ±Ø© (Ø§Ù„Ø¥ØµØ¯Ø§Ø±):</label>\n                <select id=\"invoiceVersionSelect\" style=\"width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ccc; font-size: 16px;\">\n                    <option value=\"1.0\" selected>ÙØ§ØªÙˆØ±Ø© ÙƒØ§Ù…Ù„Ø© ÙˆÙ…ÙˆÙ‚Ø¹Ø© (Ø¥ØµØ¯Ø§Ø± 1.0)</option>\n                    <option value=\"0.9\">Ù…Ø³ÙˆØ¯Ø© ØºÙŠØ± Ù…ÙˆÙ‚Ø¹Ø© (Ø¥ØµØ¯Ø§Ø± 0.9)</option>\n                </select>\n                <p style=\"font-size: 13px; color: #0056b3; margin: 8px 5px 0 0;\">\n                    Ø§Ø®ØªØ± \"Ø¥ØµØ¯Ø§Ø± 1.0\" Ù„Ù„Ø­ÙØ¸ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØŒ Ø£Ùˆ \"Ø¥ØµØ¯Ø§Ø± 0.9\" Ø¥Ø°Ø§ ÙƒÙ†Øª ØªØ±ÙŠØ¯ Ø­ÙØ¸Ù‡Ø§ ÙƒÙ…Ø³ÙˆØ¯Ø© Ø¨Ø¯ÙˆÙ† ØªÙˆÙ‚ÙŠØ¹ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ.\n                </p>\n            </div>\n            <!-- âœ… --- Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ --- âœ… -->\n\n            <div style=\"margin: 20px 0; display: flex; gap: 15px;\">\n                <button id=\"downloadTemplateBtn_v3\" style=\"padding: 10px 15px; background-color: #17a2b8; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; flex-grow: 1;\">\n                    ğŸ“¥ 2. ØªØ­Ù…ÙŠÙ„ Ù†Ù…ÙˆØ°Ø¬ Excel\n                </button>\n                <label for=\"excelUploadInput_v3\" style=\"padding: 10px 15px; background-color: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; flex-grow: 1; text-align: center;\">\n                    ğŸ“‚ 3. Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù Ù„Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ÙˆØ§Ù„Ø­ÙØ¸\n                </label>\n                <input type=\"file\" id=\"excelUploadInput_v3\" accept=\".xlsx, .xls\" style=\"display: none;\">\n            </div>\n        </div>\n    ";
    document.getElementById("downloadTemplateBtn_v3").addEventListener("click", fn119);
    document.getElementById("excelUploadInput_v3").addEventListener("change", handleExcelFileUpload);
  }
  const vA49 = [{
    code: "EGP",
    desc: "Ø¬Ù†ÙŠÙ‡ Ù…ØµØ±ÙŠ"
  }, {
    code: "USD",
    desc: "Ø¯ÙˆÙ„Ø§Ø± Ø£Ù…Ø±ÙŠÙƒÙŠ"
  }, {
    code: "EUR",
    desc: "ÙŠÙˆØ±Ùˆ"
  }, {
    code: "GBP",
    desc: "Ø¬Ù†ÙŠÙ‡ Ø¥Ø³ØªØ±Ù„ÙŠÙ†ÙŠ"
  }, {
    code: "SAR",
    desc: "Ø±ÙŠØ§Ù„ Ø³Ø¹ÙˆØ¯ÙŠ"
  }];
  const vA50 = [{
    code: "B",
    desc: "Ø´Ø±ÙƒØ©"
  }, {
    code: "P",
    desc: "Ø´Ø®ØµÙŠ"
  }, {
    code: "F",
    desc: "Ø£Ø¬Ù†Ø¨ÙŠ"
  }];
  const vA51 = [{
    code: "EGS",
    desc: "EGS"
  }, {
    code: "GS1",
    desc: "GS1"
  }];
  const vA52 = [{
    code: "EG",
    Desc_ar: "Ù…ØµØ±"
  }, {
    code: "AD",
    Desc_ar: "Ø£Ù†Ø¯ÙˆØ±Ø§"
  }, {
    code: "AE",
    Desc_ar: "Ø§Ù„Ø§Ù…Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ù…ØªØ­Ø¯Ø©"
  }, {
    code: "TR",
    Desc_ar: "ØªØ±ÙƒÙŠØ§"
  }, {
    code: "DE",
    Desc_ar: "Ø£Ù„Ù…Ø§Ù†ÙŠØ§"
  }, {
    code: "SG",
    Desc_ar: "Ø³Ù†ØºØ§ÙÙˆØ±Ø©"
  }, {
    code: "US",
    Desc_ar: "Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ù…ØªØ­Ø¯Ø©"
  }, {
    code: "ES",
    Desc_ar: "Ø£Ø³Ø¨Ø§Ù†ÙŠØ§"
  }, {
    code: "NZ",
    Desc_ar: "Ù†ÙŠÙˆØ²ÙŠÙ„Ø§Ù†Ø¯Ø§"
  }, {
    code: "RU",
    Desc_ar: "Ø±ÙˆØ³ÙŠØ§"
  }, {
    code: "OM",
    Desc_ar: "Ø¹Ù…Ø§Ù†"
  }, {
    code: "KP",
    Desc_ar: "ÙƒÙˆØ±ÙŠØ§ Ø§Ù„Ø´Ù…Ø§Ù„ÙŠØ©"
  }, {
    code: "KR",
    Desc_ar: "ÙƒÙˆØ±ÙŠØ§ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©"
  }, {
    code: "MH",
    Desc_ar: "Ø¬Ø²Ø± Ù…Ø§Ø±Ø´Ø§Ù„"
  }, {
    code: "AF",
    Desc_ar: "Ø£ÙØºØ§Ù†Ø³ØªØ§Ù†"
  }, {
    code: "AG",
    Desc_ar: "Ø£Ù†ØªÙŠØºÙˆØ§ ÙˆØ¨Ø§Ø±Ø¨ÙˆØ¯Ø§"
  }, {
    code: "AI",
    Desc_ar: "Ø£Ù†Ø¬ÙˆÙŠÙ„Ø§"
  }, {
    code: "AL",
    Desc_ar: "Ø£Ù„Ø¨Ø§Ù†ÙŠØ§"
  }, {
    code: "AM",
    Desc_ar: "Ø£Ø±Ù…ÙŠÙ†ÙŠØ§"
  }, {
    code: "AO",
    Desc_ar: "Ø£Ù†Ø¬ÙˆÙ„Ø§"
  }, {
    code: "AQ",
    Desc_ar: "Ø§Ù„Ù‚Ø§Ø±Ø© Ø§Ù„Ù‚Ø·Ø¨ÙŠØ© Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©"
  }, {
    code: "AR",
    Desc_ar: "Ø§Ù„Ø£Ø±Ø¬Ù†ØªÙŠÙ†"
  }, {
    code: "AS",
    Desc_ar: "Ø³Ø§Ù…ÙˆØ§ Ø§Ù„Ø£Ù…Ø±ÙŠÙƒÙŠØ©"
  }, {
    code: "AT",
    Desc_ar: "Ø§Ù„Ù†Ù…Ø³Ø§"
  }, {
    code: "AU",
    Desc_ar: "Ø£Ø³ØªØ±Ø§Ù„ÙŠØ§"
  }, {
    code: "AW",
    Desc_ar: "Ø¢Ø±ÙˆØ¨Ø§"
  }, {
    code: "AX",
    Desc_ar: "Ø¬Ø²Ø± Ø£ÙˆÙ„Ø§Ù†"
  }, {
    code: "AZ",
    Desc_ar: "Ø£Ø°Ø±Ø¨ÙŠØ¬Ø§Ù†"
  }, {
    code: "BA",
    Desc_ar: "Ø§Ù„Ø¨ÙˆØ³Ù†Ø© ÙˆØ§Ù„Ù‡Ø±Ø³Ùƒ"
  }, {
    code: "BB",
    Desc_ar: "Ø¨Ø±Ø¨Ø§Ø¯ÙˆØ³"
  }, {
    code: "BD",
    Desc_ar: "Ø¨Ù†Ø¬Ù„Ø§Ø¯ÙŠØ´"
  }, {
    code: "BE",
    Desc_ar: "Ø¨Ù„Ø¬ÙŠÙƒØ§"
  }, {
    code: "BF",
    Desc_ar: "Ø¨ÙˆØ±ÙƒÙŠÙ†Ø§ ÙØ§Ø³Ùˆ"
  }, {
    code: "BG",
    Desc_ar: "Ø¨Ù„ØºØ§Ø±ÙŠØ§"
  }, {
    code: "BH",
    Desc_ar: "Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†"
  }, {
    code: "BI",
    Desc_ar: "Ø¨ÙˆØ±ÙˆÙ†Ø¯ÙŠ"
  }, {
    code: "BJ",
    Desc_ar: "Ø¨Ù†ÙŠÙ†"
  }, {
    code: "BL",
    Desc_ar: "Ø³Ø§Ù† Ø¨Ø§Ø±ØªÙŠÙ„Ù…ÙŠ"
  }, {
    code: "BM",
    Desc_ar: "Ø¨Ø±Ù…ÙˆØ¯Ø§"
  }, {
    code: "BN",
    Desc_ar: "Ø¨Ø±ÙˆÙ†Ø§ÙŠ"
  }, {
    code: "BO",
    Desc_ar: "Ø¨ÙˆÙ„ÙŠÙÙŠØ§"
  }, {
    code: "BQ",
    Desc_ar: "Ø§Ù„Ø¬Ø²Ø± Ø§Ù„ÙƒØ§Ø±ÙŠØ¨ÙŠØ© Ø§Ù„Ù‡ÙˆÙ„Ù†Ø¯ÙŠØ©"
  }, {
    code: "BR",
    Desc_ar: "Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„"
  }, {
    code: "BS",
    Desc_ar: "Ø§Ù„Ø¨Ø§Ù‡Ø§Ù…Ø§"
  }, {
    code: "BT",
    Desc_ar: "Ø¨ÙˆØªØ§Ù†"
  }, {
    code: "BV",
    Desc_ar: "Ø¬Ø²ÙŠØ±Ø© Ø¨ÙˆÙÙŠÙ‡"
  }, {
    code: "BW",
    Desc_ar: "Ø¨ØªØ³ÙˆØ§Ù†Ø§"
  }, {
    code: "BY",
    Desc_ar: "Ø±ÙˆØ³ÙŠØ§ Ø§Ù„Ø¨ÙŠØ¶Ø§Ø¡"
  }, {
    code: "BZ",
    Desc_ar: "Ø¨Ù„ÙŠØ²"
  }, {
    code: "CA",
    Desc_ar: "ÙƒÙ†Ø¯Ø§"
  }, {
    code: "CC",
    Desc_ar: "Ø¬Ø²Ø± ÙƒÙˆÙƒÙˆØ³"
  }, {
    code: "CD",
    Desc_ar: "Ø¬Ù…Ù‡ÙˆØ±ÙŠØ© Ø§Ù„ÙƒÙˆÙ†ØºÙˆ Ø§Ù„Ø¯ÙŠÙ…Ù‚Ø±Ø§Ø·ÙŠØ©"
  }, {
    code: "CF",
    Desc_ar: "Ø¬Ù…Ù‡ÙˆØ±ÙŠØ© Ø£ÙØ±ÙŠÙ‚ÙŠØ§ Ø§Ù„ÙˆØ³Ø·Ù‰"
  }, {
    code: "CG",
    Desc_ar: "Ø¬Ù…Ù‡ÙˆØ±ÙŠØ© Ø§Ù„ÙƒÙˆÙ†ØºÙˆ"
  }, {
    code: "CH",
    Desc_ar: "Ø³ÙˆÙŠØ³Ø±Ø§"
  }, {
    code: "CI",
    Desc_ar: "Ø³Ø§Ø­Ù„ Ø§Ù„Ø¹Ø§Ø¬"
  }, {
    code: "CK",
    Desc_ar: "Ø¬Ø²Ø± ÙƒÙˆÙƒ"
  }, {
    code: "CL",
    Desc_ar: "Ø´ÙŠÙ„ÙŠ"
  }, {
    code: "CM",
    Desc_ar: "Ø§Ù„ÙƒØ§Ù…ÙŠØ±ÙˆÙ†"
  }, {
    code: "CN",
    Desc_ar: "Ø§Ù„ØµÙŠÙ†"
  }, {
    code: "CO",
    Desc_ar: "ÙƒÙˆÙ„ÙˆÙ…Ø¨ÙŠØ§"
  }, {
    code: "CR",
    Desc_ar: "ÙƒÙˆØ³ØªØ§Ø±ÙŠÙƒØ§"
  }, {
    code: "CU",
    Desc_ar: "ÙƒÙˆØ¨Ø§"
  }, {
    code: "CV",
    Desc_ar: "Ø§Ù„Ø±Ø£Ø³ Ø§Ù„Ø£Ø®Ø¶Ø±"
  }, {
    code: "CW",
    Desc_ar: "ÙƒÙˆØ±Ø§Ø³Ø§Ùˆ"
  }, {
    code: "CX",
    Desc_ar: "Ø¬Ø²ÙŠØ±Ø© Ø¹ÙŠØ¯ Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯"
  }, {
    code: "CY",
    Desc_ar: "Ù‚Ø¨Ø±Øµ"
  }, {
    code: "CZ",
    Desc_ar: "Ø¬Ù…Ù‡ÙˆØ±ÙŠØ© Ø§Ù„ØªØ´ÙŠÙƒ"
  }, {
    code: "DE",
    Desc_ar: "Ø£Ù„Ù…Ø§Ù†ÙŠØ§"
  }, {
    code: "DJ",
    Desc_ar: "Ø¬ÙŠØ¨ÙˆØªÙŠ"
  }, {
    code: "DK",
    Desc_ar: "Ø§Ù„Ø¯Ø§Ù†Ù…Ø±Ùƒ"
  }, {
    code: "DM",
    Desc_ar: "Ø¯ÙˆÙ…ÙŠÙ†ÙŠÙƒØ§"
  }, {
    code: "DO",
    Desc_ar: "Ø¬Ù…Ù‡ÙˆØ±ÙŠØ© Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†ÙŠÙƒØ§Ù†"
  }, {
    code: "DZ",
    Desc_ar: "Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±"
  }, {
    code: "EC",
    Desc_ar: "Ø§Ù„Ø§ÙƒÙˆØ§Ø¯ÙˆØ±"
  }, {
    code: "EE",
    Desc_ar: "Ø§Ø³ØªÙˆÙ†ÙŠØ§"
  }, {
    code: "EH",
    Desc_ar: "Ø§Ù„ØµØ­Ø±Ø§Ø¡ Ø§Ù„ØºØ±Ø¨ÙŠØ©"
  }, {
    code: "ER",
    Desc_ar: "Ø§Ø±ÙŠØªØ±ÙŠØ§"
  }, {
    code: "ES",
    Desc_ar: "Ø£Ø³Ø¨Ø§Ù†ÙŠØ§"
  }, {
    code: "ET",
    Desc_ar: "Ø§Ø«ÙŠÙˆØ¨ÙŠØ§"
  }, {
    code: "FI",
    Desc_ar: "ÙÙ†Ù„Ù†Ø¯Ø§"
  }, {
    code: "FJ",
    Desc_ar: "ÙÙŠØ¬ÙŠ"
  }, {
    code: "FK",
    Desc_ar: "Ø¬Ø²Ø± ÙÙˆÙƒÙ„Ø§Ù†Ø¯"
  }, {
    code: "FM",
    Desc_ar: "Ù…ÙŠÙƒØ±ÙˆÙ†ÙŠØ²ÙŠØ§"
  }, {
    code: "FO",
    Desc_ar: "Ø¬Ø²Ø± ÙØ§Ø±Ùˆ"
  }, {
    code: "FR",
    Desc_ar: "ÙØ±Ù†Ø³Ø§"
  }, {
    code: "GA",
    Desc_ar: "Ø§Ù„Ø¬Ø§Ø¨ÙˆÙ†"
  }, {
    code: "GB",
    Desc_ar: "Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ù…ØªØ­Ø¯Ø©"
  }, {
    code: "GD",
    Desc_ar: "Ø¬Ø±ÙŠÙ†Ø§Ø¯Ø§"
  }, {
    code: "GE",
    Desc_ar: "Ø¬ÙˆØ±Ø¬ÙŠØ§"
  }, {
    code: "GF",
    Desc_ar: "ØºÙˆÙŠØ§Ù†Ø§ Ø§Ù„ÙØ±Ù†Ø³ÙŠØ©"
  }, {
    code: "GG",
    Desc_ar: "Ø¬ÙŠØ±Ù†Ø²ÙŠ"
  }, {
    code: "GH",
    Desc_ar: "ØºØ§Ù†Ø§"
  }, {
    code: "GI",
    Desc_ar: "Ø¬Ø¨Ù„ Ø·Ø§Ø±Ù‚"
  }, {
    code: "GL",
    Desc_ar: "Ø¬Ø±ÙŠÙ†Ù„Ø§Ù†Ø¯"
  }, {
    code: "GM",
    Desc_ar: "ØºØ§Ù…Ø¨ÙŠØ§"
  }, {
    code: "GN",
    Desc_ar: "ØºÙŠÙ†ÙŠØ§"
  }, {
    code: "GP",
    Desc_ar: "Ø¬ÙˆØ§Ø¯Ù„ÙˆØ¨"
  }, {
    code: "GQ",
    Desc_ar: "ØºÙŠÙ†ÙŠØ§ Ø§Ù„Ø§Ø³ØªÙˆØ§Ø¦ÙŠØ©"
  }, {
    code: "GR",
    Desc_ar: "Ø§Ù„ÙŠÙˆÙ†Ø§Ù†"
  }, {
    code: "GS",
    Desc_ar: "Ø¬ÙˆØ±Ø¬ÙŠØ§ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ© ÙˆØ¬Ø²Ø± Ø³Ø§Ù†Ø¯ÙˆÙŠØªØ´ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©"
  }, {
    code: "GT",
    Desc_ar: "Ø¬ÙˆØ§ØªÙŠÙ…Ø§Ù„Ø§"
  }, {
    code: "GU",
    Desc_ar: "Ø¬ÙˆØ§Ù…"
  }, {
    code: "GW",
    Desc_ar: "ØºÙŠÙ†ÙŠØ§ Ø¨ÙŠØ³Ø§Ùˆ"
  }, {
    code: "GY",
    Desc_ar: "ØºÙŠØ§Ù†Ø§"
  }, {
    code: "HK",
    Desc_ar: "Ù‡ÙˆÙ†Øº ÙƒÙˆÙ†Øº"
  }, {
    code: "HM",
    Desc_ar: "Ø¬Ø²ÙŠØ±Ø© Ù‡ÙŠØ±Ø¯ ÙˆØ¬Ø²Ø± Ù…Ø§ÙƒØ¯ÙˆÙ†Ø§Ù„Ø¯"
  }, {
    code: "HN",
    Desc_ar: "Ù‡Ù†Ø¯ÙˆØ±Ø§Ø³"
  }, {
    code: "HR",
    Desc_ar: "ÙƒØ±ÙˆØ§ØªÙŠØ§"
  }, {
    code: "HT",
    Desc_ar: "Ù‡Ø§ÙŠØªÙŠ"
  }, {
    code: "HU",
    Desc_ar: "Ø§Ù„Ù…Ø¬Ø±"
  }, {
    code: "ID",
    Desc_ar: "Ø§Ù†Ø¯ÙˆÙ†ÙŠØ³ÙŠØ§"
  }, {
    code: "IE",
    Desc_ar: "Ø£ÙŠØ±Ù„Ù†Ø¯Ø§"
  }, {
    code: "IL",
    Desc_ar: "Ø§Ø³Ø±Ø§Ø¦ÙŠÙ„"
  }, {
    code: "IM",
    Desc_ar: "Ø¬Ø²ÙŠØ±Ø© Ù…Ø§Ù†"
  }, {
    code: "IN",
    Desc_ar: "Ø§Ù„Ù‡Ù†Ø¯"
  }, {
    code: "IO",
    Desc_ar: "Ø¥Ù‚Ù„ÙŠÙ… Ø§Ù„Ù…Ø­ÙŠØ· Ø§Ù„Ù‡Ù†Ø¯ÙŠ Ø§Ù„Ø¨Ø±ÙŠØ·Ø§Ù†ÙŠ"
  }, {
    code: "IQ",
    Desc_ar: "Ø§Ù„Ø¹Ø±Ø§Ù‚"
  }, {
    code: "IR",
    Desc_ar: "Ø§ÙŠØ±Ø§Ù†"
  }, {
    code: "IS",
    Desc_ar: "Ø£ÙŠØ³Ù„Ù†Ø¯Ø§"
  }, {
    code: "IT",
    Desc_ar: "Ø§ÙŠØ·Ø§Ù„ÙŠØ§"
  }, {
    code: "JE",
    Desc_ar: "Ø¬ÙŠØ±Ø³ÙŠ"
  }, {
    code: "JM",
    Desc_ar: "Ø¬Ø§Ù…Ø§ÙŠÙƒØ§"
  }, {
    code: "JO",
    Desc_ar: "Ø§Ù„Ø£Ø±Ø¯Ù†"
  }, {
    code: "JP",
    Desc_ar: "Ø§Ù„ÙŠØ§Ø¨Ø§Ù†"
  }, {
    code: "KE",
    Desc_ar: "ÙƒÙŠÙ†ÙŠØ§"
  }, {
    code: "KG",
    Desc_ar: "Ù‚Ø±ØºÙŠØ²Ø³ØªØ§Ù†"
  }];
  const vA53 = [{
    code: "EA",
    desc_ar: "Ù‚Ø·Ø¹Ø©"
  }, {
    code: "KGM",
    desc_ar: "ÙƒÙŠÙ„ÙˆØ¬Ø±Ø§Ù…"
  }, {
    code: "LTR",
    desc_ar: "Ù„ØªØ±"
  }, {
    code: "MTR",
    desc_ar: "Ù…ØªØ±"
  }, {
    code: "TNE",
    desc_ar: "Ø·Ù†"
  }, {
    code: "BOX",
    desc_ar: "ØµÙ†Ø¯ÙˆÙ‚"
  }, {
    code: "CT",
    desc_ar: "ÙƒØ±ØªÙˆÙ†Ø©"
  }, {
    code: "PK",
    desc_ar: "Ø¹Ù„Ø¨Ø©"
  }, {
    code: "SET",
    desc_ar: "Ù…Ø¬Ù…ÙˆØ¹Ø©"
  }, {
    code: "RO",
    desc_ar: "Ù„ÙØ©"
  }, {
    code: "2Z",
    desc_ar: "Ù…ÙŠÙ„ÙŠÙÙˆÙ„Øª"
  }, {
    code: "4K",
    desc_ar: "Ù…ÙŠÙ„ÙŠ Ø£Ù…Ø¨ÙŠØ±"
  }, {
    code: "4O",
    desc_ar: "Ù…ÙŠÙƒØ±ÙˆÙØ§Ø±Ø§Ø¯"
  }, {
    code: "A87",
    desc_ar: "Ø¬ÙŠØ¬Ø§ Ø£ÙˆÙ…"
  }, {
    code: "A93",
    desc_ar: "Ø¬Ø±Ø§Ù… Ù„ÙƒÙ„ Ù…ØªØ± Ù…ÙƒØ¹Ø¨"
  }, {
    code: "A94",
    desc_ar: "Ø¬Ø±Ø§Ù… Ù„ÙƒÙ„ Ø³Ù… Ù…ÙƒØ¹Ø¨"
  }, {
    code: "AMP",
    desc_ar: "Ø£Ù…Ø¨ÙŠØ±"
  }, {
    code: "ANN",
    desc_ar: "Ø³Ù†Ø©"
  }, {
    code: "B22",
    desc_ar: "ÙƒÙŠÙ„Ùˆ Ø£Ù…Ø¨ÙŠØ±"
  }, {
    code: "B49",
    desc_ar: "ÙƒÙŠÙ„Ùˆ Ø£ÙˆÙ…"
  }, {
    code: "B75",
    desc_ar: "Ù…ÙŠØ¬Ø§ Ø£ÙˆÙ…"
  }, {
    code: "B78",
    desc_ar: "Ù…ÙŠØ¬Ø§ ÙÙˆÙ„Øª"
  }, {
    code: "B84",
    desc_ar: "Ù…ÙŠÙƒØ±Ùˆ Ø£Ù…Ø¨ÙŠØ±"
  }, {
    code: "BAR",
    desc_ar: "Ø¨Ø§Ø±"
  }, {
    code: "BBL",
    desc_ar: "Ø¨Ø±Ù…ÙŠÙ„"
  }, {
    code: "BG",
    desc_ar: "Ø´Ù†Ø·Ø©"
  }, {
    code: "BO",
    desc_ar: "Ø²Ø¬Ø§Ø¬Ø©"
  }, {
    code: "C10",
    desc_ar: "Ù…ÙŠÙ„ÙŠ ÙØ§Ø±Ø§Ø¯"
  }, {
    code: "C39",
    desc_ar: "Ù†Ø§Ù†Ùˆ Ø£Ù…Ø¨ÙŠØ±"
  }, {
    code: "C41",
    desc_ar: "Ù†Ø§Ù†Ùˆ ÙØ§Ø±Ø§Ø¯"
  }, {
    code: "C45",
    desc_ar: "Ù†Ø§Ù†Ùˆ Ù…ØªØ±"
  }, {
    code: "C62",
    desc_ar: "ÙˆØ­Ø¯Ø© Ù†Ø´Ø§Ø·"
  }, {
    code: "CA",
    desc_ar: "Ø¹Ø¨ÙˆØ©"
  }, {
    code: "CMK",
    desc_ar: "Ø³Ù…Â²"
  }, {
    code: "CMQ",
    desc_ar: "Ø³Ù…Â³"
  }, {
    code: "CMT",
    desc_ar: "Ø³Ù…"
  }, {
    code: "CS",
    desc_ar: "ÙƒÙŠØ³ ÙƒØ±ØªÙˆÙ†"
  }, {
    code: "CTL",
    desc_ar: "Ø³Ù†ØªÙŠ Ù„ØªØ±"
  }, {
    code: "D10",
    desc_ar: "Ø³ÙŠÙ…Ù†Ø² Ù„ÙƒÙ„ Ù…ØªØ±"
  }, {
    code: "D33",
    desc_ar: "ØªØ³Ù„Ø§"
  }, {
    code: "D41",
    desc_ar: "Ø·Ù†/Ù…ØªØ± Ù…ÙƒØ¹Ø¨"
  }, {
    code: "DAY",
    desc_ar: "ÙŠÙˆÙ…"
  }, {
    code: "DMT",
    desc_ar: "Ø¯ÙŠØ³ÙŠ Ù…ØªØ±"
  }, {
    code: "DRM",
    desc_ar: "Ø£Ø³Ø·ÙˆØ§Ù†Ø©"
  }, {
    code: "FAR",
    desc_ar: "ÙØ§Ø±Ø§Ø¯"
  }, {
    code: "FOT",
    desc_ar: "Ù‚Ø¯Ù…"
  }, {
    code: "FTK",
    desc_ar: "Ù‚Ø¯Ù…Â²"
  }, {
    code: "FTQ",
    desc_ar: "Ù‚Ø¯Ù…Â³"
  }, {
    code: "G42",
    desc_ar: "Ù…ÙŠÙƒØ±Ùˆ Ø³ÙŠÙ…Ù†Ø² Ù„ÙƒÙ„ Ø³Ù…"
  }, {
    code: "GL",
    desc_ar: "Ø¬Ø±Ø§Ù…/Ù„ØªØ±"
  }, {
    code: "GLL",
    desc_ar: "Ø¬Ø§Ù„ÙˆÙ†"
  }, {
    code: "GM",
    desc_ar: "Ø¬Ø±Ø§Ù…/Ù…ØªØ±Â²"
  }, {
    code: "GPT",
    desc_ar: "Ø¬Ø§Ù„ÙˆÙ† Ù„ÙƒÙ„ Ø£Ù„Ù"
  }, {
    code: "GRM",
    desc_ar: "Ø¬Ø±Ø§Ù…"
  }, {
    code: "H63",
    desc_ar: "Ù…Ù„Ø¬Ù…/Ø³Ù…Â²"
  }, {
    code: "HHP",
    desc_ar: "Ø­ØµØ§Ù† Ù‡ÙŠØ¯Ø±ÙˆÙ„ÙŠÙƒÙŠ"
  }, {
    code: "HLT",
    desc_ar: "Ù‡ÙŠÙƒØªÙˆÙ„ØªØ±"
  }, {
    code: "HTZ",
    desc_ar: "Ù‡Ø±ØªØ²"
  }, {
    code: "HUR",
    desc_ar: "Ø³Ø§Ø¹Ø©"
  }, {
    code: "IE",
    desc_ar: "Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø´Ø®Ø§Øµ"
  }, {
    code: "INH",
    desc_ar: "Ø¨ÙˆØµØ©"
  }, {
    code: "INK",
    desc_ar: "Ø¨ÙˆØµØ©Â²"
  }, {
    code: "JOB",
    desc_ar: "Ù…Ù‡Ù…Ø© / Ø¹Ù…Ù„"
  }, {
    code: "KHZ",
    desc_ar: "ÙƒÙŠÙ„Ùˆ Ù‡Ø±ØªØ²"
  }, {
    code: "KMH",
    desc_ar: "ÙƒÙ…/Ø³"
  }, {
    code: "KMK",
    desc_ar: "ÙƒÙ…Â²"
  }, {
    code: "KMQ",
    desc_ar: "ÙƒØ¬Ù…/Ù…Â³"
  }, {
    code: "KMT",
    desc_ar: "ÙƒÙŠÙ„ÙˆÙ…ØªØ±"
  }, {
    code: "KSM",
    desc_ar: "ÙƒØ¬Ù…/Ù…Â²"
  }, {
    code: "KVT",
    desc_ar: "ÙƒÙŠÙ„Ùˆ ÙÙˆÙ„Øª"
  }, {
    code: "KWT",
    desc_ar: "ÙƒÙŠÙ„Ùˆ ÙˆØ§Øª"
  }, {
    code: "LB",
    desc_ar: "Ø±Ø·Ù„"
  }, {
    code: "LVL",
    desc_ar: "Ù…Ø³ØªÙˆÙ‰"
  }, {
    code: "MAW",
    desc_ar: "Ù…ÙŠØ¬Ø§ ÙˆØ§Øª"
  }, {
    code: "MGM",
    desc_ar: "Ù…Ù„Ø¬Ù…"
  }, {
    code: "MHZ",
    desc_ar: "Ù…ÙŠØ¬Ø§ Ù‡Ø±ØªØ²"
  }, {
    code: "MIN",
    desc_ar: "Ø¯Ù‚ÙŠÙ‚Ø©"
  }, {
    code: "MMK",
    desc_ar: "Ù…Ù…Â²"
  }, {
    code: "MMQ",
    desc_ar: "Ù…Ù…Â³"
  }, {
    code: "MMT",
    desc_ar: "Ù…Ù„Ù„ÙŠ Ù…ØªØ±"
  }, {
    code: "MON",
    desc_ar: "Ø´Ù‡Ø±"
  }, {
    code: "MTK",
    desc_ar: "Ù…Â²"
  }, {
    code: "MTQ",
    desc_ar: "Ù…Â³"
  }, {
    code: "OHM",
    desc_ar: "Ø£ÙˆÙ…"
  }, {
    code: "ONZ",
    desc_ar: "Ø£ÙˆÙ†ØµØ©"
  }, {
    code: "PAL",
    desc_ar: "Ø¨Ø§Ø³ÙƒØ§Ù„"
  }, {
    code: "PF",
    desc_ar: "Ø·Ø¨Ø§Ù„ÙŠ"
  }, {
    code: "SMI",
    desc_ar: "Ù…ÙŠÙ„"
  }, {
    code: "ST",
    desc_ar: "Ø·Ù† Ù‚ØµÙŠØ±"
  }, {
    code: "VLT",
    desc_ar: "ÙÙˆÙ„Øª"
  }, {
    code: "WEE",
    desc_ar: "Ø£Ø³Ø¨ÙˆØ¹"
  }, {
    code: "WTT",
    desc_ar: "ÙˆØ§Øª"
  }, {
    code: "X03",
    desc_ar: "Ù…ØªØ±/Ø³Ø§Ø¹Ø©"
  }, {
    code: "YDQ",
    desc_ar: "ÙŠØ§Ø±Ø¯Ø©Â³"
  }, {
    code: "YRD",
    desc_ar: "ÙŠØ§Ø±Ø¯Ø©"
  }, {
    code: "NMP",
    desc_ar: "Ø¹Ø¯Ø¯ Ø§Ù„Ø¨Ø§ÙƒØ§Øª"
  }, {
    code: "5I",
    desc_ar: "Ù‚Ø¯Ù… Ù‚ÙŠØ§Ø³ÙŠ"
  }, {
    code: "AE",
    desc_ar: "Ø£Ù…Ø¨ÙŠØ± Ù„ÙƒÙ„ Ù…ØªØ±"
  }, {
    code: "B4",
    desc_ar: "Ø¨Ø±Ù…ÙŠÙ„ Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±ÙŠ"
  }, {
    code: "BB",
    desc_ar: "Ø¨ÙŠØ² Ø¨ÙˆÙƒØ³"
  }, {
    code: "BD",
    desc_ar: "Ù„ÙˆØ­"
  }, {
    code: "BE",
    desc_ar: "Ø±Ø¨Ø·Ø©"
  }, {
    code: "BK",
    desc_ar: "Ø³Ù„Ø©"
  }, {
    code: "BL",
    desc_ar: "Ø¨Ø§Ù„Ø©"
  }, {
    code: "CH",
    desc_ar: "ÙƒÙˆÙ†ØªÙŠÙ†Ø±"
  }, {
    code: "CR",
    desc_ar: "Crate"
  }, {
    code: "DAA",
    desc_ar: "Ø¯ÙŠÙƒØ§Ø±"
  }, {
    code: "DTN",
    desc_ar: "Ø¯ÙŠØ³Ø·Ù†"
  }, {
    code: "DZN",
    desc_ar: "Ø¯Ø³ØªØ©"
  }, {
    code: "FP",
    desc_ar: "Ø±Ø·Ù„/Ù‚Ø¯Ù…Â²"
  }, {
    code: "HMT",
    desc_ar: "Ù‡ÙŠÙƒØªÙˆÙ…ØªØ±"
  }, {
    code: "INQ",
    desc_ar: "Ø¨ÙˆØµØ©Â³"
  }, {
    code: "KG",
    desc_ar: "ÙƒÙØ¬"
  }, {
    code: "KTM",
    desc_ar: "ÙƒÙ…"
  }, {
    code: "LO",
    desc_ar: "Ù„ÙˆØ·"
  }, {
    code: "MLT",
    desc_ar: "Ù…Ù„Ù„ÙŠÙ„ØªØ±"
  }, {
    code: "MT",
    desc_ar: "Ø­ØµÙŠØ±"
  }, {
    code: "NA",
    desc_ar: "Ù…Ù„Ø¬Ù…/ÙƒØ¬Ù…"
  }, {
    code: "NAR",
    desc_ar: "Ø¹Ø¯Ø¯ Ø§Ù„ÙˆØ­Ø¯Ø§Øª"
  }, {
    code: "NC",
    desc_ar: "Ø¹Ø±Ø¨ÙŠØ©"
  }, {
    code: "NE",
    desc_ar: "Ù„ØªØ± ØµØ§ÙÙ"
  }, {
    code: "NPL",
    desc_ar: "Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ø±ÙˆØ¯"
  }, {
    code: "NV",
    desc_ar: "Ù…Ø±ÙƒØ¨Ø©"
  }, {
    code: "PA",
    desc_ar: "Ø¨Ø§ÙƒÙŠØª"
  }, {
    code: "PG",
    desc_ar: "Ø·Ø¨Ù‚"
  }];
  const vO62 = {
    T1: {
      desc: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ù…Ø¶Ø§ÙØ©",
      subtypes: [{
        code: "V001",
        desc: "ØªØµØ¯ÙŠØ± Ù„Ù„Ø®Ø§Ø±Ø¬ (0%)"
      }, {
        code: "V002",
        desc: "ØªØµØ¯ÙŠØ± Ù…Ù†Ø§Ø·Ù‚ Ø­Ø±Ø© (0%)"
      }, {
        code: "V003",
        desc: "Ø³Ù„Ø¹Ø© Ø£Ùˆ Ø®Ø¯Ù…Ø© Ù…Ø¹ÙØ§Ø©"
      }, {
        code: "V004",
        desc: "Ø³Ù„Ø¹Ø© Ø£Ùˆ Ø®Ø¯Ù…Ø© ØºÙŠØ± Ø®Ø§Ø¶Ø¹Ø©"
      }, {
        code: "V005",
        desc: "Ø¥Ø¹ÙØ§Ø¡Ø§Øª Ø¯Ø¨Ù„ÙˆÙ…Ø§Ø³ÙŠØ©"
      }, {
        code: "V008",
        desc: "Ø¥Ø¹ÙØ§Ø¡Ø§Øª Ø®Ø§ØµØ©"
      }, {
        code: "V009",
        desc: "Ø³Ù„Ø¹ Ø¹Ø§Ù…Ø© (14%)"
      }, {
        code: "V010",
        desc: "Ù†Ø³Ø¨ Ø£Ø®Ø±Ù‰"
      }]
    },
    T2: {
      desc: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„ (Ù†Ø³Ø¨ÙŠØ©)",
      subtypes: [{
        code: "Tbl01",
        desc: "Ø¶Ø±ÙŠØ¨Ø© Ø¬Ø¯ÙˆÙ„ Ù†Ø³Ø¨ÙŠØ©"
      }]
    },
    T3: {
      desc: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¬Ø¯ÙˆÙ„ (Ø§Ù„Ù†ÙˆØ¹ÙŠØ©)",
      subtypes: [{
        code: "Tbl02",
        desc: "Ø¶Ø±ÙŠØ¨Ø© Ø¬Ø¯ÙˆÙ„ Ù†ÙˆØ¹ÙŠØ© (Ù‚Ø·Ø¹ÙŠØ©)"
      }]
    },
    T4: {
      desc: "Ø§Ù„Ø®ØµÙ… ØªØ­Øª Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©",
      subtypes: [{
        code: "W001",
        desc: "Ø§Ù„Ù…Ù‚Ø§ÙˆÙ„Ø§Øª"
      }, {
        code: "W002",
        desc: "Ø§Ù„ØªÙˆØ±ÙŠØ¯Ø§Øª"
      }, {
        code: "W003",
        desc: "Ø§Ù„Ù…Ø´ØªØ±ÙŠØ§Øª"
      }, {
        code: "W004",
        desc: "Ø§Ù„Ø®Ø¯Ù…Ø§Øª"
      }, {
        code: "W010",
        desc: "Ø£ØªØ¹Ø§Ø¨ Ù…Ù‡Ù†ÙŠØ©"
      }]
    },
    T5: {
      desc: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¯Ù…ØºØ© (Ù†Ø³Ø¨ÙŠØ©)",
      subtypes: [{
        code: "ST01",
        desc: "Ø¯Ù…ØºØ© Ù†Ø³Ø¨ÙŠØ©"
      }]
    },
    T6: {
      desc: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø¯Ù…ØºØ© (Ù‚Ø·Ø¹ÙŠØ©)",
      subtypes: [{
        code: "ST02",
        desc: "Ø¯Ù…ØºØ© Ù‚Ø·Ø¹ÙŠØ©"
      }]
    },
    T7: {
      desc: "Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ù…Ù„Ø§Ù‡ÙŠ",
      subtypes: [{
        code: "Ent01",
        desc: "Ù…Ù„Ø§Ù‡ÙŠ (Ù†Ø³Ø¨Ø©)"
      }]
    },
    T8: {
      desc: "Ø±Ø³Ù… ØªÙ†Ù…ÙŠØ© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯",
      subtypes: [{
        code: "RD01",
        desc: "ØªÙ†Ù…ÙŠØ© Ù…ÙˆØ§Ø±Ø¯ (Ù†Ø³Ø¨Ø©)"
      }]
    },
    T9: {
      desc: "Ø±Ø³Ù… Ø®Ø¯Ù…Ø©",
      subtypes: [{
        code: "SC01",
        desc: "Ø±Ø³Ù… Ø®Ø¯Ù…Ø© (Ù†Ø³Ø¨Ø©)"
      }]
    },
    T10: {
      desc: "Ø±Ø³Ù… Ø§Ù„Ù…Ø­Ù„ÙŠØ§Øª",
      subtypes: [{
        code: "Mn01",
        desc: "Ø±Ø³Ù… Ù…Ø­Ù„ÙŠØ§Øª (Ù†Ø³Ø¨Ø©)"
      }]
    },
    T11: {
      desc: "Ø±Ø³Ù… Ø§Ù„ØªØ£Ù…ÙŠÙ† Ø§Ù„ØµØ­ÙŠ",
      subtypes: [{
        code: "MI01",
        desc: "ØªØ£Ù…ÙŠÙ† ØµØ­ÙŠ (Ù†Ø³Ø¨Ø©)"
      }]
    },
    T12: {
      desc: "Ø±Ø³ÙˆÙ… Ø£Ø®Ø±Ù‰",
      subtypes: [{
        code: "OF01",
        desc: "Ø±Ø³ÙˆÙ… Ø£Ø®Ø±Ù‰ (Ù†Ø³Ø¨Ø©)"
      }]
    }
  };
  const vO63 = {
    receiverTypes: Object.fromEntries(vA50.map(p441 => [p441.desc, p441.code])),
    itemCodeTypes: Object.fromEntries(vA51.map(p442 => [p442.desc, p442.code])),
    countries: Object.fromEntries(vA52.map(p443 => [p443.Desc_ar, p443.code])),
    units: Object.fromEntries(vA53.map(p444 => [p444.desc_ar, p444.code])),
    currencies: Object.fromEntries(vA49.map(p445 => [p445.desc, p445.code])),
    taxTypes: Object.fromEntries(Object.entries(vO62).map(([tmp884, tmp885]) => [tmp885.desc, tmp884])),
    taxSubtypes: Object.fromEntries(Object.values(vO62).flatMap(p446 => p446.subtypes.map(p447 => [p447.desc, p447.code])))
  };
  async function fn119() {
    const vF744 = fn74("Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥ÙƒØ³ÙŠÙ„ Ø§Ù„Ø°ÙƒÙŠ...", 0);
    try {
      if (typeof ExcelJS === "undefined") {
        throw new Error("Ù…ÙƒØªØ¨Ø© ExcelJS ØºÙŠØ± Ù…Ø­Ù…Ù„Ø©.");
      }
      const tmp886 = new ExcelJS.Workbook();
      const tmp887 = tmp886.addWorksheet("Invoices");
      const tmp888 = tmp886.addWorksheet("Lists");
      tmp888.getCell("A1").value = "ReceiverTypes";
      vA50.forEach((p448, p449) => {
        tmp888.getCell("A" + (p449 + 2)).value = p448.desc;
      });
      tmp888.getCell("B1").value = "CodeTypes";
      vA51.forEach((p450, p451) => {
        tmp888.getCell("B" + (p451 + 2)).value = p450.code;
      });
      tmp888.getCell("C1").value = "UnitTypes";
      vA53.forEach((p452, p453) => {
        tmp888.getCell("C" + (p453 + 2)).value = p452.desc_ar;
      });
      tmp888.getCell("D1").value = "Currencies";
      vA49.forEach((p454, p455) => {
        tmp888.getCell("D" + (p455 + 2)).value = p454.desc;
      });
      tmp888.getCell("E1").value = "MainTaxTypes";
      Object.values(vO62).forEach((p456, p457) => {
        tmp888.getCell("E" + (p457 + 2)).value = p456.desc;
      });
      tmp888.getCell("F1").value = "Countries";
      vA52.forEach((p458, p459) => {
        tmp888.getCell("F" + (p459 + 2)).value = p458.Desc_ar;
      });
      let vLN7 = 7;
      Object.values(vO62).forEach(p460 => {
        const tmp889 = tmp888.getCell(1, vLN7);
        const tmp890 = p460.desc.replace(/[ ()]/g, "_");
        tmp889.value = tmp890;
        p460.subtypes.forEach((p461, p462) => {
          tmp888.getCell(p462 + 2, vLN7).value = p461.desc;
        });
        vLN7++;
      });
      const vA54 = ["Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ (*)", "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±", "ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ³Ù„ÙŠÙ…", "Ø±Ù‚Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ„Ù… (*)", "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù… (*)", "Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªÙ„Ù… (*)", "Ø¯ÙˆÙ„Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù… (*)", "Ù…Ø­Ø§ÙØ¸Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù… (*)", "Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ø³ØªÙ„Ù… (*)", "Ø´Ø§Ø±Ø¹ Ø§Ù„Ù…Ø³ØªÙ„Ù… (*)", "Ù…Ø¨Ù†Ù‰ Ø§Ù„Ù…Ø³ØªÙ„Ù… (*)", "ÙˆØµÙ Ø§Ù„ØµÙ†Ù (*)", "Ù†ÙˆØ¹ ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (*)", "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (*)", "Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ", "ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ (*)", "Ø§Ù„ÙƒÙ…ÙŠØ© (*)", "Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø© (*)", "Ø¹Ù…Ù„Ø© Ø§Ù„Ø¨ÙŠØ¹", "Ø³Ø¹Ø± Ø§Ù„ØµØ±Ù", "Ù†Ø³Ø¨Ø© Ø§Ù„Ø®ØµÙ…", "Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ…", "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 1 (*)", "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ 1 (*)", "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 1 (*)", "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 2", "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ 2", "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 2", "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 3", "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ 3", "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 3", "Ù…Ø±Ø¬Ø¹ Ø´Ø±Ø§Ø¡", "ÙˆØµÙ Ø´Ø±Ø§Ø¡", "Ù…Ø±Ø¬Ø¹ Ù…Ø¨ÙŠØ¹Ø§Øª", "ÙˆØµÙ Ù…Ø¨ÙŠØ¹Ø§Øª", "Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ", "Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†Ùƒ", "Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªÙˆØµÙŠÙ„", "Ø§Ù„ØªØºÙ„ÙŠÙ"];
      tmp887.columns = vA54.map(p463 => ({
        header: p463,
        key: p463
      }));
      tmp887.getRow(1).eachCell(p464 => {
        const tmp891 = p464.value;
        const tmp892 = tmp891.replace(" (*)", "");
        if (vO55[tmp892]) {
          p464.note = vO55[tmp892];
        }
        p464.font = {
          name: "Arial",
          bold: true,
          size: 14,
          color: {
            argb: "FFFFFFFF"
          }
        };
        p464.fill = {
          type: "pattern",
          pattern: "solid",
          fgColor: {
            argb: "FF343A40"
          }
        };
        p464.alignment = {
          vertical: "middle",
          horizontal: "center"
        };
      });
      tmp887.autoFilter = {
        from: "A1",
        to: {
          row: 1,
          column: vA54.length
        }
      };
      tmp887.columns.forEach(p465 => {
        let vLN041 = 0;
        p465.eachCell({
          includeEmpty: true
        }, p466 => {
          const tmp893 = p466.value ? String(p466.value).length : 0;
          const tmp894 = p466.address.startsWith(p465.letter + "1") ? String(p466.value).length : 0;
          if (Math.max(tmp893, tmp894) > vLN041) {
            vLN041 = Math.max(tmp893, tmp894);
          }
        });
        p465.width = Math.max(15, Math.min(vLN041 + 5, 45));
      });
      const vF22 = (p467, p468) => {
        for (let vLN24 = 2; vLN24 <= 1001; vLN24++) {
          tmp887.getCell("" + p467 + vLN24).dataValidation = {
            type: "list",
            allowBlank: true,
            formulae: [p468]
          };
        }
      };
      vF22("F", "=Lists!$A$2:$A$4");
      vF22("G", "=Lists!$F$2:$F$" + (vA52.length + 1));
      vF22("M", "=Lists!$B$2:$B$3");
      vF22("P", "=Lists!$C$2:$C$" + (vA53.length + 1));
      vF22("S", "=Lists!$D$2:$D$" + (vA49.length + 1));
      vF22("W", "=Lists!$E$2:$E$" + (Object.keys(vO62).length + 1));
      vF22("Z", "=Lists!$E$2:$E$" + (Object.keys(vO62).length + 1));
      vF22("AC", "=Lists!$E$2:$E$" + (Object.keys(vO62).length + 1));
      const tmpLocalINDIRECTSUBSTITUTESU8 = "=INDIRECT(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(W2,\" \",\"_\"),\"(\",\"_\"),\")\",\"_\"))";
      const tmpLocalINDIRECTSUBSTITUTESU9 = "=INDIRECT(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(Z2,\" \",\"_\"),\"(\",\"_\"),\")\",\"_\"))";
      const tmpLocalINDIRECTSUBSTITUTESU10 = "=INDIRECT(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(AC2,\" \",\"_\"),\"(\",\"_\"),\")\",\"_\"))";
      vF22("X", tmpLocalINDIRECTSUBSTITUTESU8);
      vF22("AA", tmpLocalINDIRECTSUBSTITUTESU9);
      vF22("AD", tmpLocalINDIRECTSUBSTITUTESU10);
      Object.values(vO62).forEach((p469, p470) => {
        const tmp895 = String.fromCharCode("A".charCodeAt(0) + 6 + p470);
        const tmp896 = p469.desc.replace(/[ ()]/g, "_");
        const tmp897 = "Lists!$" + tmp895 + "$2:$" + tmp895 + "$" + (p469.subtypes.length + 1);
        tmp886.definedNames.add(tmp897, tmp896);
      });
      tmp888.state = "hidden";
      tmp887.views = [{
        rightToLeft: true
      }];
      const tmp898 = await tmp886.xlsx.writeBuffer();
      const tmp899 = new Blob([tmp898], {
        type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
      });
      if (typeof saveAs === "undefined") {
        throw new Error("Ù…ÙƒØªØ¨Ø© FileSaver.js ØºÙŠØ± Ù…Ø­Ù…Ù„Ø©.");
      }
      saveAs(tmp899, "Ù†Ù…ÙˆØ°Ø¬_ÙÙˆØ§ØªÙŠØ±_Ø§Ø­ØªØ±Ø§ÙÙŠ_ÙƒØ§Ù…Ù„.xlsx");
    } catch (e55) {
      alert("ÙØ´Ù„ Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ø¥ÙƒØ³ÙŠÙ„: " + e55.message);
    } finally {
      vF744.remove();
    }
  }
  const vO64 = {
    T1: "V009",
    T2: "Tbl01",
    T3: "Tbl02",
    T4: "W001",
    T5: "ST01",
    T6: "ST02",
    T7: "Ent01",
    T8: "RD01",
    T9: "SC01",
    T10: "Mn01",
    T11: "MI01",
    T12: "OF01"
  };
  function fn120(p471, p472 = 100) {
    if (p471 === null || p471 === undefined) {
      return "";
    }
    let vString = String(p471);
    if (vString.length > p472) {
      vString = vString.substring(0, p472);
    }
    return vString.trim();
  }
  function fn121(p473, p474) {
    if (!p473 || p473.length === 0) {
      throw new Error("Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ù†ÙˆØ¯ Ù„Ù‡Ø°Ù‡ Ø§Ù„ÙØ§ØªÙˆØ±Ø©.");
    }
    const tmp900 = p473[0];
    const tmp901 = document.querySelector(".invoice-type-btn.active");
    const tmp902 = tmp901 ? tmp901.dataset.type : "FullInvoice";
    const tmp903 = document.getElementById("activity-select-editor");
    const tmp904 = tmp903 ? tmp903.value : p474.taxpayerActivityCode;
    const vO65 = {
      type: "B",
      id: p474.id,
      name: fn120(p474.name),
      address: {
        branchID: "0",
        country: "EG",
        governate: fn120(p474.governate),
        regionCity: fn120(p474.regionCity),
        street: fn120(p474.street),
        buildingNumber: String(p474.buildingNumber || "").replace(/[^A-Za-z0-9\-\/]/g, ""),
        postalCode: "",
        floor: "",
        room: "",
        landmark: "",
        additionalInformation: ""
      }
    };
    if (!vO65.id || !vO65.name) {
      throw new Error("Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØµØ¯Ø± (Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙˆØ§Ù„Ø§Ø³Ù…) Ù…Ø·Ù„ÙˆØ¨Ø©.");
    }
    let tmp905;
    if (tmp900.dateTimeIssued && !isNaN(new Date(tmp900.dateTimeIssued))) {
      const tmp906 = new Date(tmp900.dateTimeIssued);
      const tmp907 = new Date();
      tmp906.setHours(tmp907.getHours(), tmp907.getMinutes(), tmp907.getSeconds());
      tmp905 = tmp906.toISOString().split(".")[0] + "Z";
    } else {
      tmp905 = new Date().toISOString().split(".")[0] + "Z";
    }
    let tmp908;
    if (tmp900.serviceDeliveryDate && !isNaN(new Date(tmp900.serviceDeliveryDate))) {
      tmp908 = new Date(tmp900.serviceDeliveryDate).toISOString().split("T")[0];
    } else {
      tmp908 = undefined;
    }
    let vLN042 = 0;
    let vLN043 = 0;
    const tmp909 = new Map();
    const tmp910 = p473.map(p475 => {
      const vParseFloat27 = parseFloat((parseFloat(p475.quantity) || 0).toFixed(5));
      const vParseFloat28 = parseFloat((parseFloat(p475.unit_price) || 0).toFixed(5));
      const tmp911 = parseFloat(p475.exchange_rate) || 1;
      const vParseFloat29 = parseFloat((vParseFloat28 * tmp911).toFixed(5));
      const vParseFloat30 = parseFloat((vParseFloat27 * vParseFloat29).toFixed(5));
      vLN042 += vParseFloat30;
      let tmp912 = parseFloat(p475.discount_amount) || vParseFloat30 * (parseFloat(p475.discount_rate) || 0) / 100;
      tmp912 = parseFloat(tmp912.toFixed(5));
      vLN043 += tmp912;
      const vParseFloat31 = parseFloat((vParseFloat30 - tmp912).toFixed(5));
      const vA55 = [];
      let vLN044 = 0;
      let vLN045 = 0;
      for (let vLN114 = 1; vLN114 <= 3; vLN114++) {
        const tmp913 = p475["tax_type_" + vLN114]?.trim().toUpperCase();
        const tmp914 = p475["tax_rate_" + vLN114];
        if ((tmp913 === "T2" || tmp913 === "T3") && tmp914 && !isNaN(parseFloat(tmp914))) {
          const vParseFloat32 = parseFloat(tmp914);
          const vParseFloat33 = parseFloat((vParseFloat31 * (vParseFloat32 / 100)).toFixed(5));
          const tmp915 = p475["tax_subtype_" + vLN114]?.trim() || vO64[tmp913] || "";
          vA55.push({
            taxType: tmp913,
            amount: vParseFloat33,
            subType: tmp915,
            rate: vParseFloat32
          });
          vLN045 += vParseFloat33;
          vLN044 += vParseFloat33;
          tmp909.set(tmp913, (tmp909.get(tmp913) || 0) + vParseFloat33);
        }
      }
      const tmp916 = vParseFloat31 + vLN045;
      for (let vLN115 = 1; vLN115 <= 3; vLN115++) {
        const tmp917 = p475["tax_type_" + vLN115]?.trim().toUpperCase();
        const tmp918 = p475["tax_rate_" + vLN115];
        if (tmp917 === "T2" || tmp917 === "T3") {
          continue;
        }
        if (tmp917 && tmp918 && !isNaN(parseFloat(tmp918))) {
          const vParseFloat34 = parseFloat(tmp918);
          let tmp919 = tmp917 === "T1" ? parseFloat((tmp916 * (vParseFloat34 / 100)).toFixed(5)) : parseFloat((vParseFloat31 * (vParseFloat34 / 100)).toFixed(5));
          const tmp920 = p475["tax_subtype_" + vLN115]?.trim() || vO64[tmp917] || "";
          vA55.push({
            taxType: tmp917,
            amount: tmp919,
            subType: tmp920,
            rate: vParseFloat34
          });
          vLN044 += tmp917 === "T4" ? -tmp919 : tmp919;
          tmp909.set(tmp917, (tmp909.get(tmp917) || 0) + tmp919);
        }
      }
      const tmp921 = (p475.currency_sold || "EGP").toUpperCase();
      const vO66 = {
        currencySold: tmp921,
        amountEGP: vParseFloat29,
        amountSold: 0
      };
      if (tmp921 !== "EGP") {
        vO66.amountSold = vParseFloat28;
        vO66.currencyExchangeRate = tmp911;
      }
      const vParseFloat35 = parseFloat((vParseFloat31 + vLN044).toFixed(5));
      return {
        description: fn120(p475.item_description || p475.item_code_name || p475.item_code, 100),
        itemType: p475.item_type,
        itemCode: p475.item_code,
        internalCode: fn120(p475.item_internal_code),
        unitType: p475.unit_type,
        quantity: vParseFloat27,
        salesTotal: vParseFloat30,
        discount: {
          amount: tmp912
        },
        netTotal: vParseFloat31,
        total: vParseFloat35,
        unitValue: vO66,
        taxableItems: vA55,
        valueDifference: 0,
        totalTaxableFees: 0,
        itemsDiscount: 0
      };
    });
    const tmp922 = Array.from(tmp909, ([tmp923, tmp924]) => ({
      taxType: tmp923,
      amount: parseFloat(tmp924.toFixed(5))
    }));
    const vParseFloat36 = parseFloat(vLN042.toFixed(5));
    const vParseFloat37 = parseFloat(vLN043.toFixed(5));
    const vParseFloat38 = parseFloat((vParseFloat36 - vParseFloat37).toFixed(5));
    const vParseFloat39 = parseFloat(tmp910.reduce((p476, p477) => p476 + p477.total, 0).toFixed(5));
    const tmp925 = document.getElementById("invoiceVersionSelect")?.value || "1.0";
    const tmp926 = tmp925 === "0.9";
    const tmp927 = tmp926 ? ["SimpleInvoice"] : [tmp902, "SignatureRequired"];
    const tmp928 = tmp926 ? [] : [{
      signatureType: "I",
      value: "VGVtcG9yYXJ5IFNpZ25hdHVyZSBIb2xkZXI="
    }];
    const vO67 = {
      country: (tmp900.receiver_country || "").toUpperCase().trim(),
      governate: fn120(tmp900.receiver_governate),
      regionCity: fn120(tmp900.receiver_city),
      street: fn120(tmp900.receiver_street),
      buildingNumber: String(tmp900.receiver_building || "").replace(/[^A-Za-z0-9\-\/]/g, ""),
      postalCode: "",
      floor: "",
      room: "",
      landmark: "",
      additionalInformation: ""
    };
    const vO68 = {
      issuer: vO65,
      receiver: {
        address: vO67,
        type: tmp900.receiver_type || "B",
        id: tmp900.receiver_type === "P" && !tmp900.receiver_id ? "20101012100000" : tmp900.receiver_id,
        name: fn120(tmp900.receiver_name)
      },
      documentType: "I",
      documentTypeVersion: tmp925,
      dateTimeIssued: tmp905,
      taxpayerActivityCode: tmp904,
      internalID: tmp900.internalID,
      invoiceLines: tmp910,
      totalSalesAmount: vParseFloat36,
      totalDiscountAmount: vParseFloat37,
      netAmount: vParseFloat38,
      taxTotals: tmp922,
      totalAmount: vParseFloat39,
      totalItemsDiscountAmount: 0,
      extraDiscountAmount: 0,
      signatures: tmp928
    };
    if (tmp908) {
      vO68.serviceDeliveryDate = tmp908;
    }
    if (tmp902 === "FullInvoice") {
      vO68.purchaseOrderReference = fn120(tmp900.purchaseOrderReference);
      vO68.purchaseOrderDescription = fn120(tmp900.purchaseOrderDescription);
      vO68.salesOrderReference = fn120(tmp900.salesOrderReference);
      vO68.salesOrderDescription = fn120(tmp900.salesOrderDescription);
      vO68.proformaInvoiceNumber = "";
      vO68.payment = {
        bankName: fn120(tmp900.bankName),
        bankAccountNo: fn120(tmp900.bankAccountNo),
        swiftCode: ""
      };
      vO68.delivery = {
        approach: fn120(tmp900.deliveryApproach),
        packaging: fn120(tmp900.deliveryPackaging)
      };
    } else {
      vO68.payment = {};
      vO68.delivery = {};
    }
    return {
      tags: tmp927,
      document: vO68
    };
  }
  function fn122(p478) {
    document.getElementById("invoiceErrorModal")?.remove();
    const tmp929 = document.createElement("div");
    tmp929.id = "invoiceErrorModal";
    tmp929.style.cssText = "\n        position: fixed; top: 0; left: 0; width: 100%; height: 100%;\n        background-color: rgba(0,0,0,0.6); z-index: 10002;\n        display: flex; align-items: center; justify-content: center;\n        direction: rtl; font-family: 'Segoe UI', Tahoma, sans-serif;\n    ";
    tmp929.innerHTML = "\n        <div style=\"background: #fff; width: 800px; max-width: 90%; max-height: 80%; border-radius: 10px; display: flex; flex-direction: column; box-shadow: 0 5px 20px rgba(0,0,0,0.3); animation: fadeIn 0.3s ease-out;\">\n            \n            <!-- Ø±Ø£Ø³ Ø§Ù„Ù†Ø§ÙØ°Ø© -->\n            <div style=\"padding: 15px 20px; background-color: #d9534f; color: white; border-top-left-radius: 10px; border-top-right-radius: 10px; display: flex; align-items: center; gap: 10px;\">\n                <span style=\"font-size: 24px;\">ğŸš¨</span>\n                <h3 style=\"margin: 0; font-size: 20px;\">ØªÙ… Ø§ÙƒØªØ´Ø§Ù Ø£Ø®Ø·Ø§Ø¡ ÙÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (" + p478.length + ")</h3>\n            </div>\n\n            <!-- Ø¬Ø³Ù… Ø§Ù„Ù†Ø§ÙØ°Ø© ÙˆØ¬Ø¯ÙˆÙ„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ -->\n            <div style=\"overflow-y: auto; padding: 20px;\">\n                <p style=\"margin-top: 0; color: #333;\">\n                    ÙŠØ±Ø¬Ù‰ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„ØªØ§Ù„ÙŠØ© ÙˆØªØµØ­ÙŠØ­Ù‡Ø§ ÙÙŠ Ù…Ù„Ù Ø§Ù„Ø¥ÙƒØ³ÙŠÙ„ Ø«Ù… Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø±ÙØ¹.\n                </p>\n                <table style=\"width: 100%; border-collapse: collapse; font-size: 14px;\">\n                    <thead style=\"background-color: #f8f9fa; position: sticky; top: 0;\">\n                        <tr>\n                            <th style=\"padding: 10px; border: 1px solid #ddd; text-align: right;\">Ø§Ù„Ù…ÙØ¹Ø±Ù‘Ù (Ø§Ù„ÙØ§ØªÙˆØ±Ø©/Ø§Ù„Ø¨Ù†Ø¯)</th>\n                            <th style=\"padding: 10px; border: 1px solid #ddd; text-align: right;\">Ø§Ù„Ø­Ù‚Ù„</th>\n                            <th style=\"padding: 10px; border: 1px solid #ddd; text-align: right;\">Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®Ø§Ø·Ø¦Ø©</th>\n                            <th style=\"padding: 10px; border: 1px solid #ddd; text-align: right;\">Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        " + p478.map(p479 => "\n                            <tr style=\"background-color: #fff1f0;\">\n                                <td style=\"padding: 8px; border: 1px solid #ffccc7;\">" + (p479.id || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯") + "</td>\n                                <td style=\"padding: 8px; border: 1px solid #ffccc7;\"><strong>" + (p479.field || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯") + "</strong></td>\n                                <td style=\"padding: 8px; border: 1px solid #ffccc7; font-family: monospace; direction: ltr; text-align: left;\">" + (p479.value || "") + "</td>\n                                <td style=\"padding: 8px; border: 1px solid #ffccc7;\">" + (p479.message || "Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ") + "</td>\n                            </tr>\n                        ").join("") + "\n                    </tbody>\n                </table>\n            </div>\n\n            <!-- ØªØ°ÙŠÙŠÙ„ Ø§Ù„Ù†Ø§ÙØ°Ø© ÙˆØ§Ù„Ø£Ø²Ø±Ø§Ø± -->\n            <div style=\"padding: 15px 20px; text-align: left; border-top: 1px solid #eee; background-color: #f8f9fa; display: flex; justify-content: flex-end; align-items: center;\">\n                <button id=\"closeErrorModalBtn\" style=\"background: #6c757d; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.2s;\">\n                    Ø¥ØºÙ„Ø§Ù‚\n                </button>\n            </div>\n        </div>\n    ";
    document.body.appendChild(tmp929);
    const tmp930 = document.createElement("style");
    tmp930.id = "errorModalStyles";
    tmp930.innerText = "@keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } } #closeErrorModalBtn:hover { background-color: #5a6268; }";
    document.head.appendChild(tmp930);
    document.getElementById("closeErrorModalBtn").onclick = () => {
      tmp929.remove();
      tmp930.remove();
    };
  }
  function fn123(p480, p481) {
    const tmp931 = p481.querySelector(".invoice-header-row");
    const tmp932 = tmp931.querySelector("[data-field=\"internalID\"]").textContent.trim();
    const tmp933 = tmp931.querySelector("[data-field=\"receiver_name\"]").textContent.trim();
    const tmp934 = tmp931.querySelector("[data-field=\"receiver_id\"]").textContent.trim();
    const tmp935 = tmp931.querySelector("[data-field=\"dateTimeIssued\"]").textContent.trim();
    const tmp936 = tmp931.querySelector("[data-field=\"serviceDeliveryDate\"]").textContent.trim();
    const vO69 = {};
    p481.querySelectorAll(".receiver-details-table [data-receiver-field]").forEach(p482 => {
      const tmp937 = p482.dataset.receiverField;
      vO69[tmp937] = p482.textContent.trim();
    });
    const vO70 = {};
    p481.querySelectorAll(".issuer-details-table [data-issuer-field]").forEach(p483 => {
      const tmp938 = p483.dataset.issuerField;
      vO70[tmp938] = p483.textContent.trim();
    });
    const vO71 = {};
    p481.querySelectorAll(".extra-details-table [data-invoice-field]").forEach(p484 => {
      const tmp939 = p484.dataset.invoiceField;
      vO71[tmp939] = p484.textContent.trim();
    });
    const vA56 = [];
    p481.querySelectorAll(".items-table tbody tr").forEach(p485 => {
      const vO72 = {};
      p485.querySelectorAll("[data-field]").forEach(p486 => {
        const tmp940 = p486.dataset.field;
        if (p486.children.length > 1) {
          p486.querySelectorAll("span[data-field]").forEach(p487 => {
            vO72[p487.dataset.field] = p487.textContent.trim();
          });
        } else {
          vO72[tmp940] = p486.textContent.trim();
        }
      });
      vA56.push(vO72);
    });
    const tmpHex29230f = fn124({
      internalID: tmp932,
      receiver_name: tmp933,
      receiver_id: tmp934,
      receiverAddress: vO69,
      issuerData: vO70,
      extraInvoiceData: vO71,
      invoiceLines: vA56,
      invoiceDate: new Date().toLocaleDateString("ar-EG")
    });
    const tmp941 = window.open("", "_blank", "width=800,height=600");
    tmp941.document.write(tmpHex29230f);
    tmp941.document.close();
    tmp941.onload = function () {
      const tmp942 = tmp941.document.createElement("button");
      tmp942.textContent = "Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø©";
      tmp942.style.cssText = "position: fixed; top: 10px; right: 10px; padding: 10px 15px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;";
      tmp942.onclick = function () {
        tmp941.print();
      };
      tmp941.document.body.appendChild(tmp942);
    };
  }
  function fn124(p488) {
    let vLN046 = 0;
    let vLN047 = 0;
    const tmp943 = new Map();
    const tmp944 = p488.invoiceLines.map(p489 => {
      const vParseFloat40 = parseFloat(p489.quantity || 0);
      const vParseFloat41 = parseFloat(p489.unit_price || 0);
      const vParseFloat42 = parseFloat(p489.exchange_rate || 1);
      const tmp945 = vParseFloat40 * vParseFloat41 * vParseFloat42;
      let tmp946 = parseFloat(p489.discount_amount) || tmp945 * (parseFloat(p489.discount_rate) || 0) / 100;
      const tmp947 = tmp945 - tmp946;
      let vLN048 = 0;
      for (let vLN116 = 1; vLN116 <= 3; vLN116++) {
        const tmp948 = p489["tax_type_" + vLN116]?.trim().toUpperCase();
        const vParseFloat43 = parseFloat(p489["tax_rate_" + vLN116] || 0);
        if (tmp948 && vParseFloat43 > 0) {
          const tmp949 = tmp947 * (vParseFloat43 / 100);
          vLN048 += (tmp948 === "T4" ? -1 : 1) * tmp949;
          tmp943.set(tmp948, (tmp943.get(tmp948) || 0) + tmp949);
        }
      }
      const tmp950 = tmp947 + vLN048;
      vLN047 += tmp946;
      vLN046 += tmp947;
      return "\n            <tr>\n                <td>" + (p489.item_code || "") + "</td>\n                <td>" + (p489.item_description || "") + "</td>\n                <td>" + vParseFloat40 + "</td>\n                <td>" + (p489.unit_type || "") + "</td>\n                <td>" + vParseFloat41.toFixed(2) + "</td>\n                <td>" + tmp947.toFixed(2) + "</td>\n                <td>" + vLN048.toFixed(2) + "</td>\n                <td>" + tmp950.toFixed(2) + "</td>\n            </tr>\n        ";
    }).join("");
    let tmp951 = "\n        <tr><td class=\"total-label\">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª (Ø¬.Ù…)</td><td class=\"total-value\">" + (vLN046 + vLN047).toFixed(2) + "</td></tr>\n        <tr><td class=\"total-label\">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®ØµÙ… (Ø¬.Ù…)</td><td class=\"total-value\">" + vLN047.toFixed(2) + "</td></tr>\n    ";
    let vVLN046 = vLN046;
    tmp943.forEach((p490, p491) => {
      vVLN046 += (p491 === "T4" ? -1 : 1) * p490;
      tmp951 += "<tr><td class=\"total-label\">" + (vO29[p491] || p491) + " (Ø¬.Ù…)</td><td class=\"total-value\">" + p490.toFixed(2) + "</td></tr>";
    });
    return "\n        <!DOCTYPE html>\n        <html dir=\"rtl\">\n        <head>\n            <meta charset=\"UTF-8\">\n            <title>Ù…Ø¹Ø§ÙŠÙ†Ø© ÙØ§ØªÙˆØ±Ø© " + p488.internalID + "</title>\n            <style>\n                body { font-family: 'Tahoma', 'Segoe UI', sans-serif; margin: 0; padding: 20px; background-color: #f9f9f9; color: #333; }\n                .invoice-container { background: white; max-width: 900px; margin: 0 auto; padding: 25px; border: 1px solid #e0e0e0; }\n                .header { text-align: center; border-bottom: 2px solid #ddd; padding-bottom: 10px; margin-bottom: 20px; }\n                .header h1 { font-size: 28px; margin: 0; color: #000; }\n                .header .invoice-meta { font-size: 14px; margin-top: 10px; color: #555; }\n                .header .warning-text { font-size: 14px; margin-top: 10px; color: #d9534f; font-weight: bold; }\n                .info-section { display: flex; justify-content: space-between; margin-bottom: 15px; padding: 15px; border: 1px solid #ddd; background-color: #f8f9fa; }\n                .info-section > div { flex-basis: 48%; }\n                .info-section h3 { margin-top: 0; font-size: 16px; border-bottom: 1px solid #ccc; padding-bottom: 8px; color: #337ab7; }\n                .info-section p { margin: 6px 0; font-size: 13px; line-height: 1.5; }\n                /* --- Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© --- */\n                .extra-details-section {\n                    padding: 10px 15px;\n                    border: 1px solid #ddd;\n                    background-color: #f8f9fa;\n                    margin-bottom: 20px;\n                    display: grid;\n                    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n                    gap: 10px;\n                }\n                .extra-details-section div { font-size: 12px; }\n                .extra-details-section strong { color: #337ab7; }\n                /* --- Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯ --- */\n                .items-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }\n                .items-table th, .items-table td { border: 1px solid #ddd; padding: 8px; font-size: 16px; text-align: center; }\n                .items-table th { background-color: #e7e8e9; white-space: nowrap; }\n                .totals-section { width: 45%; margin-left: 0; margin-right: auto; font-size: 13px; }\n                .totals-section table { width: 100%; border-collapse: collapse; }\n                .totals-section td { padding: 8px; border-bottom: 1px solid #eee; }\n                .totals-section .total-label { font-weight: bold; text-align: right; }\n                .totals-section .total-value { text-align: left; }\n                .totals-section .grand-total td { font-weight: bold; font-size: 15px; background-color: #f2f2f2; border-top: 2px solid #333; }\n                .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #777; }\n                @media print { body { background: white; padding: 0; } .invoice-container { box-shadow: none; border: none; } #printBtn { display: none; } }\n            </style>\n        </head>\n        <body>\n            <div class=\"invoice-container\">\n                <button id=\"printBtn\" style=\"position: fixed; top: 10px; left: 10px; padding: 10px 15px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;\" onclick=\"window.print()\">Ø·Ø¨Ø§Ø¹Ø©</button>\n                <div class=\"header\">\n                    <h1>ÙØ§ØªÙˆØ±Ø©</h1>\n                    <div class=\"invoice-meta\"><span>Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©: " + p488.internalID + "</span> | <span>Ø§Ù„ØªØ§Ø±ÙŠØ®: " + p488.invoiceDate + "</span></div>\n                    <p class=\"warning-text\">Ù…Ø¹Ø§ÙŠÙ†Ø© Ù„ÙØ§ØªÙˆØ±Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ (ØºÙŠØ± Ù…Ø¹ØªÙ…Ø¯Ø©)</p>\n                </div>\n                <div class=\"info-section\">\n                    <div><h3>Ø§Ù„Ø¨Ø§Ø¦Ø¹</h3><p><strong>Ø§Ù„Ø§Ø³Ù…:</strong> " + (p488.issuerData.name || "") + "</p><p><strong>Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„:</strong> " + (p488.issuerData.id || "") + "</p><p>" + (p488.issuerData.street || "") + ", " + (p488.issuerData.regionCity || "") + ", " + (p488.issuerData.governate || "") + "</p></div>\n                    <div><h3>Ø§Ù„Ù…Ø´ØªØ±ÙŠ</h3><p><strong>Ø§Ù„Ø§Ø³Ù…:</strong> " + p488.receiver_name + "</p><p><strong>Ø±Ù‚Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„:</strong> " + p488.receiver_id + "</p><p>" + (p488.receiverAddress.receiver_street || "") + ", " + (p488.receiverAddress.receiver_city || "") + ", " + (p488.receiverAddress.receiver_governate || "") + "</p></div>\n                </div>\n                \n                <!-- --- Ø¨Ø¯Ø§ÙŠØ© Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© --- -->\n                <div class=\"extra-details-section\">\n                    <div><strong>Ù…Ø±Ø¬Ø¹ Ø·Ù„Ø¨ Ø§Ù„Ø´Ø±Ø§Ø¡:</strong> " + (p488.extraInvoiceData.purchaseOrderReference || "") + "</div>\n                    <div><strong>ÙˆØµÙ Ø·Ù„Ø¨ Ø§Ù„Ø´Ø±Ø§Ø¡:</strong> " + (p488.extraInvoiceData.purchaseOrderDescription || "") + "</div>\n                    <div><strong>Ù…Ø±Ø¬Ø¹ Ø·Ù„Ø¨ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª:</strong> " + (p488.extraInvoiceData.salesOrderReference || "") + "</div>\n                    <div><strong>ÙˆØµÙ Ø·Ù„Ø¨ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª:</strong> " + (p488.extraInvoiceData.salesOrderDescription || "") + "</div>\n                    <div><strong>Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ùƒ:</strong> " + (p488.extraInvoiceData.bankName || "") + "</div>\n                    <div><strong>Ø±Ù‚Ù… Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¨Ù†Ùƒ:</strong> " + (p488.extraInvoiceData.bankAccountNo || "") + "</div>\n                    <div><strong>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„ØªÙˆØµÙŠÙ„:</strong> " + (p488.extraInvoiceData.deliveryApproach || "") + "</div>\n                    <div><strong>Ø§Ù„ØªØºÙ„ÙŠÙ:</strong> " + (p488.extraInvoiceData.deliveryPackaging || "") + "</div>\n                </div>\n                <!-- --- Ù†Ù‡Ø§ÙŠØ© Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© --- -->\n\n                <table class=\"items-table\">\n                    <thead>\n                        <tr>\n                            <th>ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù</th><th>Ø§Ù„ÙˆØµÙ</th><th>Ø§Ù„ÙƒÙ…ÙŠØ©</th><th>Ø§Ù„ÙˆØ­Ø¯Ø©</th><th>Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø©</th>\n                            <th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th><th>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©</th><th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©</th>\n                        </tr>\n                    </thead>\n                    <tbody>" + tmp944 + "</tbody>\n                </table>\n                <div class=\"totals-section\">\n                    <table>\n                        <tbody>\n                            " + tmp951 + "\n                            <tr class=\"grand-total\">\n                                <td class=\"total-label\">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬.Ù…)</td>\n                                <td class=\"total-value\">" + vVLN046.toFixed(2) + "</td>\n                            </tr>\n                        </tbody>\n                    </table>\n                </div>\n                <div class=\"footer\"><p>Ø§Ù„ØªÙˆÙ‚ÙŠØ¹: _________________________</p></div>\n            </div>\n        </body>\n        </html>\n    ";
  }
  async function fn125() {
    const vF745 = fn74("Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª Ø§Ù„Ø´Ø§Ù…Ù„...", 0);
    try {
      if (typeof ExcelJS === "undefined") {
        throw new Error("Ù…ÙƒØªØ¨Ø© ExcelJS ØºÙŠØ± Ù…Ø­Ù…Ù„Ø©. Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…Ù„Ù.");
      }
      const tmp952 = new ExcelJS.Workbook();
      const tmp953 = tmp952.addWorksheet("Ù‚Ø§Ù„Ø¨ Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…Ø±ØªØ¬Ø¹");
      const tmp954 = tmp952.addWorksheet("Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
      const vA57 = [{
        code: "EGS"
      }, {
        code: "GS1"
      }];
      tmp954.getCell("A1").value = "Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯";
      vA57.forEach((p492, p493) => {
        tmp954.getCell("A" + (p493 + 2)).value = p492.code;
      });
      tmp954.getCell("B1").value = "Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ÙˆØ­Ø¯Ø§Øª";
      vA53.forEach((p494, p495) => {
        tmp954.getCell("B" + (p495 + 2)).value = p494.desc_ar;
      });
      tmp954.getCell("C1").value = "Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø¶Ø±Ø§Ø¦Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©";
      Object.values(vO62).forEach((p496, p497) => {
        tmp954.getCell("C" + (p497 + 2)).value = p496.desc;
      });
      tmp954.getCell("D1").value = "Currencies";
      vA.forEach((p498, p499) => {
        tmp954.getCell("D" + (p499 + 2)).value = p498.Desc_ar;
      });
      let vLN52 = 5;
      Object.values(vO62).forEach(p500 => {
        const tmp955 = tmp954.getCell(1, vLN52);
        const tmp956 = p500.desc.replace(/[ ()]/g, "_");
        tmp955.value = tmp956;
        p500.subtypes.forEach((p501, p502) => {
          tmp954.getCell(p502 + 2, vLN52).value = p501.desc;
        });
        const tmp957 = String.fromCharCode("A".charCodeAt(0) + vLN52 - 1);
        const tmp958 = "'Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'!$" + tmp957 + "$2:$" + tmp957 + "$" + (p500.subtypes.length + 1);
        tmp952.definedNames.add(tmp958, tmp956);
        vLN52++;
      });
      const vO73 = {
        "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø± (YYYY-MM-DD)": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: Ø£Ø¯Ø®Ù„ ØªØ§Ø±ÙŠØ® Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ø±ØªØ¬Ø¹.",
        "Ø±Ù‚Ù… Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø±ØªØ¬Ø¹ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ (*)": "Ù…Ø·Ù„ÙˆØ¨: Ø±Ù‚Ù… ÙØ±ÙŠØ¯ ÙŠÙ…ÙŠØ² Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ù…Ø±ØªØ¬Ø¹.",
        "UUID Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© (*)": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ¹Ø±ÙŠÙÙŠ Ø§Ù„ÙØ±ÙŠØ¯ Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø¨ÙŠØ¹ Ø§Ù„Ø£ØµÙ„ÙŠØ©.",
        "Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)": "Ø§Ø³Ù… Ø§Ù„Ù…Ø´ØªØ±ÙŠ.",
        "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ù„Ù„Ø¹Ù…ÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)": "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ù„Ù„Ù…Ø´ØªØ±ÙŠ.",
        "Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ù„Ù„ØµÙ†Ù": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ù†Ø¸Ø§Ù…Ùƒ.",
        "ÙˆØµÙ Ø§Ù„ØµÙ†Ù (*)": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ø³Ù… Ø£Ùˆ ÙˆØµÙ ÙˆØ§Ø¶Ø­ Ù„Ù„Ø³Ù„Ø¹Ø© Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø©.",
        "Ù†ÙˆØ¹ ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (*)": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© (EGS Ø£Ùˆ GS1).",
        "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (*)": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„ÙØ¹Ù„ÙŠ Ù„Ù„ØµÙ†Ù.",
        "ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ (*)": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ø®ØªØ± ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©.",
        "Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø© (*)": "Ù…Ø·Ù„ÙˆØ¨: ÙƒÙ…ÙŠØ© Ø§Ù„ØµÙ†Ù Ø§Ù„ØªÙŠ ØªÙ… Ø¥Ø±Ø¬Ø§Ø¹Ù‡Ø§.",
        "Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø© ÙˆÙ‚Øª Ø§Ù„Ø¨ÙŠØ¹ (*)": "Ù…Ø·Ù„ÙˆØ¨: ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù†ÙØ³ Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø© Ø§Ù„Ø°ÙŠ ØªÙ… Ø§Ù„Ø¨ÙŠØ¹ Ø¨Ù‡ ÙÙŠ Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©.",
        "Ø¹Ù…Ù„Ø© Ø§Ù„Ø¨ÙŠØ¹": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…Ù„Ø©. ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ù†ÙØ³ Ø¹Ù…Ù„Ø© Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©.",
        "Ø³Ø¹Ø± Ø§Ù„ØµØ±Ù": "Ø¥Ø¬Ø¨Ø§Ø±ÙŠ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¹Ù…Ù„Ø© ØºÙŠØ± Ø§Ù„Ø¬Ù†ÙŠÙ‡. ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù†ÙØ³ Ø³Ø¹Ø± ØµØ±Ù Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©.",
        "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 1 (*)": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ.",
        "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ Ù„Ù„Ø¶Ø±ÙŠØ¨Ø© 1 (*)": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ø®ØªØ± Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ Ù„Ù„Ø¶Ø±ÙŠØ¨Ø©.",
        "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 1 (*)": "Ù…Ø·Ù„ÙˆØ¨: Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© Ù„Ù„Ø¶Ø±ÙŠØ¨Ø©.",
        "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 2 (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØµÙ†Ù Ø®Ø§Ø¶Ø¹Ù‹Ø§ Ù„Ø¶Ø±ÙŠØ¨Ø© Ø£Ø®Ø±Ù‰.",
        "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ Ù„Ù„Ø¶Ø±ÙŠØ¨Ø© 2 (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ Ù„Ù„Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©.",
        "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 2 (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)": "Ø§Ø®ØªÙŠØ§Ø±ÙŠ: Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©."
      };
      const tmp959 = Object.keys(vO73);
      tmp953.columns = tmp959.map(p503 => ({
        header: p503,
        key: p503,
        width: 35
      }));
      tmp953.getRow(1).eachCell(p504 => {
        p504.note = vO73[p504.value] || "";
        p504.font = {
          name: "Arial",
          bold: true,
          size: 12,
          color: {
            argb: "FFFFFFFF"
          }
        };
        p504.fill = {
          type: "pattern",
          pattern: "solid",
          fgColor: {
            argb: "FFC0392B"
          }
        };
        p504.alignment = {
          vertical: "middle",
          horizontal: "center",
          wrapText: true
        };
      });
      const vF23 = (p505, p506) => {
        for (let vLN25 = 2; vLN25 <= 1001; vLN25++) {
          tmp953.getCell("" + p505 + vLN25).dataValidation = {
            type: "list",
            allowBlank: true,
            formulae: [p506]
          };
        }
      };
      vF23("H", "='Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'!$A$2:$A$3");
      vF23("J", "='Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'!$B$2:$B$" + (vA53.length + 1));
      vF23("M", "='Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'!$D$2:$D$" + (vA.length + 1));
      vF23("O", "='Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'!$C$2:$C$" + (Object.keys(vO62).length + 1));
      vF23("R", "='Ù‚ÙˆØ§Ø¦Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'!$C$2:$C$" + (Object.keys(vO62).length + 1));
      const tmpLocalINDIRECTSUBSTITUTESU11 = "=INDIRECT(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(O2,\" \",\"_\"),\"(\",\"_\"),\")\",\"_\"))";
      const tmpLocalINDIRECTSUBSTITUTESU12 = "=INDIRECT(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(R2,\" \",\"_\"),\"(\",\"_\"),\")\",\"_\"))";
      vF23("P", tmpLocalINDIRECTSUBSTITUTESU11);
      vF23("S", tmpLocalINDIRECTSUBSTITUTESU12);
      tmp954.state = "hidden";
      tmp953.views = [{
        rightToLeft: true,
        state: "frozen",
        ySplit: 1
      }];
      const tmp960 = await tmp952.xlsx.writeBuffer();
      const tmp961 = new Blob([tmp960], {
        type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
      });
      if (typeof saveAs === "undefined") {
        throw new Error("Ù…ÙƒØªØ¨Ø© FileSaver.js ØºÙŠØ± Ù…Ø­Ù…Ù„Ø©.");
      }
      saveAs(tmp961, "Ù†Ù…ÙˆØ°Ø¬_Ù…Ø±ØªØ¬Ø¹_Ø§Ù„Ø¥ÙŠØµØ§Ù„Ø§Øª_Ø¨Ø§Ù„Ø¹Ù…Ù„Ø§Øª.xlsx");
    } catch (e56) {
      alert("ÙØ´Ù„ Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù…ÙˆØ°Ø¬ Ø¥ÙƒØ³Ù„ Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª: " + e56.message);
    } finally {
      vF745.remove();
    }
  }
  async function fn126(p507) {
    const tmp962 = document.getElementById("receiptUploaderTabbedUI");
    if (tmp962) {
      tmp962.style.display = "none";
    }
    const tmp963 = p507.target.files[0];
    if (!tmp963) {
      return;
    }
    const vF746 = fn74("Ø¬Ø§Ø±ÙŠ Ù‚Ø±Ø§Ø¡Ø© ÙˆØªØ±Ø¬Ù…Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±ØªØ¬Ø¹...");
    try {
      const tmp964 = new ExcelJS.Workbook();
      await tmp964.xlsx.load(await tmp963.arrayBuffer());
      const tmp965 = tmp964.getWorksheet(1);
      const tmp966 = tmp965.getRow(1).values.slice(1).map(p508 => String(p508 || "").trim());
      const vA58 = [];
      tmp965.eachRow({
        includeEmpty: false
      }, (p509, p510) => {
        if (p510 > 1) {
          const vO74 = {};
          p509.values.slice(1).forEach((p511, p512) => {
            const tmp967 = tmp966[p512];
            if (tmp967) {
              vO74[tmp967] = p511 ?? "";
            }
          });
          vA58.push(vO74);
        }
      });
      if (vA58.length === 0) {
        throw new Error("Ù…Ù„Ù Ø§Ù„Ø¥ÙƒØ³Ù„ ÙØ§Ø±Øº!");
      }
      const vO75 = {
        "ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø± (YYYY-MM-DD)": "dateTimeIssued",
        "Ø±Ù‚Ù… Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø±ØªØ¬Ø¹ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ (*)": "receiptNumber",
        "UUID Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© (*)": "referenceUUID",
        "Ø§Ø³Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)": "buyerName",
        "Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù‚ÙˆÙ…ÙŠ Ù„Ù„Ø¹Ù…ÙŠÙ„ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)": "buyerId",
        "Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ Ù„Ù„ØµÙ†Ù": "internalCode",
        "ÙˆØµÙ Ø§Ù„ØµÙ†Ù (*)": "description",
        "Ù†ÙˆØ¹ ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (*)": "itemType",
        "ÙƒÙˆØ¯ Ø§Ù„ØµÙ†Ù (*)": "itemCode",
        "ÙˆØ­Ø¯Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ (*)": "unitType",
        "Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø© (*)": "quantity",
        "Ø³Ø¹Ø± Ø§Ù„ÙˆØ­Ø¯Ø© ÙˆÙ‚Øª Ø§Ù„Ø¨ÙŠØ¹ (*)": "unitPrice",
        "Ø¹Ù…Ù„Ø© Ø§Ù„Ø¨ÙŠØ¹": "currencySold",
        "Ø³Ø¹Ø± Ø§Ù„ØµØ±Ù": "exchangeRate",
        "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 1 (*)": "taxType_1",
        "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ Ù„Ù„Ø¶Ø±ÙŠØ¨Ø© 1 (*)": "taxSubType_1",
        "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 1 (*)": "taxRate_1",
        "Ù†ÙˆØ¹ Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 2 (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)": "taxType_2",
        "Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„ÙØ±Ø¹ÙŠ Ù„Ù„Ø¶Ø±ÙŠØ¨Ø© 2 (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)": "taxSubType_2",
        "Ù†Ø³Ø¨Ø© Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© 2 (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)": "taxRate_2"
      };
      const tmp968 = vA58.map(p513 => {
        const vO76 = {};
        for (const tmp969 in p513) {
          const tmp970 = vO75[tmp969.trim()];
          if (tmp970) {
            let tmp971 = p513[tmp969];
            if (tmp970 === "unitType" && vO63.units[tmp971]) {
              tmp971 = vO63.units[tmp971];
            } else if (tmp970 === "currencySold" && vO.currencies[tmp971]) {
              tmp971 = vO.currencies[tmp971];
            } else if (tmp970.startsWith("taxType_") && vO63.taxTypes[tmp971]) {
              tmp971 = vO63.taxTypes[tmp971];
            } else if (tmp970.startsWith("taxSubType_") && vO63.taxSubtypes[tmp971]) {
              tmp971 = vO63.taxSubtypes[tmp971];
            }
            vO76[tmp970] = tmp971;
          }
        }
        return vO76;
      });
      const vV968 = tmp968;
      const tmp972 = new Map();
      let tmpLocal16 = "";
      let vO77 = {};
      vV968.forEach(p514 => {
        const tmp973 = String(p514.receiptNumber || tmpLocal16).trim();
        if (!tmp973) {
          return;
        }
        if (tmp973 !== tmpLocal16) {
          vO77 = {
            dateTimeIssued: p514.dateTimeIssued,
            referenceUUID: p514.referenceUUID,
            buyerName: p514.buyerName,
            buyerId: p514.buyerId
          };
          tmp972.set(tmp973, []);
        }
        const vO78 = {
          ...vO77,
          ...p514
        };
        tmp972.get(tmp973).push(vO78);
        tmpLocal16 = tmp973;
      });
      vF746.remove();
      fn47(tmp972, "return");
    } catch (e57) {
      alert("âŒ Ø®Ø·Ø£ ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…Ù„Ù Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª: " + e57.message);
    } finally {
      if (vF746) {
        vF746.remove();
      }
      p507.target.value = "";
    }
  }
  function fn127(p515, p516, p517, p518, p519 = null) {
    const vO79 = {
      id: (p516 || window.receiptUploaderData.seller).id,
      name: document.getElementById("manual-seller-name")?.value || (p516 || window.receiptUploaderData.seller).name,
      governate: document.getElementById("manual-seller-governate")?.value || (p516 || window.receiptUploaderData.seller).governate,
      regionCity: document.getElementById("manual-seller-regionCity")?.value || (p516 || window.receiptUploaderData.seller).regionCity,
      street: document.getElementById("manual-seller-street")?.value || (p516 || window.receiptUploaderData.seller).street,
      buildingNumber: document.getElementById("manual-seller-building")?.value || (p516 || window.receiptUploaderData.seller).buildingNumber
    };
    const tmp974 = p517 || window.receiptUploaderData.serial;
    const tmp975 = p518 || vO79.taxpayerActivityCode || "4690";
    const tmp976 = p515[0];
    const tmp977 = JSON.parse(localStorage.getItem("receiptHistory") || "[]");
    const tmp978 = tmp977.length > 0 ? tmp977[0].uuid : "";
    let tmpLocalEGP2 = "EGP";
    let vLN049 = 0;
    const tmp979 = p515.find(p520 => p520.currencySold && p520.currencySold !== "EGP");
    if (tmp979) {
      tmpLocalEGP2 = tmp979.currencySold;
      vLN049 = parseFloat(tmp979.exchangeRate) || 1;
    }
    const vO80 = {
      dateTimeIssued: fn4(tmp976.dateTimeIssued),
      receiptNumber: String(tmp976.receiptNumber || "RTN_" + Math.floor(Date.now() / 1000)),
      uuid: "",
      previousUUID: tmp978,
      referenceUUID: String(tmp976.referenceUUID || ""),
      currency: tmpLocalEGP2,
      exchangeRate: parseFloat(vLN049.toFixed(5)),
      sOrderNameCode: "",
      orderdeliveryMode: "",
      grossWeight: 0,
      netWeight: 0
    };
    if (p519) {
      vO80.referenceOldUUID = p519;
    }
    let vLN050 = 0;
    const tmp980 = new Map();
    const tmp981 = p515.map(p521 => {
      const vParseFloat44 = parseFloat((parseFloat(p521.quantity) || 0).toFixed(5));
      const vParseFloat45 = parseFloat((parseFloat(p521.unitPrice) || 0).toFixed(5));
      const vParseFloat46 = parseFloat((vParseFloat44 * vParseFloat45).toFixed(5));
      const vVParseFloat46 = vParseFloat46;
      const vA59 = [];
      let vLN051 = 0;
      if (p521.taxableItems && Array.isArray(p521.taxableItems)) {
        let vLN052 = 0;
        p521.taxableItems.forEach(p522 => {
          if (p522.taxType === "T2" || p522.taxType === "T3") {
            vLN052 += vVParseFloat46 * (parseFloat(p522.rate) / 100);
          }
        });
        const tmp982 = vVParseFloat46 + vLN052;
        p521.taxableItems.forEach(p523 => {
          const tmp983 = p523.taxType === "T1" ? tmp982 : netSale;
          const vParseFloat47 = parseFloat((tmp983 * (parseFloat(p523.rate) / 100)).toFixed(5));
          vA59.push({
            taxType: String(p523.taxType),
            amount: vParseFloat47,
            subType: String(p523.subType),
            rate: parseFloat(p523.rate)
          });
          vLN051 += p523.taxType === "T4" ? -vParseFloat47 : vParseFloat47;
          tmp980.set(String(p523.taxType), (tmp980.get(String(p523.taxType)) || 0) + vParseFloat47);
        });
      }
      const vParseFloat48 = parseFloat((vVParseFloat46 + vLN051).toFixed(5));
      vLN050 += vParseFloat46;
      return {
        internalCode: String(p521.internalCode || p521.itemCode),
        description: fn120(String(p521.description), 100),
        itemType: String(p521.itemType || "EGS"),
        itemCode: String(p521.itemCode),
        unitType: String(p521.unitType || "EA"),
        quantity: vParseFloat44,
        unitPrice: vParseFloat45,
        netSale: vVParseFloat46,
        totalSale: vParseFloat46,
        total: vParseFloat48,
        valueDifference: 0,
        taxableItems: vA59,
        itemDiscountData: []
      };
    });
    return {
      header: vO80,
      documentType: {
        receiptType: "R",
        typeVersion: "1.2"
      },
      seller: {
        rin: vO79.id,
        companyTradeName: vO79.name,
        branchCode: "0",
        branchAddress: {
          country: "EG",
          governate: vO79.governate,
          regionCity: vO79.regionCity,
          street: vO79.street,
          buildingNumber: vO79.buildingNumber
        },
        deviceSerialNumber: tmp974,
        activityCode: tmp975
      },
      buyer: {
        type: "P",
        id: tmp976.buyerId,
        name: tmp976.buyerName
      },
      itemData: tmp981,
      totalSales: parseFloat(vLN050.toFixed(5)),
      netAmount: parseFloat(vLN050.toFixed(5)),
      taxTotals: Array.from(tmp980, ([tmp984, tmp985]) => ({
        taxType: tmp984,
        amount: parseFloat(tmp985.toFixed(5))
      })),
      totalAmount: parseFloat(tmp981.reduce((p524, p525) => p524 + p525.total, 0).toFixed(5)),
      paymentMethod: "C",
      feesAmount: 0,
      adjustment: 0
    };
  }
  async function fn128(p526, p527) {
    const vF747 = fn74("Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„: " + p527 + "...");
    try {
      const tmp986 = p526.receipts;
      if (!tmp986 || tmp986.length === 0) {
        throw new Error("ÙƒØ§Ø¦Ù† Ø§Ù„Ø¯ÙØ¹Ø© ÙØ§Ø±Øº.");
      }
      const tmp987 = tmp986[tmp986.length - 1].header.uuid;
      const tmp988 = JSON.stringify(p526, null, 2);
      const tmp989 = new JSZip();
      tmp989.file("receipts.json", tmp988);
      const tmp990 = await tmp989.generateAsync({
        type: "blob",
        compression: "DEFLATE"
      });
      const tmp991 = document.querySelector("input[type=\"file\"]");
      if (!tmp991) {
        throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø­Ù‚Ù„ Ø±ÙØ¹ Ø§Ù„Ù…Ù„ÙØ§Øª (input[type=\"file\"]).");
      }
      const tmp992 = new File([tmp990], "receipts.zip", {
        type: "application/zip"
      });
      const tmp993 = new DataTransfer();
      tmp993.items.add(tmp992);
      tmp991.files = tmp993.files;
      tmp991.dispatchEvent(new Event("change", {
        bubbles: true
      }));
      await new Promise(p528 => setTimeout(p528, 200));
      const tmp994 = Array.from(document.querySelectorAll("button span.ms-Button-label")).find(p529 => p529.textContent.trim() === "Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©");
      if (!tmp994) {
        throw new Error("Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø²Ø± \"Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©\".");
      }
      const tmp995 = tmp994.closest("button");
      const tmp996 = new Promise((p530, p531) => {
        const tmp997 = window.fetch;
        window.fetch = async function (..._0x3102d6) {
          const tmp998 = _0x3102d6[0];
          if (typeof tmp998 === "string" && tmp998.includes("/api/v1/receiptsubmissions")) {
            try {
              const tmp999 = await tmp997.apply(this, _0x3102d6);
              const tmp1000 = tmp999.clone();
              const tmp1001 = await tmp1000.json();
              window.fetch = tmp997;
              p530(tmp1001);
              return tmp999;
            } catch (e58) {
              window.fetch = tmp997;
              p531(e58);
            }
          }
          return tmp997.apply(this, _0x3102d6);
        };
        tmp995.click();
      });
      const tmp1002 = await tmp996;
      if (tmp1002.submissionStatus === "Invalid" || tmp1002.inValidReceiptsCount > 0) {
        const tmp1003 = tmp1002.rejectedDocuments[0];
        const tmp1004 = tmp1003.error.details[0];
        const tmp1005 = "ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„.\n\nØ§Ù„Ø³Ø¨Ø¨ Ù…Ù† Ø§Ù„Ù…ØµÙ„Ø­Ø©: " + tmp1004.message + "\nØ§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø¯Ù‚ÙŠÙ‚ Ù„Ù„Ø®Ø·Ø£: " + tmp1004.propertyPath;
        throw new Error(tmp1005);
      }
      vF747.remove();
      return {
        success: true,
        uuid: tmp987,
        error: null
      };
    } catch (e59) {
      vF747.remove();
      return {
        success: false,
        uuid: "",
        error: e59.message
      };
    }
  }
})();